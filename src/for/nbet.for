C
C SUBROUTINE NBET
C $Log:   GXAFXT:[GOLS]NBET.FOV  $
C  
C     Rev 1.0   17 Apr 1996 14:09:00   HXK
C  Release of Finland for X.25, Telephone Betting, Instant Pass Thru Phase 1
C  
C     Rev 1.0   21 Jan 1993 17:04:58   DAB
C  Initial Release
C  Based on Netherlands Bible, 12/92, and Comm 1/93 update
C  DEC Baseline
C
C ** Source - vis_trnsnp.for **
C
C
C
C SUBROUTINE TO BUILD NUMBERS BET IMAGE
C
C=======OPTIONS /CHECK=NOOVERFLOW
	SUBROUTINE NBET(TRABUF,BIMAGE)
	IMPLICIT NONE
C
	INCLUDE 'INCLIB:SYSPARAM.DEF'
	INCLUDE 'INCLIB:SYSEXTRN.DEF'
	INCLUDE 'INCLIB:GLOBAL.DEF'
	INCLUDE 'INCLIB:DESTRA.DEF'
	INCLUDE 'INCLIB:TNAMES.DEF'
	INTEGER*4 I, POOL, QPIND
	INTEGER*4 NNUM(NMAXBT),NPOL(NMAXBT),NAMT(NMAXBT)
	CHARACTER*56 BIMAGE(12)
	CHARACTER*2 QP(0:1)
	DATA POOL/0/
	DATA QP/'  ','QP'/
C
C
	QPIND=TRABUF(TWQPF)
	DO 20 I=1,TRABUF(TWNBET)
	  NAMT(I)=TRABUF(TWNAMT1+(I-1)*3)
	  NNUM(I)=TRABUF(TWNNUM1+(I-1)*3)
	  NPOL(I)=TRABUF(TWNPOL1+(I-1)*3)
20	CONTINUE
C
C
	DO 30 I=1,TRABUF(TWNBET)
	  IF(TRABUF(TWNTYP).EQ.NB3TYP) THEN
            POOL=P3NAMES(NPOL(I))
	    IF(NPOL(I).EQ.TNB3F2) THEN
	      WRITE (BIMAGE(I),905) QP(QPIND),POOL,
     *               CMONY(NAMT(I),6,BETUNIT),NNUM(I)
            ELSE IF(NPOL(I).EQ.TNB3B2) THEN
	      WRITE (BIMAGE(I),906) QP(QPIND),POOL,
     *               CMONY(NAMT(I),6,BETUNIT),NNUM(I)
	    ELSE
	      WRITE (BIMAGE(I),903) QP(QPIND),POOL,
     *               CMONY(NAMT(I),6,BETUNIT),NNUM(I)
	    ENDIF
	  ELSE
	    POOL=P4NAMES(NPOL(I))
	    WRITE (BIMAGE(I),904) QP(QPIND),POOL,
     *             CMONY(NAMT(I),6,BETUNIT),NNUM(I)
	  ENDIF
30	CONTINUE
C
	RETURN
C
903	FORMAT(A2,1X,A4,1X,A6,1X,I3.3)
904	FORMAT(A2,1X,A4,1X,A6,1X,I4.4)
905	FORMAT(A2,1X,A4,1X,A6,1X,I2.2,'X')
906	FORMAT(A2,1X,A4,1X,A6,1X,'X',I2.2)
	END
