C
C PROGRAM TSTLOG
C
C TSTLOG.FOR
C
C v24 15-JUL-2021 SCML New Terminals Project (OLM)
C V23 31-MAR-2016 SCML M16 PROJECT
C V22 31-MAY-2011 RXK CLEANED, NOT-USED GAMES SKIPPED
C V21 19-MAY-2011 FJG Addequate for EVO
C V20 13-DEC-2010 FJG Inclussion of TWLNKxxx and EM transactions
C V19 22-NOV-2010 MAC LUCKY NUMBER
C V18 14-APR-2010 RXK Changes for ePassive 
C V17 16-MAR-2010 RXK ePassive added
C V16 25-MAR-2009 MMO TAVAL9 removed.
C V15 11-MAR-2009 MMO TAVAL8 removed.
C V14 28-NOV-2003 FRP TAVAL7 removed.
C V13 28-FEB-2000 RXK TAVAL1 removed.
C V12 13-OCT-1999 RXK World Tour added.
C V11 10-MAY-1999 UXN TRIPLE CHANGED TO TRIO.
C V10 17-APR-1996 HXK Release of Finland for X.25, Telephone Betting, 
C                     Instant Pass Thru Phase 1
C V09 23-NOV-1995 PXB Couple and Double games added
C V08 12-DEC-1994 HXK Change test value
C V07 02-OCT-1994 HXK Added Bingo
C V06 14-SEP-1993 GXA Added TCDC_SOLD to wager headers, removed tavailable2.
C V05 17-JUL-1993 GXA Dimensioning of NOTUSD......
C V04 17-JUL-1993 GXA Removed TAVAL1.
C V03 17-JUL-1993 GXA Added TSUBERR field to wager header.
C V02 26-MAY-1993 GXA Released for Finalnd Dec Conversion / Oddset.
C V01 21-JAN-1993 DAB Initial Release
C                     Based on Netherlands Bible, 12/92, and Comm 1/93 update
C                     DEC Baseline
C
C+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
C This item is the property of GTECH Corporation, Providence, Rhode
C Island, and contains confidential and trade secret information. It
C may not be transferred from the custody or control of GTECH except
C as authorized in writing by an officer of GTECH. Neither this item
C nor the information it contains may be used, transferred,
C reproduced, published, or disclosed, in whole or in part, and
C directly or indirectly, except as expressly authorized by an
C officer of GTECH, pursuant to written agreement.
C
C Copyright 2000 GTECH Corporation. All rights reserved.
C+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
C
C=======OPTIONS /CHECK=NOOVERFLOW
        PROGRAM TSTLOG
        IMPLICIT NONE
C
        INCLUDE 'INCLIB:SYSPARAM.DEF'
        INCLUDE 'INCLIB:SYSEXTRN.DEF'
C
        INCLUDE 'INCLIB:GLOBAL.DEF'
        INCLUDE 'INCLIB:DESTRA.DEF'
        INCLUDE 'INCLIB:X2XPTL.DEF'
        INCLUDE 'INCLIB:X2STMES.DEF'
        INCLUDE 'INCLIB:X2FEMES.DEF'
C
        INTEGER*4 I4TEMP
        INTEGER*2 I2TEMP(2)
        BYTE      I1TEMP(4)
        EQUIVALENCE (I4TEMP,I2TEMP,I1TEMP)
        INTEGER*4 BUF(48),TBUF(TRALEN), I
        INTEGER*4 NOKIK(11)
        DATA NOKIK/TWKBEG,TWKEND,TWKDUR,TWKICK,TWKGME,TWKAMT,TWKFLG,
     *             TWKICK2,TWKFLG2,TWKSEED,TWKSEED2/
	INTEGER*4   NOTUSD_CNT
	PARAMETER   (NOTUSD_CNT=4)
	INTEGER*4   NOTUSD(NOTUSD_CNT)
        DATA NOTUSD/TGAMIND,TCDC_SOLD,TFAMTFLG,TWADDFW/
        INTEGER*4  ST
        INTEGER*4  X, BUFIDX, AUX_TICKET_VAL, AUX_GAME_NUM, AUX_INDEX
        INTEGER*4 GNUM, TSQTY_AUX, TSGAM_AUX, GTYP_AUX
        INTEGER*4 AUX_MAX_GAMES(3)
        BYTE   BUFF(4)
        AUX_MAX_GAMES(1) = 3
        AUX_MAX_GAMES(2) = 24
        AUX_MAX_GAMES(3) = 40
C
C TEST LOTTO/SPORTS WAGER CONVERSION
C
C======================================================================
C
C TEST LOTTO WAGER CONVERSION (NO KICKER)
C
        TYPE*,'==============================================='
        TYPE*,'TESTING LOTTO WAGER NO JOKER, NO MULTS.......'
C
        CALL FASTSET(0,TRABUF,TRALEN)
        CALL FASTSET(0,TBUF,TRALEN)
        DO I=1,11
           TRABUF(NOKIK(I))=0
        ENDDO
C
C WAGER HEADER
C
        TRABUF(TSTAT)=FRAC
        TRABUF(TERR)=BDAY
        TRABUF(TSUBERR)=GREV_KIKCTL + GREV_KIKTXT
        TRABUF(TCDC)=9999
        TRABUF(TCDC_SOLD)= 9990
        TRABUF(TSER)=64123499
        TRABUF(TTIM)='00112233'X
        TRABUF(TTER)=6000
        TRABUF(TAGT)='00BBCCDD'X
        TRABUF(TTRN)=15
        TRABUF(TTYP)=TWAG
        TRABUF(TGAMTYP)=TLTO
        TRABUF(TGAMIND)=2
        TRABUF(TTSTCS)='FE'X
        TRABUF(TINTRA)=1
        TRABUF(TFIL)=4
        TRABUF(TTKID) = 1
        TRABUF(TCHK)='FD'X
        TRABUF(TFRAC)=10
        TRABUF(TSIZE)=3
        TRABUF(TWBEG) = 1
        TRABUF(TWEND) = 2
        TRABUF(TWTKC)=40
        TRABUF(TWAMT) = 10000
        TRABUF(TWDUR) = 2
        TRABUF(TWQPF)=1
        TRABUF(TWCSER)=64000001
        TRABUF(TWCTER)=6000
        TRABUF(TWVSTS)=VSBNKM
        TRABUF(TWNBET) = 12
        TRABUF(TWSYST) = CHCSYS
        TRABUF(TWSYSN) = 40
        TRABUF(TWBNKID)=888881
        TRABUF(TWBNKNM)=99999991
        TRABUF(TWFFLG)=1
        TRABUF(TWWEQP)=1
        TRABUF(TWMFRAC)=10
        TRABUF(TWTOT)=TRABUF(TWAMT)*TRABUF(TWDUR)+TRABUF(TWTKC)
C
C WAGER BODY
C
        DO I = TWBORD,TWBORD+15+15-1   !TWBEND
           TRABUF(I) = I
        ENDDO
        TRABUF(TWLUCK)=11               !V19 
        TRABUF(TWSIMP)=12
        TRABUF(TWSRW) =13
        TRABUF(TWMFLG)=1
        TRABUF(TWCDCOFF)=100
        TRABUF(TWNMRK)=7
        CALL FASTSET(0,TRABUF(TWMULT),12)
        CALL FASTSET(TRABUF(TWNMRK),TRABUF(TWNMRK+1),11)
        CALL TRALOG(TRABUF,BUF)
        CALL LOGTRA(TBUF,BUF)
        DO I=1,TRALEN
           IF(TRABUF(I).NE.TBUF(I)) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
        ENDDO
        TYPE*,'LOTTO WAGER NO JOKER, NO MULTS DONE!'
C
C=======================================================================
C
C TEST LOTTO WAGER CONVERSION (WITH KICKER)
C
        TYPE*,'TESTING LOTTO WAGER AND JOKER, NO MULTS.......'
C       
        CALL FASTSET(0,TRABUF,TRALEN)
        CALL FASTSET(0,TBUF,TRALEN)
C
C WAGER HEADER
C
        TRABUF(TSTAT)=FRAC
        TRABUF(TERR)=BDAY
        TRABUF(TSUBERR)=GREV_KIKCTL + GREV_KIKTXT
        TRABUF(TCDC)=9999
        TRABUF(TCDC_SOLD) = 9990
        TRABUF(TSER)=64123499
        TRABUF(TTIM)='00112233'X
        TRABUF(TTER)=6000
        TRABUF(TAGT)='00BBCCDD'X
        TRABUF(TTRN)=15
        TRABUF(TTYP)=TWAG
        TRABUF(TGAMTYP)=TLTO
        TRABUF(TGAMIND)=2
        TRABUF(TTSTCS)='FE'X
        TRABUF(TINTRA)=1
        TRABUF(TFIL)=4
        TRABUF(TTKID) = 1
        TRABUF(TCHK)='FD'X
        TRABUF(TFRAC)=10
        TRABUF(TSIZE)=3
        TRABUF(TWBEG) = 1
        TRABUF(TWEND) = 2
        TRABUF(TWTKC)=40
        TRABUF(TWAMT) = 10000
        TRABUF(TWDUR) = 2
        TRABUF(TWKICK)=99999991
        TRABUF(TWKICK2)=99999972
        TRABUF(TWKFLG)=1
        TRABUF(TWKFLG2)=1
        TRABUF(TWKGME)=1
        TRABUF(TWKAMT)=10000
        TRABUF(TWKBEG)=1
        TRABUF(TWKEND)=2
        TRABUF(TWKDUR)=2
        TRABUF(TWKSEED)=0
        TRABUF(TWKSEED2)=0
        TRABUF(TWQPF)=1
        TRABUF(TWWEQP)=1
        TRABUF(TWCSER)=64000001
        TRABUF(TWCTER)=6000
        TRABUF(TWVSTS)=VSBNKM
        TRABUF(TWNBET) = 12
        TRABUF(TWSYST) = CHCSYS
        TRABUF(TWSYSN) = 40
        TRABUF(TWBNKID)=888881
        TRABUF(TWBNKNM)=99999991
        TRABUF(TWFFLG)=1
        TRABUF(TWMFRAC)=10
        TRABUF(TWNMRK)=7
        CALL FASTSET(0,TRABUF(TWMULT),12)
        CALL FASTSET(TRABUF(TWNMRK),TRABUF(TWNMRK+1),11)
        TRABUF(TWTOT)=TRABUF(TWAMT)*TRABUF(TWDUR)+
     *                TRABUF(TWKAMT)*TRABUF(TWKDUR)+
     *                TRABUF(TWTKC)
        DO I = TWBORD,TWBORD+11+15-1   !TWBEND
           TRABUF(I) = I
        ENDDO
        TRABUF(TWLUCK)=11
        TRABUF(TWSIMP)=12
        TRABUF(TWSRW) =13
        TRABUF(TWMFLG)=0
        TRABUF(TWCDCOFF)=100
        CALL TRALOG(TRABUF,BUF)
        CALL LOGTRA(TBUF,BUF)
        DO I=1,TRALEN
           IF(TRABUF(I).NE.TBUF(I)) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
        ENDDO
        TYPE*,'LOTTO WAGER WITH JOKER AND NO MULTS DONE!'
C
C=====================================================================
C
C TESTING EPASSIVE WAGER BODY
C
        TYPE*,'================================================'
        TYPE*,'TESTING EPASSIVE WAGER ......'
C
        CALL FASTSET(0,TRABUF,TRALEN)
        CALL FASTSET(0,TBUF,TRALEN)
        DO I=1,11
           TRABUF(NOKIK(I))=0
        ENDDO 
C
C WAGER HEADER
C
        TRABUF(TSTAT)=REJT
        TRABUF(TERR)=BDAY
        TRABUF(TSUBERR)=GREV_KIKCTL + GREV_KIKTXT
        TRABUF(TCDC)=9999
        TRABUF(TCDC_SOLD)= 9990
        TRABUF(TSER)=64123499
        TRABUF(TTIM)='00112233'X
        TRABUF(TTER)=6000
        TRABUF(TAGT)='00BBCCDD'X
        TRABUF(TTRN)=15
        TRABUF(TTYP)=TWAG
        TRABUF(TGAMTYP)=TPAS
        TRABUF(TGAMIND)=2
        TRABUF(TTSTCS)='FE'X
        TRABUF(TINTRA)=1
        TRABUF(TFIL)=4
        TRABUF(TTKID) = 1
        TRABUF(TCHK)='FD'X
        TRABUF(TFRAC)=0
        TRABUF(TSIZE)=3
        TRABUF(TWBEG) = 1
        TRABUF(TWEND) = 1
        TRABUF(TWTKC)=40
        TRABUF(TWAMT) = 10000
        TRABUF(TWDUR) = 1
        TRABUF(TWQPF)=1
        TRABUF(TWCSER)=64000001
        TRABUF(TWCTER)=6000
        TRABUF(TWVSTS)=VSBNKM
        TRABUF(TWNBET) = 1
        TRABUF(TWSYST) = 0
        TRABUF(TWSYSN) = 0
        !TRABUF(TWBNKID)=888881
        !TRABUF(TWBNKNM)=99999991
        TRABUF(TWFFLG)=0
        TRABUF(TWWEQP)=0
        TRABUF(TWMFRAC)=0
        TRABUF(TWTOT)=TRABUF(TWAMT)*TRABUF(TWDUR)+TRABUF(TWTKC)
C
C EPASSIVE WAGER BODY, SALES
C
        TRABUF(TWEPOP)=2
        TRABUF(TWEPWK)=52
        TRABUF(TWEPYR)=25

        TRABUF(TWEPSN)=12345
        TRABUF(TWEPSS)=5
        TRABUF(TWEPSF)=3
        
        CALL TRALOG(TRABUF,BUF)
        CALL LOGTRA(TBUF,BUF)
        DO I=1,TRALEN
           IF(TRABUF(I).NE.TBUF(I)) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
        ENDDO
        TYPE*,'EPASSIVE WAGER, SALES DONE!'
        !TYPE*,'++++++++++++++++++++++++++++++++++++++++++++++++++++++'
C
C EPASSIVE WAGER BODY, RESERVATION
C
        TRABUF(TWEND)=0      !not used
        TRABUF(TWTOT)=0      !not used
        TRABUF(TWEPSN)=0     !not used
        TRABUF(TWEPSF)=0     !not used
        TRABUF(TWEPSS)=0     !not used

        TRABUF(TWEPOP)=1
        TRABUF(TWEPSD)=612345
        TRABUF(TWEPRM)=45
        TRABUF(TWEPNE)=2
        TRABUF(TWEPNR)=3

        TRABUF(TWEPRES1) = 34567        
        TRABUF(TWEPRES2) = 44567        
        TRABUF(TWEPRES3) = 35567        

        TRABUF(TWEPNFR1) = 7
        TRABUF(TWEPNFR2) = 8
        TRABUF(TWEPNFR3) = 9

        TRABUF(TWEPSER1_1) = 10 
        TRABUF(TWEPSER1_2) = 9
        TRABUF(TWEPSER1_3) = 8
        TRABUF(TWEPSER1_4) = 7
        TRABUF(TWEPSER1_5) = 6
        TRABUF(TWEPSER1_6) = 5
        TRABUF(TWEPSER1_7) = 4
        TRABUF(TWEPSER1_8) = 3
        TRABUF(TWEPSER1_9) = 2
        TRABUF(TWEPSER1_10) = 1

        TRABUF(TWEPFRC1_1) = 9
        TRABUF(TWEPFRC1_2) =8
        TRABUF(TWEPFRC1_3) =7
        TRABUF(TWEPFRC1_4) =6
        TRABUF(TWEPFRC1_5) =5
        TRABUF(TWEPFRC1_6) =4
        TRABUF(TWEPFRC1_7) =3
        TRABUF(TWEPFRC1_8) =2
        TRABUF(TWEPFRC1_9) =1
        TRABUF(TWEPFRC1_10) =10

        TRABUF(TWEPSER2_1) = 10 
        TRABUF(TWEPSER2_2) = 9
        TRABUF(TWEPSER2_3) = 8
        TRABUF(TWEPSER2_4) = 7
        TRABUF(TWEPSER2_5) = 6
        TRABUF(TWEPSER2_6) = 5
        TRABUF(TWEPSER2_7) = 4
        TRABUF(TWEPSER2_8) = 3
        TRABUF(TWEPSER2_9) = 2
        TRABUF(TWEPSER2_10) = 1

        TRABUF(TWEPFRC2_1) = 9
        TRABUF(TWEPFRC2_2) =8
        TRABUF(TWEPFRC2_3) =7
        TRABUF(TWEPFRC2_4) =6
        TRABUF(TWEPFRC2_5) =5
        TRABUF(TWEPFRC2_6) =4
        TRABUF(TWEPFRC2_7) =3
        TRABUF(TWEPFRC2_8) =2
        TRABUF(TWEPFRC2_9) =1
        TRABUF(TWEPFRC2_10) =10

        TRABUF(TWEPSER3_1) = 10 
        TRABUF(TWEPSER3_2) = 9
        TRABUF(TWEPSER3_3) = 8
        TRABUF(TWEPSER3_4) = 7
        TRABUF(TWEPSER3_5) = 6
        TRABUF(TWEPSER3_6) = 5
        TRABUF(TWEPSER3_7) = 4
        TRABUF(TWEPSER3_8) = 3
        TRABUF(TWEPSER3_9) = 2
        TRABUF(TWEPSER3_10) = 1

        TRABUF(TWEPFRC3_1) = 9
        TRABUF(TWEPFRC3_2) =8
        TRABUF(TWEPFRC3_3) =7
        TRABUF(TWEPFRC3_4) =6
        TRABUF(TWEPFRC3_5) =5
        TRABUF(TWEPFRC3_6) =4
        TRABUF(TWEPFRC3_7) =3
        TRABUF(TWEPFRC3_8) =2
        TRABUF(TWEPFRC3_9) =1
        TRABUF(TWEPFRC3_10) =10

        CALL TRALOG(TRABUF,BUF)
        CALL LOGTRA(TBUF,BUF)
        DO I=1,TRALEN
           IF(TRABUF(I).NE.TBUF(I)) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
        ENDDO
        TYPE*,'EPASSIVE WAGER, RESERVATION DONE!'
        !TYPE*,'+++++++++++++++++++++++++++++++++++++++++'
C
C============================================================================
C
C TEST KICKER WAGER CONVERSION
C
        TYPE*,'==============================================='
        TYPE*,'TESTING JOKER WAGER.......'
C
        CALL FASTSET(0,TRABUF,TRALEN)
        CALL FASTSET(0,TBUF,TRALEN)
        TRABUF(TSTAT)=FRAC
        TRABUF(TERR)=BDAY
        TRABUF(TSUBERR)=GREV_KIKCTL + GREV_KIKTXT
        TRABUF(TCDC)=9999
        TRABUF(TCDC_SOLD)= 9990 
        TRABUF(TSER)=64123499
        TRABUF(TTIM)='00112233'X
        TRABUF(TTER)=6000
        TRABUF(TAGT)='00BBCCDD'X
        TRABUF(TTRN)=15
        TRABUF(TTYP)=TWAG
        TRABUF(TGAM)=MAXGAM
        TRABUF(TGAMTYP)=TKIK
        TRABUF(TGAMIND)=1
        TRABUF(TTSTCS)='FE'X
        TRABUF(TINTRA)=1
        TRABUF(TFIL)=4
        TRABUF(TTKID) = 1
        TRABUF(TCHK)='FD'X
        TRABUF(TFRAC)=10
        TRABUF(TSIZE)=3
        TRABUF(TWBEG) = 1
        TRABUF(TWEND) = 2
        TRABUF(TWTKC)=40
        TRABUF(TWAMT) = 10000
        TRABUF(TWDAMT)= 10001
        TRABUF(TWDUR) = 2
        TRABUF(TWKICK)=99999991
        TRABUF(TWKICK2)=99999972
        TRABUF(TWKFLG)=1
        TRABUF(TWKFLG2)=1
        TRABUF(TWKGME)=MAXGAM
        TRABUF(TWKAMT)=10000
        TRABUF(TWKBEG)=1
        TRABUF(TWKEND)=2
        TRABUF(TWKDUR)=2
        TRABUF(TWQPF)=1
        TRABUF(TWCSER)=64000001
        TRABUF(TWCTER)=6000
        TRABUF(TWVSTS)=VSBNKM
        TRABUF(TWNBET) = 1
        TRABUF(TWBNKID)=888881
        TRABUF(TWBNKNM)=99999991
        TRABUF(TWFFLG)=1
        TRABUF(TWMFRAC)=0  !not used
        TRABUF(TWTOT) = (TRABUF(TWAMT)*TRABUF(TWDUR)) + TRABUF(TWTKC)
!V20++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++        
        TRABUF(TWLNKSER) = 16777215 
        TRABUF(TWLNKCHK) = 169
!V20++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++        
        CALL TRALOG(TRABUF,BUF)
        CALL LOGTRA(TBUF,BUF)
        DO I=1,TRALEN
           IF(TRABUF(I).NE.TBUF(I)) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
        ENDDO
        TYPE*,'JOKER WAGER DONE!'
C
C===========================================================================
C
C TEST NUMBERS WAGER CONVERSION
C
        GOTO 2400
C
C       CALL FASTSET(0,TRABUF,TRALEN)
C       CALL FASTSET(0,TBUF,TRALEN)
C       DO 230 I=1,TWNAMT10
C       TRABUF(I)=I
C230    CONTINUE
C       DO 231 I=1,NOTUSD_CNT
C       TRABUF(NOTUSD(I))=0
C231    CONTINUE
C        DO 2310 I=1,7
C        TRABUF(NOKIK(I))=0
C2310    CONTINUE
C       TRABUF(TTYP)=TWAG
C       TRABUF(TGAMTYP)=TNBR
C       TRABUF(TTIM)='00112233'X
C       TRABUF(TAGT)='00AABBCC'X
C       TRABUF(TINTRA)=1
C       TRABUF(TFIL)=4
C       TRABUF(TWQPF)=15
C       TRABUF(TSIZE)=2
C       TRABUF(TWVSTS)=VHOLD
C       TRABUF(TWTKC) = 0
C       TRABUF(TWSYST)=0
C       TRABUF(TWSYSN)=0
C       TRABUF(TTKID) = 0
C       TRABUF(TWNAND)=1
C       TRABUF(TWQPF) = 0
C       TRABUF(TWAMT) = 600
C     *               TRABUF(TWNAMT1)+TRABUF(TWNAMT2)+
C     *               TRABUF(TWNAMT3)+TRABUF(TWNAMT4)+
C     *               TRABUF(TWNAMT5)+TRABUF(TWNAMT6)+
C     *               TRABUF(TWNAMT7)+TRABUF(TWNAMT8)+
C     *                TRABUF(TWNAMT9)+TRABUF(TWNAMT10)
C       TRABUF(TWTOT)=TRABUF(TWAMT)*TRABUF(TWDUR)+TRABUF(TWTKC)
C       TRABUF(TWEND)=TRABUF(TWBEG)+TRABUF(TWDUR)-1
C       CALL TRALOG(TRABUF,BUF)
C       CALL LOGTRA(TBUF,BUF)
C       TYPE*,'NUMBERS WAGER'
C       DO 240 I=1,TRALEN
C       IF(TRABUF(I).NE.TBUF(I)) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
C240    CONTINUE
C
C=========================================================================
C
C TEST SCORE WAGER CONVERSION
C
2400    CONTINUE
        GOTO 2500
C
        TYPE*,'TESTING SCORE WAGER......'
C
        CALL FASTSET(0,TRABUF,TRALEN)
        CALL FASTSET(0,TBUF,TRALEN)
        DO 241 I=1,TWSAMT+TWSBLEN*TWSBMAX-1
        TRABUF(I)=I
241     CONTINUE
        DO 2410 I=1,11
        TRABUF(NOKIK(I))=0
2410    CONTINUE
        TRABUF(TINTRA)=1
        TRABUF(TTYP)=TWAG
        TRABUF(TGAMTYP)=TSCR
        TRABUF(TGAMIND)=6
        TRABUF(TWQPF)=0
        TRABUF(TTKID)=0
        TRABUF(TSIZE)=2
        TRABUF(TFIL)=1
        TRABUF(TWBEG)=1
        TRABUF(TWEND)=TRABUF(TWBEG)
        TRABUF(TWDUR)=1
        TRABUF(TWBNKID)=888881
        TRABUF(TWBNKNM)=99999992
        TRABUF(TWCSER)=123345678
        TRABUF(TWCTER)=6000
        TRABUF(TWTKC)=200
        TRABUF(TWVSTS)=VSBNKM
        TRABUF(TWNBET)=10
        TRABUF(TWFFLG)=0
        TRABUF(TWMFRAC)=0
        TRABUF(TWAMT)=TRABUF(TWSAMT)+
     *                TRABUF(TWSAMT+TWSBLEN)   +
     *                TRABUF(TWSAMT+TWSBLEN*2) +
     *                TRABUF(TWSAMT+TWSBLEN*3) +
     *                TRABUF(TWSAMT+TWSBLEN*4) +
     *                TRABUF(TWSAMT+TWSBLEN*5) +
     *                TRABUF(TWSAMT+TWSBLEN*6) +
     *                TRABUF(TWSAMT+TWSBLEN*7) +
     *                TRABUF(TWSAMT+TWSBLEN*8) +
     *                TRABUF(TWSAMT+TWSBLEN*9)
        TRABUF(TWTOT) = TRABUF(TWAMT) * TRABUF(TWDUR) + TRABUF(TWTKC)
C
        CALL TRALOG(TRABUF,BUF)
        CALL LOGTRA(TBUF,BUF)
        DO 243 I=1,TRALEN
        IF(TRABUF(I).NE.TBUF(I)) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
243     CONTINUE
        TYPE*,'SCORE WAGER DONE!'
C
C=====================================================================
C
C TEST WINNERS TIP WAGER CONVERSION
C
2500    CONTINUE
        GOTO 2600
C  
        TYPE*,'TESTING WINNERS TIP WAGER......'
        CALL FASTSET(0,TRABUF,TRALEN)
        CALL FASTSET(0,TBUF,TRALEN)
        DO 244 I=1,TWWAMT+TWWBLEN*TWWBMAX-1
        TRABUF(I)=I
244     CONTINUE
        DO 2510 I=1,11
        TRABUF(NOKIK(I))=0
2510    CONTINUE
        TRABUF(TINTRA)=1
        TRABUF(TTYP)=TWAG
        TRABUF(TGAMTYP)=TWIT
        TRABUF(TGAMIND)=6
        TRABUF(TWQPF)=0
        TRABUF(TTKID)=0
        TRABUF(TSIZE)=2
        TRABUF(TFIL)=1
        TRABUF(TWBEG)=1
        TRABUF(TWEND)=TRABUF(TWBEG)
        TRABUF(TWDUR)=1
        TRABUF(TWBNKID)=888881
        TRABUF(TWBNKNM)=99999992
        TRABUF(TWCSER)=123345678
        TRABUF(TWCTER)=6000
        TRABUF(TWTKC)=200
        TRABUF(TWVSTS)=VSBNKM
        TRABUF(TWNBET)=10
        TRABUF(TWFFLG)=0
        TRABUF(TWMFRAC)=0
        TRABUF(TWAMT)=TRABUF(TWWAMT)+
     *                TRABUF(TWWAMT+TWWBLEN)   +
     *                TRABUF(TWWAMT+TWWBLEN*2) +
     *                TRABUF(TWWAMT+TWWBLEN*3) +
     *                TRABUF(TWWAMT+TWWBLEN*4) +
     *                TRABUF(TWWAMT+TWWBLEN*5) +
     *                TRABUF(TWWAMT+TWWBLEN*6) +
     *                TRABUF(TWWAMT+TWWBLEN*7) +
     *                TRABUF(TWWAMT+TWWBLEN*8) +
     *                TRABUF(TWWAMT+TWWBLEN*9)
        TRABUF(TWTOT) = TRABUF(TWAMT) * TRABUF(TWDUR) + TRABUF(TWTKC)
        CALL TRALOG(TRABUF,BUF)
        CALL LOGTRA(TBUF,BUF)
        DO 246 I=1,TRALEN
        IF(TRABUF(I).NE.TBUF(I)) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
246     CONTINUE
        TYPE*,'WINNERS TIP WAGER DONE!'
C
C=========================================================================
C
C TEST TOTO SELECT WAGER CONVERSION
C
2600    CONTINUE
        GOTO 2700
C 
        TYPE*,'TESTING TOTO SELECT WAGER......'
C
        CALL FASTSET(0,TRABUF,TRALEN)
        CALL FASTSET(0,TBUF,TRALEN)
        DO 247 I=1,TWTSTS3+(TWTRMAX-1)*TWTBLEN
        TRABUF(I)=I
        IF(I.GT.TWBDTA) TRABUF(I)=MOD(I,15)+1
247     CONTINUE
        DO 2610 I=1,11
        TRABUF(NOKIK(I))=0
2610    CONTINUE
        TRABUF(TINTRA)=1
        TRABUF(TTYP)=TWAG
        TRABUF(TGAMTYP)=TTSL
        TRABUF(TGAMIND)=1
        TRABUF(TWQPF)=1
        TRABUF(TTKID)=0
        TRABUF(TSIZE)=3
        TRABUF(TFIL)=1
        TRABUF(TWBEG)=1
        TRABUF(TWEND)=TRABUF(TWBEG)
        TRABUF(TWDUR)=1
        TRABUF(TWBNKID)=888881
        TRABUF(TWBNKNM)=99999992
        TRABUF(TWCSER)=123345678
        TRABUF(TWCTER)=6000
        TRABUF(TWTKC)=250
        TRABUF(TWVSTS)=VSBNKM
        TRABUF(TWNBET)=3
        TRABUF(TWTSEL1)=6
        TRABUF(TWTSEL2)=6
        TRABUF(TWTSEL3)=6
        TRABUF(TWFFLG)=0
        TRABUF(TWMFRAC)=0
        TRABUF(TWAMT)=TRABUF(TWTAMT1)+TRABUF(TWTAMT2)+
     *                TRABUF(TWTAMT3)
        TRABUF(TWTOT) = TRABUF(TWAMT) * TRABUF(TWDUR) + TRABUF(TWTKC)
        TYPE*,'CALLING TRALOG'
        CALL TRALOG(TRABUF,BUF)
        TYPE*,'CALLING LOGTRA'
        CALL LOGTRA(TBUF,BUF)
        DO 249 I=1,TRALEN
        IF(TRABUF(I).NE.TBUF(I)) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
249     CONTINUE
        TYPE*,'TOTO SELECT WAGER DONE!'
C
C========================================================================
C
C TEST BINGO WAGER CONVERSION (NO KICKER)
C
2700    CONTINUE
        GOTO 2800
C 
        TYPE*,'TESTING BINGO WAGER '
C
        CALL FASTSET(0,TRABUF,TRALEN)
        CALL FASTSET(0,TBUF,TRALEN)
        DO 31110 I=1,11
        TRABUF(NOKIK(I))=0
31110   CONTINUE
C
C WAGER HEADER
C
        TRABUF(TSTAT)=FRAC
        TRABUF(TERR)=BDAY
        TRABUF(TSUBERR)=GREV_KIKCTL + GREV_KIKTXT
        TRABUF(TCDC)=9999
        TRABUF(TCDC_SOLD)=9990
        TRABUF(TSER)=64123499
        TRABUF(TTIM)='00112233'X
        TRABUF(TTER)=6000
        TRABUF(TAGT)='00BBCCDD'X
        TRABUF(TTRN)=15
        TRABUF(TTYP)=TWAG
        TRABUF(TGAMTYP)=TBNG
        TRABUF(TGAMIND)=2
        TRABUF(TTSTCS)='FE'X
        TRABUF(TINTRA)=1
        TRABUF(TFIL)=4
        TRABUF(TTKID) = 1
        TRABUF(TCHK)='FD'X
        TRABUF(TFRAC)=10
        TRABUF(TSIZE)=3
        TRABUF(TWBEG) = 1
        TRABUF(TWEND) = 2
        TRABUF(TWTKC)=40
        TRABUF(TWAMT) = 10000
        TRABUF(TWDUR) = 2
        TRABUF(TWQPF)=1
        TRABUF(TWCSER)=64000001
        TRABUF(TWCTER)=6000
        TRABUF(TWVSTS)=VSBNKM
        TRABUF(TWNBET) = 12
        TRABUF(TWSYST) = CHCSYS
        TRABUF(TWSYSN) = 40
        TRABUF(TWBNKID)=888881
        TRABUF(TWBNKNM)=99999991
        TRABUF(TWFFLG)=1
        TRABUF(TWMFRAC)=10
        TRABUF(TWTOT)=TRABUF(TWAMT)*TRABUF(TWDUR)+TRABUF(TWTKC)
C
C BINGO WAGER BODY
C
      
        DO 3111 I = TWBBFH1,TWBBFH1+7
           TRABUF(I) = I
3111    CONTINUE
        TRABUF(TWBSED)=2147483000
        TRABUF(TWBBAS) =12
        TRABUF(TWBLUK)=99999999

        CALL TRALOG(TRABUF,BUF)
        CALL LOGTRA(TBUF,BUF)
        DO 3120 I=1,TRALEN
           IF(TRABUF(I).NE.TBUF(I)) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
3120    CONTINUE
        TYPE*,'BINGO WAGER DONE'
C
C========================================================================
C
C---- Added by Paul Brannigan. - 08-11-1995.
C---- DOUBLE + COUPLE project.

C
C TEST SUPER DOUBLE WAGER CONVERSION
C
2800    CONTINUE
        GOTO 2900
C    
        TYPE*,'TESTING SUPER DOUBLE WAGER......'
C
        CALL FASTSET(0,TRABUF,TRALEN)
        CALL FASTSET(0,TBUF,TRALEN)
        DO 441 I=1,TWDBAMT+TWDBBLEN*TWDBBMAX-1
        TRABUF(I)=I
441     CONTINUE
        DO 4410 I=1,11
        TRABUF(NOKIK(I))=0
4410    CONTINUE
        TRABUF(TINTRA)=1
        TRABUF(TTYP)=TWAG
        TRABUF(TGAMTYP)=TDBL
        TRABUF(TGAMIND)=6
        TRABUF(TWQPF)=0
        TRABUF(TTKID)=0
        TRABUF(TSIZE)=2
        TRABUF(TFIL)=1
        TRABUF(TWBEG)=1
        TRABUF(TWEND)=TRABUF(TWBEG)
        TRABUF(TWDUR)=1
        TRABUF(TWBNKID)=888881
        TRABUF(TWBNKNM)=99999992
        TRABUF(TWCSER)=123345678
        TRABUF(TWCTER)=6000
        TRABUF(TWTKC)=200
        TRABUF(TWVSTS)=VSBNKM
        TRABUF(TWNBET)=10
        TRABUF(TWFFLG)=0
        TRABUF(TWMFRAC)=0
        TRABUF(TWAMT)=TRABUF(TWDBAMT)+
     *                TRABUF(TWDBAMT+TWDBBLEN)   +
     *                TRABUF(TWDBAMT+TWDBBLEN*2) +
     *                TRABUF(TWDBAMT+TWDBBLEN*3) +
     *                TRABUF(TWDBAMT+TWDBBLEN*4) +
     *                TRABUF(TWDBAMT+TWDBBLEN*5) +
     *                TRABUF(TWDBAMT+TWDBBLEN*6) +
     *                TRABUF(TWDBAMT+TWDBBLEN*7) +
     *                TRABUF(TWDBAMT+TWDBBLEN*8) +
     *                TRABUF(TWDBAMT+TWDBBLEN*9)
        TRABUF(TWTOT) = TRABUF(TWAMT) * TRABUF(TWDUR) + TRABUF(TWTKC)
C
        CALL TRALOG(TRABUF,BUF)
        CALL LOGTRA(TBUF,BUF)
        DO 443 I=1,TRALEN
        IF(TRABUF(I).NE.TBUF(I)) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
443     CONTINUE
        TYPE*,'SUPER DOUBLE WAGER DONE!'
C
C=========================================================================
C
C TEST TODAYS COUPLE WAGER CONVERSION
C
2900    CONTINUE
        GOTO 3000
C 
        TYPE*,'TESTING TODAYS COUPLE WAGER......'
C
        CALL FASTSET(0,TRABUF,TRALEN)
        CALL FASTSET(0,TBUF,TRALEN)
        DO 451 I=1,TWCPAMT+TWCPBLEN*TWCPBMAX-1
        TRABUF(I)=I
451     CONTINUE
        DO 4510 I=1,11
        TRABUF(NOKIK(I))=0
4510    CONTINUE
        TRABUF(TINTRA)=1
        TRABUF(TTYP)=TWAG
        TRABUF(TGAMTYP)=TCPL
        TRABUF(TGAMIND)=6
        TRABUF(TWQPF)=0
        TRABUF(TTKID)=0
        TRABUF(TSIZE)=2
        TRABUF(TFIL)=1
        TRABUF(TWBEG)=1
        TRABUF(TWEND)=TRABUF(TWBEG)
        TRABUF(TWDUR)=1
        TRABUF(TWBNKID)=888881
        TRABUF(TWBNKNM)=99999992
        TRABUF(TWCSER)=123345678
        TRABUF(TWCTER)=6000
        TRABUF(TWTKC)=200
        TRABUF(TWVSTS)=VSBNKM
        TRABUF(TWNBET)=10
        TRABUF(TWFFLG)=0
        TRABUF(TWMFRAC)=0
        TRABUF(TWAMT)=TRABUF(TWCPAMT)+
     *                TRABUF(TWCPAMT+TWCPBLEN)   +
     *                TRABUF(TWCPAMT+TWCPBLEN*2) +
     *                TRABUF(TWCPAMT+TWCPBLEN*3) +
     *                TRABUF(TWCPAMT+TWCPBLEN*4) +
     *                TRABUF(TWCPAMT+TWCPBLEN*5) +
     *                TRABUF(TWCPAMT+TWCPBLEN*6) +
     *                TRABUF(TWCPAMT+TWCPBLEN*7) +
     *                TRABUF(TWCPAMT+TWCPBLEN*8) +
     *                TRABUF(TWCPAMT+TWCPBLEN*9)
        TRABUF(TWTOT) = TRABUF(TWAMT) * TRABUF(TWDUR) + TRABUF(TWTKC)
C
        CALL TRALOG(TRABUF,BUF)
        CALL LOGTRA(TBUF,BUF)
        DO 453 I=1,TRALEN
        IF(TRABUF(I).NE.TBUF(I)) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
453     CONTINUE
        TYPE*,'SUPER DOUBLE WAGER DONE!'
C
C====================================================================
C
C TEST TODAY'S TRIO WAGER CONVERSION
C
3000    CONTINUE
        GOTO 3100
C
        TYPE*,'TESTING TODAY''S TRIO WAGER......'
        CALL FASTSET(0,TRABUF,TRALEN)
        CALL FASTSET(0,TBUF,TRALEN)
        DO 464 I=1,TWTTCOUPID+3+TWTTBMAX
        TRABUF(I)=I
464     CONTINUE
        DO 4610 I=1,11
        TRABUF(NOKIK(I))=0
4610    CONTINUE
        TRABUF(TINTRA)=1
        TRABUF(TTYP)=TWAG
        TRABUF(TGAMTYP)=TTRP
        TRABUF(TGAMIND)=6
        TRABUF(TWQPF)=0
        TRABUF(TTKID)=0
        TRABUF(TSIZE)=2
        TRABUF(TFIL)=1
        TRABUF(TWBEG)=1
        TRABUF(TWEND)=TRABUF(TWBEG)
        TRABUF(TWDUR)=1
        TRABUF(TWBNKID)=888881
        TRABUF(TWBNKNM)=99999992
        TRABUF(TWCSER)=123345678
        TRABUF(TWCTER)=6000
        TRABUF(TWTKC)=200
        TRABUF(TWVSTS)=VSBNKM
        TRABUF(TWNBET)=10
        TRABUF(TWFFLG)=0
        TRABUF(TWMFRAC)=0
        TRABUF(TWAMT)=TRABUF(TWWAMT)
        TRABUF(TWTOT) = TRABUF(TWAMT) * TRABUF(TWDUR) + TRABUF(TWTKC)
        CALL TRALOG(TRABUF,BUF)
        CALL LOGTRA(TBUF,BUF)
        DO 466 I=1,TRALEN
        IF(TRABUF(I).NE.TBUF(I)) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
466     CONTINUE
        TYPE*,'TODAYS TRIO WAGER DONE!'
C
C========================================================================
C
C TEST SUPERSCORE WAGER CONVERSION
C
3100    CONTINUE
        GOTO 3200
C
        TYPE*,'TESTING SUPERSCORE WAGER......'
        CALL FASTSET(0,TRABUF,TRALEN)
        CALL FASTSET(0,TBUF,TRALEN)
        DO 474 I=TWSSBET,TWSSBET+30-1
        TRABUF(I)=I
474     CONTINUE
        DO 4710 I=1,11
        TRABUF(NOKIK(I))=0
4710    CONTINUE
        TRABUF(TINTRA)=1
        TRABUF(TTYP)=TWAG
        TRABUF(TGAMTYP)=TSSC
        TRABUF(TGAMIND)=6
        TRABUF(TWQPF)=0
        TRABUF(TTKID)=0
        TRABUF(TSIZE)=2
        TRABUF(TFIL)=1
        TRABUF(TWBEG)=1
        TRABUF(TWEND)=TRABUF(TWBEG)
        TRABUF(TWDUR)=1
        TRABUF(TWBNKID)=888881
        TRABUF(TWBNKNM)=99999992
        TRABUF(TWCSER)=123345678
        TRABUF(TWCTER)=6000
        TRABUF(TWTKC)=200
        TRABUF(TWVSTS)=VSBNKM
        TRABUF(TWNBET)=1
        TRABUF(TWSYSN)=1
        TRABUF(TWFFLG)=0
        TRABUF(TWMFRAC)=0
        TRABUF(TWAMT)=TRABUF(TWWAMT)
        TRABUF(TWTOT) = TRABUF(TWAMT) * TRABUF(TWDUR) + TRABUF(TWTKC)
        CALL TRALOG(TRABUF,BUF)
        CALL LOGTRA(TBUF,BUF)
        DO 476 I=1,TRALEN
        IF(TRABUF(I).NE.TBUF(I)) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
476     CONTINUE
C        DO I=8,22
C        I4TEMP=BUF(I)
C        TYPE 21111, I,I1TEMP(4), I1TEMP(3), I1TEMP(2), I1TEMP(1)
C21111   FORMAT(2X,'WORD=',I2,2X,4(Z3.2))
C        ENDDO
        TYPE*,'SUPERSCORE WAGER DONE!'
C
C========================================================================
C
C TEST SUPER TRIPLE WAGER CONVERSION
C
3200    CONTINUE
        GOTO 3300
C 
        TYPE*,'TESTING SUPER TRIPLE WAGER......'
        CALL FASTSET(0,TRABUF,TRALEN)
        CALL FASTSET(0,TBUF,TRALEN)
        DO 484 I=1,TWSTCOUPID+3+TWSTBMAX
        TRABUF(I)=I
484     CONTINUE
        DO 4810 I=1,11
        TRABUF(NOKIK(I))=0
4810    CONTINUE
        TRABUF(TCDC)=9999
        TRABUF(TCDC_SOLD)=9990
        TRABUF(TINTRA)=1
        TRABUF(TTYP)=TWAG
        TRABUF(TGAMTYP)=TSTR
        TRABUF(TGAMIND)=6
        TRABUF(TWQPF)=0
        TRABUF(TTKID)=0
        TRABUF(TSIZE)=2
        TRABUF(TFIL)=1
        TRABUF(TWBEG)=1
        TRABUF(TWEND)=TRABUF(TWBEG)
        TRABUF(TWDUR)=1
        TRABUF(TWBNKID)=888881
        TRABUF(TWBNKNM)=99999992
        TRABUF(TWCSER)=123345678
        TRABUF(TWCTER)=6000
        TRABUF(TWTKC)=200
        TRABUF(TWVSTS)=VSBNKM
        TRABUF(TWNBET)=10
        TRABUF(TWFFLG)=0
        TRABUF(TWMFRAC)=0
        TRABUF(TWAMT)=TRABUF(TWWAMT)
        TRABUF(TWTOT) = TRABUF(TWAMT) * TRABUF(TWDUR) + TRABUF(TWTKC)
        CALL TRALOG(TRABUF,BUF)
        CALL LOGTRA(TBUF,BUF)
        DO 486 I=1,TRALEN
        IF(TRABUF(I).NE.TBUF(I)) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
486     CONTINUE
        TYPE*,'SUPER TRIPLE WAGER DONE!'
C
C================================================================== 
C
C TEST KICKER WAGER SYSTEM BET CONVERSION 
C
3300    CONTINUE
        GOTO 9000
C
        TYPE*,'TESTING JOKER WAGER (FULLSYS BET) '

        CALL FASTSET(0,TRABUF,TRALEN)
        CALL FASTSET(0,TBUF,TRALEN)
C
C WAGER HEADER
C
        TRABUF(TSTAT)=FRAC
        TRABUF(TERR)=BDAY
        TRABUF(TSUBERR)=GREV_KIKCTL + GREV_KIKTXT
        TRABUF(TCDC)=9999
        TRABUF(TCDC_SOLD)=9990
        TRABUF(TSER)=64123499
        TRABUF(TTIM)='00112233'X
        TRABUF(TTER)=6000
        TRABUF(TAGT)='00BBCCDD'X
        TRABUF(TTRN)=15
        TRABUF(TTYP)=TWAG
        TRABUF(TGAMTYP)=TKIK
        TRABUF(TGAMIND)=2
        TRABUF(TTSTCS)='FE'X
        TRABUF(TINTRA)=1
        TRABUF(TFIL)=4
        TRABUF(TTKID) = 1
        TRABUF(TCHK)='FD'X
        TRABUF(TFRAC)=10
        TRABUF(TSIZE)=3
        TRABUF(TWBEG) = 1
        TRABUF(TWEND) = 2
        TRABUF(TWTKC)=40
        TRABUF(TWAMT) = 10000
        TRABUF(TWDUR) = 2
        TRABUF(TWQPF)=1
        TRABUF(TWCSER)=64000001
        TRABUF(TWCTER)=6000
        TRABUF(TWVSTS)=VSBNKM
        TRABUF(TWNBET) = 1
        TRABUF(TWSYST) = FULSYS
        TRABUF(TWSYSN) = 40
        TRABUF(TWBNKID)=888881
        TRABUF(TWBNKNM)=99999991
        TRABUF(TWFFLG)=1
        TRABUF(TWMFRAC)=10
        TRABUF(TWTOT)=TRABUF(TWAMT)*TRABUF(TWDUR)+TRABUF(TWTKC)
!V20++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++        
        TRABUF(TWLNKSER) = 16777214
        TRABUF(TWLNKCHK) = 169
!V20++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++         
C
C KICKER WAGER BODY
C
        CALL TRALOG(TRABUF,BUF)
        CALL LOGTRA(TBUF,BUF)
        DO I=1,TRALEN
           IF(TRABUF(I).NE.TBUF(I)) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
        ENDDO
        TYPE*,'JOKER SYSTEM WAGER DONE '
C
C========================================================================
C
C TEST SPECIAL FUNCTION
C
9000    CONTINUE

        TYPE*,'==============================================='
        TYPE*,'TESTING SPECIAL FUNCTIONS........'
C
C TSON, HEADER
C
        CALL FASTSET(0,TRABUF,TRALEN)
        CALL FASTSET(0,TBUF,TRALEN)
        DO I=1,NOTUSD_CNT
           TRABUF(NOTUSD(I))=0
        ENDDO
        TRABUF(TSER)=64123499
        TRABUF(TCDC)=9999
        TRABUF(TTER)=12288
        TRABUF(TAGT)='00BBCCDD'X
        TRABUF(TNFRAC)=1 
        TRABUF(TTIM)='00112233'X
        TRABUF(TTSTCS)='FE'X
        TRABUF(TCHK)='FD'X
        TRABUF(TERR)=BDAY
        TRABUF(TGAM)=MAXGAM
        TRABUF(TSTAT)=FRAC
        TRABUF(TTYP)=TSPE
        TRABUF(TTRN)=15
        TRABUF(TSIZE)=2
        TRABUF(TINTRA)=1
        TRABUF(TFIL)=4
        TRABUF(TGAMTYP)=MAXTYP
        TRABUF(TTKID) = 1
        TRABUF(TFRAC)=1
        TRABUF(TSUBERR)=GREV_KIKCTL + GREV_KIKTXT
        TRABUF(TCDC_SOLD)=9990
C
C TSON, BODY
C
        DO I=TSOLD,TSDT21    !NB! TSDT22 is not logged for TSON!
           TRABUF(I)=I
        ENDDO
        TRABUF(TSFUN)=TSON
        TRABUF(TSSGN)=1
        CALL TRALOG(TRABUF,BUF)
        CALL LOGTRA(TBUF,BUF)
        DO I=1,TRALEN
           IF(TRABUF(I).NE.TBUF(I)) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
        ENDDO
        TYPE*,'SPECIAL FUNCTION (TSON) DONE!'
C
C TAGTINF, HEADER
C
        CALL FASTSET(0,TRABUF,TRALEN)
        CALL FASTSET(0,TBUF,TRALEN)
        DO I=1,NOTUSD_CNT
           TRABUF(NOTUSD(I))=0
        ENDDO
        TRABUF(TSER)=64123499
        TRABUF(TCDC)=9999
        TRABUF(TTER)=12288
        TRABUF(TAGT)='00BBCCDD'X
        TRABUF(TNFRAC)=1 
        TRABUF(TTIM)='00112233'X
        TRABUF(TTSTCS)='FE'X
        TRABUF(TCHK)='FD'X
        TRABUF(TERR)=BDAY
        TRABUF(TGAM)=MAXGAM
        TRABUF(TSTAT)=FRAC
        TRABUF(TTYP)=TSPE
        TRABUF(TTRN)=15
        TRABUF(TSIZE)=3
        TRABUF(TINTRA)=1
        TRABUF(TFIL)=4
        TRABUF(TGAMTYP)=MAXTYP
        TRABUF(TTKID) = 1
        TRABUF(TFRAC)=1
        TRABUF(TSUBERR)=GREV_KIKCTL + GREV_KIKTXT
        TRABUF(TCDC_SOLD)=9990
C
C TAGTINF, BODY
C
        DO I=TSDT1,TSDT1+38-1
           TRABUF(I)=I
        ENDDO
        TRABUF(TSFUN)=TAGTINF
        TRABUF(TSNEW)=38
        CALL TRALOG(TRABUF,BUF)
        CALL LOGTRA(TBUF,BUF)
        DO I=1,TRALEN
           IF(TRABUF(I).NE.TBUF(I)) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
        ENDDO
        TYPE*,'SPECIAL FUNCTION (TAGTINF) DONE!'
C
C TMXL, HEADER
C
        CALL FASTSET(0,TRABUF,TRALEN)
        CALL FASTSET(0,TBUF,TRALEN)
        DO I=1,NOTUSD_CNT
           TRABUF(NOTUSD(I))=0
        ENDDO
        TRABUF(TSER)=64123499
        TRABUF(TCDC)=9999
        TRABUF(TTER)=12288
        TRABUF(TAGT)='00BBCCDD'X
        TRABUF(TNFRAC)=1 
        TRABUF(TTIM)='00112233'X
        TRABUF(TTSTCS)='FE'X
        TRABUF(TCHK)='FD'X
        TRABUF(TERR)=BDAY
        TRABUF(TGAM)=MAXGAM
        TRABUF(TSTAT)=FRAC
        TRABUF(TTYP)=TSPE
        TRABUF(TTRN)=15
        TRABUF(TSIZE)=2
        TRABUF(TINTRA)=1
        TRABUF(TFIL)=4
        TRABUF(TGAMTYP)=MAXTYP
        TRABUF(TTKID) = 1
        TRABUF(TFRAC)=1
        TRABUF(TSUBERR)=GREV_KIKCTL + GREV_KIKTXT
        TRABUF(TCDC_SOLD)=9990
C
C TMXL, BODY
C
        TRABUF(TSFUN)=TMXL
        DO I=TMXL_RPCTAG,TMXL_RPCTAG+15  !30...45
           TRABUF(I)=I
        ENDDO
        TRABUF(TMXL_ERCODE)=111
        DO I=TMXL_DATA,TMXL_DATA+21      !47...68
           TRABUF(I)=I
        ENDDO 
        TRABUF(TMXL_DATLEN)=250
        CALL TRALOG(TRABUF,BUF)
        CALL LOGTRA(TBUF,BUF)
        DO I=1,TRALEN
           IF(TRABUF(I).NE.TBUF(I)) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
        ENDDO
        TYPE*,'SPECIAL FUNCTION (TMXL) DONE!'

        CALL FASTSET(0,TRABUF,TRALEN)
        CALL FASTSET(0,TBUF,TRALEN)
        DO I=1,NOTUSD_CNT
           TRABUF(NOTUSD(I))=0
        ENDDO
C
C=========================================================================
C
C TEST COMMAND CONVERSION
C
        TYPE*,'==============================================='
        TYPE*,'TESTING COMMANDS........'
        CALL FASTSET(0,TRABUF,TRALEN)
        CALL FASTSET(0,TBUF,TRALEN)
        DO I=1,NOTUSD_CNT
           TRABUF(NOTUSD(I))=0
        ENDDO 
C
C HEADER
C
        TRABUF(TSER)=64123499
        TRABUF(TCDC)=9999
        TRABUF(TTER)=12288
        TRABUF(TAGT)='00BBCCDD'X
        TRABUF(TNFRAC)=1 
        TRABUF(TTIM)='00112233'X
        TRABUF(TTSTCS)='FE'X
        TRABUF(TCHK)='FD'X
        TRABUF(TERR)=BDAY
        TRABUF(TGAM)=MAXGAM
        TRABUF(TSTAT)=FRAC
        TRABUF(TTYP)=TSPE
        TRABUF(TTRN)=15
        TRABUF(TSIZE)=2
        TRABUF(TINTRA)=1
        TRABUF(TFIL)=4
        TRABUF(TGAMTYP)=MAXTYP
        TRABUF(TTKID) = 1
        TRABUF(TFRAC)=1
        TRABUF(TSUBERR)=GREV_KIKCTL + GREV_KIKTXT
        TRABUF(TCDC_SOLD)=9990
C
C BODY
        DO I=TCMTYP,TCMDT5
           TRABUF(I)=I
        ENDDO
        CALL TRALOG(TRABUF,BUF)
        CALL LOGTRA(TBUF,BUF)
        DO I=1,TRALEN
           IF(TRABUF(I).NE.TBUF(I)) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
        ENDDO
        TYPE*,'COMMANDS DONE!'
C
C===================================================================
C
C TEST VALIDATION CONVERSION
C
        TYPE*,'==============================================='
        TYPE*,'TESTING PASSIVE BANK VALIDATION TRANSACTION......'
C
        CALL FASTSET(0,TRABUF,TRALEN)
        CALL FASTSET(0,TBUF,TRALEN)
        DO I=1,TVWCDC
           TRABUF(I)=I
        ENDDO
        DO I=1,NOTUSD_CNT
           TRABUF(NOTUSD(I))=0
        ENDDO 
        TRABUF(TGAMIND) = 2 
        TRABUF(TTKID) = 0
        TRABUF(TTYP)=TVAL
        TRABUF(TGAMTYP)=TPAS
        TRABUF(TTIM)='00112233'X
        TRABUF(TAGT)='00AABBCC'X
        TRABUF(TINTRA)=1
        TRABUF(TFIL)=4
        TRABUF(TSIZE)=2
        
        TRABUF(TVEPVAL) = 1
        TRABUF(TVEPWK) = 52
        TRABUF(TVEPYR) = 35
        TRABUF(TVEPTYP) = 5

        TRABUF(TPTCK) = 1 
        !TRABUF(TPRETYP)= 2
        !TRABUF(TPDUMMY)= 3
        TRABUF(TPOFFTER)= 1234
        !TRABUF(TPFRCNT)= 5

        TRABUF(TPNUM1)= 2345
        TRABUF(TPKEY1)=1
        TRABUF(TPPAY1) = 999999999
        TRABUF(TPEMIS1)=567
        TRABUF(TPSER1)=3
        TRABUF(TPTEN1)=4
        TRABUF(TPSTS1)=5

        TRABUF(TVPLCARD) = 987654321
        TRABUF(TVNIBBB) = 34567 
        TRABUF(TVNIBBO) = 45678
        TRABUF(TVNIBBA1) = 1234567890
        TRABUF(TVNIBBA2) = 250
        TRABUF(TVNIBCD) = 188

        CALL TRALOG(TRABUF,BUF)
        CALL LOGTRA(TBUF,BUF)
        DO I=1,TRALEN
           IF(TRABUF(I).NE.TBUF(I)) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
        ENDDO
        TYPE*,'PASSIVE BANK VALIDATION TRANSACTION DONE!'
        !TYPE*,'++++++++++++++++++++++++++++++++++++++++++++'
C
C PASSIVE BUNCH VALIDATION
C
        TYPE*,'=================================='
        TYPE*,'TESTING PASSIVE OLD BUNCH VALIDATION TRANSACTION......'

        CALL FASTSET(0,TRABUF,TRALEN)
        CALL FASTSET(0,TBUF,TRALEN)
        DO I=1,TVSTS-1
           TRABUF(I)=I
        ENDDO
        DO I=1,NOTUSD_CNT
           TRABUF(NOTUSD(I))=0
        ENDDO
        TRABUF(TGAMIND) = 2 
        TRABUF(TTKID) = 0
        TRABUF(TTYP)=TVAL
        TRABUF(TGAMTYP)=TPAS
        TRABUF(TTIM)='00112233'X
        TRABUF(TAGT)='00AABBCC'X
        TRABUF(TINTRA)=1
        TRABUF(TFIL)=4
        TRABUF(TSIZE)=3
        TRABUF(TCDC)=9999
        TRABUF(TCDC_SOLD)=9990

        TRABUF(TVEPVAL) = 0
        TRABUF(TVEPTYP) = 0
        TRABUF(TPTCK) = 2 
        !TRABUF(TPRETYP)= 2
        !TRABUF(TPDUMMY)= 3
        TRABUF(TPOFFTER)= 1234
        !TRABUF(TPFRCNT)= 5

        TRABUF(TPNUM1)= 2345
        TRABUF(TPKEY1)=1
        TRABUF(TPEMIS1)=567
        TRABUF(TPSER1)=3
        TRABUF(TPTEN1)=4
        TRABUF(TPSTS1)=5

        TRABUF(TPNUM2)= 12345
        TRABUF(TPKEY3)=2
        TRABUF(TPEMIS2)=167
        TRABUF(TPSER2)=2
        TRABUF(TPTEN2)=3
        TRABUF(TPSTS2)=4

        CALL TRALOG(TRABUF,BUF)
        CALL LOGTRA(TBUF,BUF)
        DO I=1,TRALEN
           IF(TRABUF(I).NE.TBUF(I)) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
        ENDDO 
        TYPE*,'PASSIVE OLD BUNCH VALIDATION TRANSACTION DONE!'
        !TYPE*,'+++++++++++++++++++++++++++++++++++++++++++++++++++++++'
C
C PASSIVE RETURNS
C
        TYPE*,'==============================================='
        TYPE*,'TESTING PASSIVE RETURN TRANSACTION......'
        CALL FASTSET(0,TRABUF,TRALEN)
        CALL FASTSET(0,TBUF,TRALEN)
        DO I=1,TVSTS-1
           TRABUF(I)=I
        ENDDO
        DO I=1,NOTUSD_CNT
           TRABUF(NOTUSD(I))=0
        ENDDO
        TRABUF(TGAMIND) = 2 
        TRABUF(TTKID) = 0
        TRABUF(TTYP)=TRET
        TRABUF(TGAMTYP)=TPAS
        TRABUF(TTIM)='00112233'X
        TRABUF(TAGT)='00AABBCC'X
        TRABUF(TINTRA)=1
        TRABUF(TFIL)=4
        TRABUF(TSIZE)=3
        
        TRABUF(TPTCK) = 2 
        TRABUF(TPRETYP)= 2
        !TRABUF(TPDUMMY)= 3
        TRABUF(TPOFFTER)= 1234
        TRABUF(TPFRCNT)= 5

        TRABUF(TPNUM1)= 2345
        TRABUF(TPKEY1)=1
        TRABUF(TPEMIS1)=567
        TRABUF(TPSER1)=3
        TRABUF(TPTEN1)=4
        TRABUF(TPSTS1)=5

        TRABUF(TPNUM2)= 12345
        TRABUF(TPKEY3)=2
        TRABUF(TPEMIS2)=167
        TRABUF(TPSER2)=2
        TRABUF(TPTEN2)=3
        TRABUF(TPSTS2)=4

        CALL TRALOG(TRABUF,BUF)
        CALL LOGTRA(TBUF,BUF)
        DO I=1,TRALEN
           IF(TRABUF(I).NE.TBUF(I)) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
        ENDDO 
        TYPE*,'PASSIVE RETURN TRANSACTION DONE!'
        !TYPE*,'++++++++++++++++++++++++++++++++++'
!===============================================================================        
C v24 BEGIN
C LOTTO TRANSACTIONS NEW FIELDS MESSAGEID, SERIAL OLIMPO, CHANNEL FLAG
C
!+++++++WAGER+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
        TYPE*,'==============================================='
        TYPE*,'BEGIN TESTING LOTTO NEW TRANSACTION FIELDS - MessageId,Serial Olimpo,Channel Flag'
        CALL FASTSET(0,TRABUF,TRALEN)
        CALL FASTSET(0,TBUF,TRALEN)
CCCCCCCCCCCC TRANSACTION HEADER CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC        
        TRABUF(TSER)    =64123499
        TRABUF(TCDC)    =9999
        TRABUF(TTER)    =6000
        TRABUF(TAGT)    ='000493E6'X!AGENT NUMBER 0300006
        TRABUF(TNFRAC)  =0
        TRABUF(TTIM)    ='00112233'X
        TRABUF(TTSTCS)  = 'FE'X    !TERMINAL STATISTICS (max possible flags 1111 1110 the last is 0 because x01 is not used so alls 0)
        TRABUF(TCHK)    = 'FD'X      !MESSAGE CHECKSUM (generated from the size of the message with the CDC and another field)
        TRABUF(TERR)    = NOER
C        TRABUF(TGAM)
        TRABUF(TSTAT)   = GOOD
CCCCCCCCCCCCCCCCCCCCCCCCCC        
        TRABUF(TTYP)    = TWAG
        TRABUF(TTRN)    = 15         !TRANSACTION SEQUENCE NUMBER
CCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TFIL)    = 4          !FILE STATUS
        TRABUF(TINTRA)  = 1        !INTERNAL TRANSACTION FLAG
        TRABUF(TSIZE)   = 3         !Number of Segments used in register the transaction/message in tmf file
        TRABUF(TGAMTYP) = TLTO ! TLTO = 2 --- GAME TYPE
        TRABUF(TGAMIND) = 4       !GAME INDEX 4 para totoloto de 4 feira (podia ser 3 de sabado)
CCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TTKID)   = 1       !TICKET ID
        TRABUF(TFAMTFLG)  = 0 
        TRABUF(TFRAC)   = 1         !# OF FRACTIONS (its LOTTO its not a fraction so alls 1?)
        TRABUF(TSUBERR) = NOER
C       TRABUF(TCDC)    =9999
        TRABUF(TCDC_SOLD)= 9990
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC TRANSACTION BODY CCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TWCSER)  = 64000001  !CASH/CANCEL SERIAL #
        TRABUF(TWAMT) = 10000 !BASE AMOUNT
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC        
        TRABUF(TWBEG)   = 1 !STARTING DRAW # alls one because its deprecated (related with field TWDUR)
        TRABUF(TWCTER)  = 6000      !CASH/CANCEL TERMINAL # (needs to be the same terminal as the register the Wager)
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TWQPF)   = 1  !QUICK PICK FLAGS  
        TRABUF(TWSIMP)  = 10 !# OF SIMPLE WAGERS
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TWSYSN)  = 40      !SYSTEM NUMBER --- 
        TRABUF(TWVSTS)  = VSBNKM    !VALIDATION STATUS -- (VSBNKM=17) !SET BANKING INFO/MULTI-DRAW
        TRABUF(TWCOLMCOMF_TLTO)=1
        TRABUF(TWDUR) = 1 !alls one because its deprecated (range 1-5 weeks the bet would replicate)      
        TRABUF(TWSYST)  = FULSYS  !SYSTEM TYPE ---(NOSYS=0) NO SYSTEM || (FULSYS=1) !FULL SYSTEM  ||  (CHCSYS=4) !C-SYSTEM
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC FLAGS CCCCCCCCCCCCCCCC
        TRABUF(TWNMRK)  = 7 !!#LOTTO MARKS/BOARD
        TRABUF(TWMFLG)  = 1  !BET MULTIPILER FLAG
        TRABUF(TWKGME)  = 0  !KICKER GAME # "0 no longer used"
        TRABUF(TWKFLG)  = 0  !KICKER SOLD FLAG "0 no longer used"
        TRABUF(TWFFLG)  = 0  !FRACTIONED WAGER FLAG "0 since no longer used"
        TRABUF(TWADDFW) = 0  !PROMOTION - ADD 1 FREE WEEK "never used"
        TRABUF(TWLMFI)  = 0  !LOTTO MONDAY FLAG INDICATOR "0 since no longer used"
C        TRABUF(TGAMTYP) = TLTO     
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC   
        TRABUF(TWCDCOFF)= 100 !CDC OFFSET FOR EXCH TKT. (FOR STATE) ....
        TRABUF(TWMFRAC) = 0        !INITIAL DEFINED FRACTIONS    
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC        
        TRABUF(TWBNKID) = 888881  !BANK ID NUMBER
        TRABUF(TWWEQP)  = 0         !WEIGHTED QP
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TWBNKNM) = 99999991!BANK ACCOUNT NUMBER 
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TWSRW)   = 13 !# OF ROWS BET (SPORTS) (alls 13) with extra 14
C        TRABUF(TGAMTYP) = TLTO 
        TRABUF(TWNBET)  = 10 !NUMBER OF BETS/BOARDS (confirmar mais tarde) max de 15
        TRABUF(TWLUCK)  = 1  !LUCKY NUMBER 
C        TRABUF(TWSPFRG) = 10 !NUMBER OF RESULTS GAMES (SPORTS) (confirmar mais tarde)
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC        
        TRABUF(TWCEBM)  = 0   !SPORTS GAME CANCELATION EVENTS BITMAP (confirmar mais tarde)
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TWKGME)  = 0   !KICKER GAME # "no longer in use so its 0"
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C        TRABUF(TAGT)  = '00AABBCC'X     
        TRABUF(TWCOLMSERL_TLTO)='630FFFFF'X!1661992959                
        TRABUF(TWCOLMSERM_TLTO)='6BC75E2D'X!1808227885                
        TRABUF(TWCOLMSERH_TLTO)='5'X
        TRABUF(TWCOLMMIDL_TLTO)='FFFFFFFF'X
        TRABUF(TWCOLMMIDH_TLTO)='7F'X
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
CCCC  wager            "transactionSerial": "210721-06-5858591847-214",  "210722-06-7294096008-457",
CCCC  cancellation     "transactionSerial": "210721-99-2011303816-981",  "210722-99-9599519946-580"
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC        
        TRABUF(TWTKC) = 40  !TICKET CHARGE
        TRABUF(TWTOT) = TRABUF(TWAMT)*TRABUF(TWDUR)+TRABUF(TWTKC)
        DO I = TWBORD,TWBORD+21-1 !TWBEND (7 nibbles * 10 = 70 nibbles = 35 bytes) TWBORD=88   110-88=22
                TRABUF(I) = I ! 35/4 = 8,75 = 9 Integers 88=0x110101F1,89,90,91,92,93,94,95,96,97 ... 110
        ENDDO
c        TRABUF(TWBORD) = '110101F1'X
c        TRABUF(TWBORD+1) = '110101F1'X
c        TRABUF(TWBORD+1) = '110101F1'X
c        TRABUF(TWBORD+1) = '110101F1'X
c        TRABUF(TWBORD+1) = '110101F1'X
c        TRABUF(TWBORD+1) = '110101F1'X
        TRABUF(TWEND)   = 1 !ENDING DRAW # alls one because its deprecated (related with field TWDUR)
        CALL FASTSET(0,TRABUF(TWMULT),12)
        CALL FASTSET(TRABUF(TWNMRK),TRABUF(TWNMRK+1),11)
        CALL TRALOG(TRABUF,BUF)
        CALL LOGTRA(TBUF,BUF)        
        DO I=1,TRALEN
           IF(TRABUF(I).NE.TBUF(I)) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
        ENDDO         
        TYPE*,'END TESTING LOTTO NEW TRANSACTION FIELDS DONE!'
!===============================================================================        
C v24 END
C LOTTO TRANSACTIONS NEW FIELDS MESSAGEID, SERIAL OLIMPO, CHANNEL FLAG
C MESID=1099511627775 - ffffffffff (max) || SERIAL=99999999999999999999 - 5.6BC75E2D.630FFFFF (max) || OLMFLAG=1
!+++++++WAGER+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
C 0300006(7) - 11189196 
!===============================================================================   
!===============================================================================        
C v24 BEGIN
C SPORTS TRANSACTIONS NEW FIELDS MESSAGEID, SERIAL OLIMPO, CHANNEL FLAG
C
!+++++++WAGER+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
        TYPE*,'==============================================='
        TYPE*,'BEGIN TESTING SPORTS NEW TRANSACTION FIELDS - MessageId,Serial Olimpo,Channel Flag'
        CALL FASTSET(0,TRABUF,TRALEN)
        CALL FASTSET(0,TBUF,TRALEN)
CCCCCCCCCCCC TRANSACTION HEADER CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC        
        TRABUF(TSER)    =64123499
        TRABUF(TCDC)    =9999
        TRABUF(TTER)    =6000
        TRABUF(TAGT)    ='000493E6'X!AGENT NUMBER 0300006
        TRABUF(TNFRAC)  =0
        TRABUF(TTIM)    ='00112233'X
        TRABUF(TTSTCS)  = 'FE'X    !TERMINAL STATISTICS (max possible flags 1111 1110 the last is 0 because x01 is not used so alls 0)
        TRABUF(TCHK)    = 'FD'X      !MESSAGE CHECKSUM (generated from the size of the message with the CDC and another field)
        TRABUF(TERR)    = NOER
C        TRABUF(TGAM)
        TRABUF(TSTAT)   = GOOD
CCCCCCCCCCCCCCCCCCCCCCCCCC        
        TRABUF(TTYP)    = TWAG
        TRABUF(TTRN)    =15         !TRANSACTION SEQUENCE NUMBER
CCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TFIL)    = 4          !FILE STATUS
        TRABUF(TINTRA)  = 1        !INTERNAL TRANSACTION FLAG
        TRABUF(TSIZE)   = 3         !Number of Segments used in register the transaction/message in tmf file
        TRABUF(TGAMTYP) = TSPT ! TLTO = 2 --- GAME TYPE
        TRABUF(TGAMIND) = 4       !GAME INDEX 4 para totoloto de 4 feira (podia ser 3 de sabado)
CCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TTKID)   = 1       !TICKET ID
        TRABUF(TFAMTFLG)  = 0 
        TRABUF(TFRAC)   = 1         !# OF FRACTIONS (its LOTTO its not a fraction so alls 1?)
        TRABUF(TSUBERR) = NOER
C       TRABUF(TCDC)    =9999
        TRABUF(TCDC_SOLD)= 9990
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC TRANSACTION BODY CCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TWCSER)  = 64000001  !CASH/CANCEL SERIAL #
        TRABUF(TWAMT) = 10000 !BASE AMOUNT
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC        
        TRABUF(TWBEG)   = 1 !STARTING DRAW # alls one because its deprecated (related with field TWDUR)
        TRABUF(TWCTER)  = 6000      !CASH/CANCEL TERMINAL # (needs to be the same terminal as the register the Wager)
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TWQPF)   = 1  !QUICK PICK FLAGS  
        TRABUF(TWSIMP)  = 10 !# OF SIMPLE WAGERS
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TWSYSN)  = 40      !SYSTEM NUMBER --- 
        TRABUF(TWVSTS)  = VSBNKM    !VALIDATION STATUS -- (VSBNKM=17) !SET BANKING INFO/MULTI-DRAW
        TRABUF(TWCOLMCOMF_TLTO)=1
        TRABUF(TWDUR) = 1 !alls one because its deprecated (range 1-5 weeks the bet would replicate)      
        TRABUF(TWSYST)  = FULSYS  !SYSTEM TYPE ---(NOSYS=0) NO SYSTEM || (FULSYS=1) !FULL SYSTEM  ||  (CHCSYS=4) !C-SYSTEM
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC FLAGS CCCCCCCCCCCCCCCC
        TRABUF(TWNMRK)  = 7 !!#LOTTO MARKS/BOARD
        TRABUF(TWMFLG)  = 1  !BET MULTIPILER FLAG
        TRABUF(TWKGME)  = 0  !KICKER GAME # "0 no longer used"
        TRABUF(TWKFLG)  = 0  !KICKER SOLD FLAG "0 no longer used"
        TRABUF(TWFFLG)  = 0  !FRACTIONED WAGER FLAG "0 since no longer used"
        TRABUF(TWADDFW) = 0  !PROMOTION - ADD 1 FREE WEEK "never used"
        TRABUF(TWLMFI)  = 0  !LOTTO MONDAY FLAG INDICATOR "0 since no longer used"
C        TRABUF(TGAMTYP) = TSPT     
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC   
        TRABUF(TWCDCOFF)= 100 !CDC OFFSET FOR EXCH TKT. (FOR STATE) ....
        TRABUF(TWMFRAC) = 0        !INITIAL DEFINED FRACTIONS    
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC        
        TRABUF(TWBNKID) = 888881  !BANK ID NUMBER
        TRABUF(TWWEQP)  = 0         !WEIGHTED QP
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TWBNKNM) = 99999991!BANK ACCOUNT NUMBER 
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TWSRW)   = 13 !# OF ROWS BET (SPORTS) (alls 13) with extra 14
C        TRABUF(TGAMTYP) = TSPT 
        TRABUF(TWNBET)  = 10      !NUMBER OF BETS/BOARDS (confirmar mais tarde)
C        TRABUF(TWLUCK)  = 1  !LUCKY NUMBER 
        TRABUF(TWSPFRG) = 10 !NUMBER OF RESULTS GAMES (SPORTS) (confirmar mais tarde)
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC  
C        CALL UPDSPT(TRABUF,0,ST)
C        CALL SET_CANCELATION_EVENTS_BITMAP(TRABUF)      
C        TRABUF(TWCEBM)  = 0   !SPORTS GAME CANCELATION EVENTS BITMAP (confirmar mais tarde)
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TWKGME)  = 0   !KICKER GAME # "no longer in use so its 0"
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C        TRABUF(TAGT)  = '00AABBCC'X     
        TRABUF(TWCOLMSERL_TLTO)='630FFFFF'X!1661992959                
        TRABUF(TWCOLMSERM_TLTO)='6BC75E2D'X!1808227885                
        TRABUF(TWCOLMSERH_TLTO)='5'X
        TRABUF(TWCOLMMIDL_TLTO)='FFFFFFFF'X
        TRABUF(TWCOLMMIDH_TLTO)='7F'X
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC        
        TRABUF(TWTKC) = 40  !TICKET CHARGE
        TRABUF(TWTOT) = TRABUF(TWAMT)*TRABUF(TWDUR)+TRABUF(TWTKC)
        DO I = TWBORD,TWBORD+17!15+15-1  !TWBEND (7 nibbles * 10 = 70 nibbles = 35 bytes)
                TRABUF(I) = I ! 35/4 = 8,75 = 9 Integers
        ENDDO     
        TRABUF(TWEND)   = 1 !ENDING DRAW # alls one because its deprecated (related with field TWDUR)
        CALL FASTSET(0,TRABUF(TWMULT),12)
        CALL FASTSET(TRABUF(TWNMRK),TRABUF(TWNMRK+1),11)
        CALL TRALOG(TRABUF,BUF)
        CALL LOGTRA(TBUF,BUF)        
        DO I=1,TRALEN
            IF(TRABUF(I).NE.TBUF(I)) THEN
                IF(I .NE. TWCEBM) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
            ENDIF
        ENDDO         
        TYPE*,'END TESTING SPORTS NEW TRANSACTION FIELDS DONE!'
!===============================================================================        
C v24 END
C SPORTS TRANSACTIONS NEW FIELDS MESSAGEID, SERIAL OLIMPO, CHANNEL FLAG
C MESID=1099511627775 - ffffffffff (max) || SERIAL=99999999999999999999 - 5.6BC75E2D.630FFFFF (max) || OLMFLAG=1
!+++++++WAGER+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
C 0300006(7) - 11189196       
!===========================LOTTO CANCELLATION=========================================== 
        TYPE*,'==============================================='
        TYPE*,'BEGIN TESTING LOTTO CANCELLATION NEW TRANSACTION FIELDS - MessageId,Serial Olimpo,Channel Flag'
        CALL FASTSET(0,TRABUF,TRALEN)
        CALL FASTSET(0,TBUF,TRALEN)
CCCCCCCCCCCC TRANSACTION HEADER CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC        
        TRABUF(TSER)    =64123499
        TRABUF(TCDC)    =9999
        TRABUF(TTER)    =6000
        TRABUF(TAGT)    ='000493E6'X!AGENT NUMBER 0300006
        TRABUF(TNFRAC)  =0
        TRABUF(TTIM)    ='00112233'X
        TRABUF(TTSTCS)  = 'FE'X    !TERMINAL STATISTICS (max possible flags 1111 1110 the last is 0 because x01 is not used so alls 0)
        TRABUF(TCHK)    = '7F'X      !MESSAGE CHECKSUM (generated from the size of the message with the CDC and another field)
        TRABUF(TERR)    = NOER
C        TRABUF(TGAM)
        TRABUF(TSTAT)   = GOOD
CCCCCCCCCCCCCCCCCCCCCCCCCC        
        TRABUF(TTYP)    = TCAN
        TRABUF(TTRN)    = 15         !TRANSACTION SEQUENCE NUMBER
CCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TFIL)    = 4          !FILE STATUS
        TRABUF(TINTRA)  = 1        !INTERNAL TRANSACTION FLAG
        TRABUF(TSIZE)   = 3         !Number of Segments used in register the transaction/message in tmf file
        TRABUF(TGAMTYP) = TLTO ! TLTO = 2 --- GAME TYPE
        TRABUF(TGAMIND) = 4       !GAME INDEX 4 para totoloto de 4 feira (podia ser 3 de sabado)
CCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TTKID)   = 1       !TICKET ID
        TRABUF(TFAMTFLG)  = 0 
        TRABUF(TFRAC)   = 1         !# OF FRACTIONS (its LOTTO its not a fraction so alls 1?)
        TRABUF(TSUBERR) = NOER
C       TRABUF(TCDC)    =9999
        TRABUF(TCDC_SOLD)= 9990
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC TRANSACTION BODY CCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TWCSER)  = 64000001  !CASH/CANCEL SERIAL #
        TRABUF(TWAMT) = 10000 !BASE AMOUNT
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC        
        TRABUF(TWBEG)   = 1 !STARTING DRAW # alls one because its deprecated (related with field TWDUR)
        TRABUF(TWCTER)  = 6000      !CASH/CANCEL TERMINAL # (needs to be the same terminal as the register the Wager)
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TWQPF)   = 1  !QUICK PICK FLAGS  
        TRABUF(TWSIMP)  = 10 !# OF SIMPLE WAGERS
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TWSYSN)  = 40      !SYSTEM NUMBER --- 
        TRABUF(TWVSTS)  = VSBNKM    !VALIDATION STATUS -- (VSBNKM=17) !SET BANKING INFO/MULTI-DRAW
        TRABUF(TWCOLMCOMF_TLTO)=1
        TRABUF(TWDUR) = 1 !alls one because its deprecated (range 1-5 weeks the bet would replicate)      
        TRABUF(TWSYST)  = FULSYS  !SYSTEM TYPE ---(NOSYS=0) NO SYSTEM || (FULSYS=1) !FULL SYSTEM  ||  (CHCSYS=4) !C-SYSTEM
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC FLAGS CCCCCCCCCCCCCCCC
        TRABUF(TWNMRK)  = 7 !!#LOTTO MARKS/BOARD
        TRABUF(TWMFLG)  = 1  !BET MULTIPILER FLAG
        TRABUF(TWKGME)  = 0  !KICKER GAME # "0 no longer used"
        TRABUF(TWKFLG)  = 0  !KICKER SOLD FLAG "0 no longer used"
        TRABUF(TWFFLG)  = 0  !FRACTIONED WAGER FLAG "0 since no longer used"
        TRABUF(TWADDFW) = 0  !PROMOTION - ADD 1 FREE WEEK "never used"
        TRABUF(TWLMFI)  = 0  !LOTTO MONDAY FLAG INDICATOR "0 since no longer used"
C        TRABUF(TGAMTYP) = TLTO     
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC   
        TRABUF(TWCDCOFF)= 100 !CDC OFFSET FOR EXCH TKT. (FOR STATE) ....
        TRABUF(TWMFRAC) = 0        !INITIAL DEFINED FRACTIONS    
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC        
        TRABUF(TWBNKID) = 888881  !BANK ID NUMBER
        TRABUF(TWWEQP)  = 0         !WEIGHTED QP
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TWBNKNM) = 99999991!BANK ACCOUNT NUMBER 
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TWSRW)   = 13 !# OF ROWS BET (SPORTS) (alls 13) with extra 14
C        TRABUF(TGAMTYP) = TLTO 
        TRABUF(TWNBET)  = 10 !NUMBER OF BETS/BOARDS (confirmar mais tarde) max de 15
        TRABUF(TWLUCK)  = 1  !LUCKY NUMBER 
C        TRABUF(TWSPFRG) = 10 !NUMBER OF RESULTS GAMES (SPORTS) (confirmar mais tarde)
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC        
        TRABUF(TWCEBM)  = 0   !SPORTS GAME CANCELATION EVENTS BITMAP (confirmar mais tarde)
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TWKGME)  = 0   !KICKER GAME # "no longer in use so its 0"
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC  
        TRABUF(TWTKC) = 40  !TICKET CHARGE
        TRABUF(TWTOT) = TRABUF(TWAMT)*TRABUF(TWDUR)+TRABUF(TWTKC)      
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC     
        TRABUF(TCOLMSERL_TLTO)='630FFFFF'X!1661992959
        TRABUF(TCOLMSERM_TLTO)='6BC75E2D'X!1808227885  
        TRABUF(TCOLMSERH_TLTO)='5'X
        TRABUF(TCOLMMIDL_TLTO)='FFFFFFFF'X
        TRABUF(TCOLMMIDH_TLTO)='7F'X!removed the most significant bit (FF) that is being interpreted as the sign bit (0:+ 1:-)
        TRABUF(TCOLMCOMF_TLTO)=1
        TRABUF(TWCOLMSERL_TLTO)=0                
        TRABUF(TWCOLMSERM_TLTO)=0                
        TRABUF(TWCOLMSERH_TLTO)=0
        TRABUF(TWCOLMMIDL_TLTO)=0
        TRABUF(TWCOLMMIDH_TLTO)=0
        TRABUF(TWCOLMCOMF_TLTO)=0
        TRABUF(TWEND)   = 1 !ENDING DRAW # alls one because its deprecated (related with field TWDUR)        
        CALL TRALOG(TRABUF,BUF)
C        I4TEMP = BUF(12)
C        TYPE*,'FLAG:',I1TEMP(3)
        CALL LOGTRA(TBUF,BUF)        
        DO I=1,TRALEN
            IF(TRABUF(I).NE.TBUF(I)) THEN
                TYPE*,'IND ',I,TRABUF(I),TBUF(I)
            ENDIF
        ENDDO         
        TYPE*,'END TESTING LOTTO CANCELLATION NEW TRANSACTION FIELDS!' 
!===============================================================================        
C v24 BEGIN
C INSTANT LOTTERY TRANSACTIONS NEW FIELDS MESSAGEID, SERIAL OLIMPO, CHANNEL FLAG
!++++++++++++++++++++++LI/IL IRVMT+++++++++++++++++++++++++++++++++++++++++++++++   
!===============================================================================     
        TYPE*,'==============================================='
        TYPE*,'BEGIN TESTING LI IRVMT NEW TRANSACTION FIELDS - MessageId,Serial Olimpo,Channel Flag'  
        AUX_TICKET_VAL = 1 
CCCCCCCCCCCC TRANSACTION HEADER CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC        
C        TRABUF(TSER)    =64123499
7000    CONTINUE
        CALL FASTSET(0,TRABUF,TRALEN)
        CALL FASTSET(0,TBUF,TRALEN) 
        TRABUF(TIBCH)   = AUX_TICKET_VAL !'F'X max value   !NUMBER IN BATCH
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TCDC)    = 9999
        TRABUF(TTER)    = 6000
        TRABUF(TAGT)    = '000493E6'X!AGENT NUMBER 0300006
        TRABUF(TNFRAC)  = 0
        TRABUF(TTIM)    = '00112233'X
        TRABUF(TTSTCS)  = 'FE'X      !TERMINAL STATISTICS (max possible flags 1111 1110 the last is 0 because x01 is not used so alls 0)
        TRABUF(TCHK)    = '7F'X      !MESSAGE CHECKSUM (generated from the size of the message with the CDC and another field)
        TRABUF(TERR)    = NOER      
        TRABUF(TSTAT)   = GOOD
        TRABUF(TTYP)    = TCRS
        TRABUF(TITYP)   = IVAL   ! NEW BANK VALIDATION MODE LAYOUT   
        TRABUF(TIVMT)   = IRVMT             
C        TRABUF(TSIZE)   = 3       !Number of Segments used in register the transaction/message in tmf file
        TRABUF(TIIND)   = 'F'X
        TRABUF(TIVALM)  = 'FF'X
        TRABUF(TIVALT)  = 'FFFF'X
CCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TFIL)    = 0       !FILE STATUS
        TRABUF(TINTRA)  = 1       !INTERNAL TRANSACTION FLAG
        TRABUF(TGAMTYP) = TINS    !INSTANT TICKETS = 14 --- GAME TYPE
        TRABUF(TGAMIND) = 1       !GAME INDEX 1
C        TRABUF(TGAM)=GTNTAB(TINS,TRABUF(TGAMIND))
CCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TFRAC)   = 1         !# OF FRACTIONS (its LOTTO its not a fraction so alls 1?)
        TRABUF(TSUBERR) = NOER
C       TRABUF(TCDC)    =9999
        TRABUF(TCDC_SOLD)= 9990
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC TRANSACTION BODY CCCCCCCCCCCCCCCCCCCCCCCCCCC  
C        TRABUF(TIPLIDTYP)   = 'FF'X     !PLAYER ID TYPE
C        TRABUF(TINIBBA2)   = 'FF'X      !NIB ACCOUNT NUMBER (PART 2)
C        TRABUF(TINIBCD)   = 'FF'X       !NIB CHECK DIGITS
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC        
C        TRABUF(TIPLCARD)  = 'FFFFFFFF'X!PLAYER ID
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC        
C        TRABUF(TINIBBB)   = 'FFFF'X     !NIB BRANCH
C        TRABUF(TINIBBO)   = 'FFFF'X     !NIB OFFICE
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC        
C        TRABUF(TINIBBA1) = 'FFFFFFFF'X  !NIB ACCOUNT NUMBER (PART 1)
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC        
C        TRABUF(TINETPRZ)  = 'FFFFFFFF'X  !NET PRIZE AMOUNT                
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TVOLMCOMF_IL) = 1
        TRABUF(TVOLMSERL_IL) = '630FFFFF'X!1661992959
        TRABUF(TVOLMSERM_IL) = '6BC75E2D'X!1808227885       
        TRABUF(TVOLMSERH_IL) = '5'X
        TRABUF(TVOLMMIDL_IL) = 'FFFFFFFF'X
        TRABUF(TVOLMMIDH_IL) = 'FF'X    
        
        TRABUF(TTKID)        = 1       !TICKET ID
        TRABUF(TFAMTFLG)     = 0 
        TRABUF(TIXRF)        = 'FFFFFFFF'X
        TRABUF(TIVENV)       = '7F'X                  !ENVELOPE IDENTIFICATION NUMBER 127 max
        TRABUF(TIVAGT)       = 'FFFFFF'X
        TRABUF(TIVTYP)       = 'FF'X

        BUFIDX               = 11
        TRABUF(TIGAM1)       = 'FFF'X               !INSTANT GAME NUMBER            (43-49)
        TRABUF(TIPCK1)       = 'FFFFFF'X            !INSTANT PACK NUMBER            (50-56)
        TRABUF(TIVRN1)       = 'FFFFFFFF'X          !INSTANT VIRN NUMBER            (57-63)
        TRABUF(TILTX1)       = 'FFFF'X              !INSTANT LATEX NUMBER           (64-70)
        TRABUF(TIPCKSTS1)    = 'F'X                 !INSTANT PACK STATUS            (71-77)
        TRABUF(TITIM1)       = 'FFFE'X              !INSTANT TIME CASHED AT GVT     (78-84) note:haves to be even number
        TRABUF(TICDC1)       = 'FFFF'X              !INSTANT DATE CHASHED AT GVT    (85-91)
        TRABUF(TISTS1)       = 'FF'X                !INSTANT VALIDATION STATUS      (92-98)
        TRABUF(TIPRZ1)       = '7FFFFFFF'X          !INSTANT PRIZE FROM GAME PLAN   (99-105)
C        DO 2000 X = 0, TRABUF(TIBCH)-1 
C          I4TEMP     = IAND(TRABUF(TIPCK1+X),'00FFFFFF'X) 
C          I1TEMP(4)  = TRABUF(TISTS1+X)
C          LOGBUF(BUFIDX)  = I4TEMP
C          BUFIDX = BUFIDX + 1 
C          LOGBUF(BUFIDX) = TRABUF(TIVRN1+X)   
C          BUFIDX         = BUFIDX + 1 
CC
C          I2TEMP(1)  = TRABUF(TILTX1+X)
C          I2TEMP(2)  = IOR( ISHFT( TRABUF(TIPCKSTS1+X), 12), 
C     *                            IAND(  TRABUF(TIGAM1+X),'0FFF'X) ) 
C          LOGBUF(BUFIDX) = I4TEMP
C          BUFIDX = BUFIDX + 1 
CC
C          I2TEMP(1)      = TRABUF(TITIM1+X)/2
C          I2TEMP(2)      = TRABUF(TICDC1+X)
C          LOGBUF(BUFIDX) = I4TEMP
C          BUFIDX         = BUFIDX + 1 
CC
C          LOGBUF(BUFIDX) = TRABUF(TIPRZ1+X)
C          BUFIDX = BUFIDX + 1 
C
C          IF (MOD(BUFIDX,16).EQ.0) BUFIDX = BUFIDX + 1 
C2000      CONTINUE
        TRABUF(TGOLMCOMF_IL) = 1
        IF(TRABUF(TGOLMCOMF_IL) .EQ. 1) THEN
          IF(TRABUF(TIBCH).GE.1.AND.TRABUF(TIBCH).LT.4) THEN
            TRABUF(TSIZE) = 2
          ELSE IF (TRABUF(TIBCH).GE.4) THEN
            TRABUF(TSIZE) = 3
          ELSE
            TRABUF(TSIZE) = 2
          ENDIF
        ELSE
          IF(TRABUF(TIBCH).GE.1.AND.TRABUF(TIBCH).LE.4) THEN
            TRABUF(TSIZE) = 2
          ELSE IF (TRABUF(TIBCH).GE.5) THEN
            TRABUF(TSIZE) = 3
          ENDIF
        ENDIF 
        TRABUF(TGOLMCOMF_IL) = 0
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C THE MESSAGEID IS ONLY SAVED FOR VALIDATION OF ONE TICKET ALL OTHER CASES ITS NOT SAVED         C
C FOR LI/INSTANT TRANSACTIONS TTKID, TFAMTFLG, TFRAC, TFRAC, TSUBERR, TCDC                       C
C AND TCDC_SOLD ARE FIELDS IGNORED SINCE ALL ARE OVERRIDE BY TIXRF FIELD                         C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC 
        TYPE *,'TICKETS IN BATCH:',AUX_TICKET_VAL
C        TYPE *,'TRABUF(TSIZE):',TRABUF(TSIZE)
        CALL TRALOG(TRABUF,BUF)                    
        CALL LOGTRA(TBUF,BUF)
        DO I=1,TRALEN
           IF(TRABUF(I).NE.TBUF(I)) THEN
                IF(I.NE.25 .AND. 
     *          I.NE.TTKID .AND.
     *          I.NE.TFAMTFLG .AND.     
     *          I.NE.TFRAC .AND.
     *          I.NE.TSUBERR .AND.
     *          I.NE.TCDC .AND.     
     *          I.NE.TCDC_SOLD .AND.
     *          (I.NE.TVOLMMIDL_IL .AND. TRABUF(TIBCH).NE.1) .AND.
     *          (I.NE.TVOLMMIDH_IL .AND. TRABUF(TIBCH).NE.1)
     *          ) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
           ENDIF
        ENDDO     
        AUX_TICKET_VAL = AUX_TICKET_VAL + 1
        IF(AUX_TICKET_VAL .LE. 7) GOTO 7000  
        TYPE*,'END TESTING LI IRVMT NEW TRANSACTION FIELDS - MessageId,Serial Olimpo,Channel Flag'                           
!===============================================================================        
C v24 END
C INSTANT LOTTERY TRANSACTIONS NEW FIELDS MESSAGEID, SERIAL OLIMPO, CHANNEL FLAG
!++++++++++++++++++++++LI/IL IRVMT+++++++++++++++++++++++++++++++++++++++++++++++   
!===============================================================================               
!===============================================================================        
C v24 BEGIN
C INSTANT LOTTERY TRANSACTIONS NEW FIELDS MESSAGEID, SERIAL OLIMPO, CHANNEL FLAG
!++++++++++++++++++++++LI/IL IBVMT+++++++++++++++++++++++++++++++++++++++++++++++   
!===============================================================================     
        TYPE*,'==============================================='
        TYPE*,'BEGIN TESTING LI IBVMT NEW TRANSACTION FIELDS - MessageId,Serial Olimpo,Channel Flag'
        CALL FASTSET(0,TRABUF,TRALEN)
        CALL FASTSET(0,TBUF,TRALEN)    
CCCCCCCCCCCC TRANSACTION HEADER CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC        
C        TRABUF(TSER)    =64123499
        TRABUF(TCDC)    = 9999
        TRABUF(TTER)    = 6000
        TRABUF(TAGT)    = '000493E6'X!AGENT NUMBER 0300006
        TRABUF(TNFRAC)  = 0
        TRABUF(TTIM)    = '00112233'X
        TRABUF(TTSTCS)  = 'FE'X      !TERMINAL STATISTICS (max possible flags 1111 1110 the last is 0 because x01 is not used so alls 0)
        TRABUF(TCHK)    = '7F'X      !MESSAGE CHECKSUM (generated from the size of the message with the CDC and another field)
        TRABUF(TERR)    = NOER      
        TRABUF(TSTAT)   = GOOD
        TRABUF(TTYP)    = TCRS
        TRABUF(TITYP)   = IVAL   ! NEW BANK VALIDATION MODE LAYOUT   
        TRABUF(TIVMT)   = IBVMT             
        TRABUF(TSIZE)   = 3       !Number of Segments used in register the transaction/message in tmf file (3 for the batch 7 tickets)
        TRABUF(TIIND)   = 'F'X
        TRABUF(TIBCH)   = 7       !'F'X max value   !NUMBER IN BATCH
        TRABUF(TIVALM)  = 'FF'X
        TRABUF(TIVALT)  = 'FFFF'X
CCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TFIL)    = 0       !FILE STATUS
        TRABUF(TINTRA)  = 1       !INTERNAL TRANSACTION FLAG
        TRABUF(TGAMTYP) = TINS    !INSTANT TICKETS = 14 --- GAME TYPE
        TRABUF(TGAMIND) = 1       !GAME INDEX 1
C        TRABUF(TGAM)=GTNTAB(TINS,TRABUF(TGAMIND))
CCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TFRAC)   = 1         !# OF FRACTIONS (its LOTTO its not a fraction so alls 1?)
        TRABUF(TSUBERR) = NOER
C       TRABUF(TCDC)    =9999
        TRABUF(TCDC_SOLD)= 9990
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC TRANSACTION BODY CCCCCCCCCCCCCCCCCCCCCCCCCCC  
        TRABUF(TIPCK1)   = 'FFFFFF'X          !INSTANT PACK NUMBER            (50-56)
        TRABUF(TISTS1)   = 'FF'X
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TIVRN1)   = 'FFFFFFFF'X  
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC                 
        TRABUF(TILTX1)   = 'FFFF'X
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC         
        TRABUF(TIPCKSTS1)= 'F'X
        TRABUF(TIGAM1)   = 'FFF'X   
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TITIM1)   = 'FFFE'X              !INSTANT TIME CASHED AT GVT   note:haves to be even number
        TRABUF(TICDC1)   = 'FFFF'X
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TIPRZ1)   = 'FFFFFFFF'X
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TIPLIDTYP)   = 'FF'X     !PLAYER ID TYPE
        TRABUF(TINIBBA2)   = 'FF'X      !NIB ACCOUNT NUMBER (PART 2)
        TRABUF(TINIBCD)   = 'FF'X       !NIB CHECK DIGITS
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC        
        TRABUF(TIPLCARD)  = 'FFFFFFFF'X!PLAYER ID
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC        
        TRABUF(TINIBBB)   = 'FFFF'X     !NIB BRANCH
        TRABUF(TINIBBO)   = 'FFFF'X     !NIB OFFICE
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC        
        TRABUF(TINIBBA1) = 'FFFFFFFF'X  !NIB ACCOUNT NUMBER (PART 1)
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC        
        TRABUF(TINETPRZ)  = 'FFFFFFFF'X  !NET PRIZE AMOUNT                
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TVOLMCOMF_IL) = 1
        TRABUF(TVOLMSERL_IL) = '630FFFFF'X!1661992959
        TRABUF(TVOLMSERM_IL) = '6BC75E2D'X!1808227885       
        TRABUF(TVOLMSERH_IL) = '5'X
        TRABUF(TVOLMMIDL_IL) = 'FFFFFFFF'X
        TRABUF(TVOLMMIDH_IL) = '7F'X    
 
        
        
        TRABUF(TTKID)   = 1       !TICKET ID
        TRABUF(TFAMTFLG)  = 0 
        TRABUF(TIXRF) = 'FFFFFFFF'X
        TRABUF(TIVENV) = '7F'X          !ENVELOPE IDENTIFICATION NUMBER
        TRABUF(TIVAGT) = 'FFFFFF'X
        TRABUF(TIVTYP) = 'FF'X
        CALL TRALOG(TRABUF,BUF)            
        CALL LOGTRA(TBUF,BUF)
        DO I=1,TRALEN
           IF(TRABUF(I).NE.TBUF(I)) THEN
                IF(I.NE.25 .AND. 
     *          I.NE.TTKID .AND.
     *          I.NE.TFAMTFLG .AND.     
     *          I.NE.TFRAC .AND.
     *          I.NE.TSUBERR .AND.
     *          I.NE.TCDC .AND.     
     *          I.NE.TCDC_SOLD) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
           ENDIF
        ENDDO         
        TYPE*,'END TESTING LI IBVMT NEW TRANSACTION FIELDS - MessageId,Serial Olimpo,Channel Flag'                           
!===============================================================================        
C v24 END
C INSTANT LOTTERY TRANSACTIONS NEW FIELDS MESSAGEID, SERIAL OLIMPO, CHANNEL FLAG
!++++++++++++++++++++++LI/IL IBVMT+++++++++++++++++++++++++++++++++++++++++++++++   
!===============================================================================
!===============================================================================        
C v24 BEGIN
C INSTANT LOTTERY TRANSACTIONS NEW FIELDS MESSAGEID, SERIAL OLIMPO, CHANNEL FLAG
!++++++++++++++++++++++LI/IL ILOT+++++++++++++++++++++++++++++++++++++++++++++++   
!===============================================================================     
        TYPE*,'==============================================='
        TYPE*,'BEGIN TESTING LI ILOT NEW TRANSACTION FIELDS - MessageId,Serial Olimpo,Channel Flag'
        CALL FASTSET(0,TRABUF,TRALEN)
        CALL FASTSET(0,TBUF,TRALEN)    
CCCCCCCCCCCC TRANSACTION HEADER CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC        
C        TRABUF(TSER)    =64123499
        TRABUF(TCDC)    =9999
        TRABUF(TTER)    =6000
        TRABUF(TAGT)    ='000493E6'X!AGENT NUMBER 0300006
        TRABUF(TNFRAC)  =0
        TRABUF(TTIM)    ='00112233'X
        TRABUF(TTSTCS)  = 'FE'X      !TERMINAL STATISTICS (max possible flags 1111 1110 the last is 0 because x01 is not used so alls 0)
        TRABUF(TCHK)    = '7F'X      !MESSAGE CHECKSUM (generated from the size of the message with the CDC and another field)
        TRABUF(TERR)    = NOER      
        TRABUF(TSTAT)   = GOOD
        TRABUF(TTYP)    = TCRS
CCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TFIL)    = 0       !FILE STATUS
        TRABUF(TINTRA)  = 1       !INTERNAL TRANSACTION FLAG
        TRABUF(TSIZE)   = 2       !Number of Segments used in register the transaction/message in tmf file
        TRABUF(TGAMTYP) = TINS    !INSTANT TICKETS = 14 --- GAME TYPE
        TRABUF(TGAMIND) = 1       !GAME INDEX 1
C        TRABUF(TGAM)=GTNTAB(TINS,TRABUF(TGAMIND))
CCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TTKID)   = 1       !TICKET ID
        TRABUF(TFAMTFLG)  = 0 
        TRABUF(TFRAC)   = 1         !# OF FRACTIONS (its LOTTO its not a fraction so alls 1?)
        TRABUF(TSUBERR) = NOER
C       TRABUF(TCDC)    =9999
        TRABUF(TCDC_SOLD)= 9990


        TRABUF(TIXRF) = 'FFFFFFFF'X
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC TRANSACTION BODY CCCCCCCCCCCCCCCCCCCCCCCCCCC        
        TRABUF(TITYP)   = ILOT   !INSTANT TYPE     
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TLREP)   = 'FFFFFF'X           !INSTANT LOT REP NUMBER     65535
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TLCLS)   = 'FF'X           !INSTANT LOT CLASS NUMBER   65535
        TRABUF(TLGAM)   = 0395              !INSTANT LOT GAME NUMBER
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TLSTR)   = 9999 !INSTANT LOT START SEQ #
        TRABUF(TLEND)   = 9999 !INSTANT LOT END SEQ #
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C        I1TEMP(4)       = 0
        TRABUF(TLPCK)   = 0000528           !INSTANT LOT PACK NUMBER
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TLAMT)   = 2500              !INSTANT LOT AMOUNT           
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TLCOM)   = 'FFFFFFFF'X        !INSTANT LOT COMMISION    
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TGOLMCOMF_IL) = 1
        TRABUF(TGOLMSERL_IL) = '630FFFFF'X!1661992959
        TRABUF(TGOLMSERM_IL) = '6BC75E2D'X!1808227885       
        TRABUF(TGOLMSERH_IL) = '5'X
        TRABUF(TGOLMMIDL_IL) = 'FFFFFFFF'X
        TRABUF(TGOLMMIDH_IL) = '7F'X    
    
        CALL TRALOG(TRABUF,BUF)
        I4TEMP = BUF(7)
C        I4TEMP = BUF(9)
C        TYPE*,'TLREP:',I4TEMP
C        TYPE*,'TITYP:',TRABUF(TITYP)        
        CALL LOGTRA(TBUF,BUF)
        DO I=1,TRALEN
           IF(TRABUF(I).NE.TBUF(I)) THEN
                IF(I.NE.25 .AND. 
     *          I.NE.TTKID .AND.
     *          I.NE.TFAMTFLG .AND.     
     *          I.NE.TFRAC .AND.
     *          I.NE.TSUBERR .AND.
     *          I.NE.TCDC .AND.     
     *          I.NE.TCDC_SOLD) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
           ENDIF
        ENDDO         
        TYPE*,'END TESTING LI ILOT NEW TRANSACTION FIELDS - MessageId,Serial Olimpo,Channel Flag'                           
!===============================================================================        
C v24 END
C INSTANT LOTTERY TRANSACTIONS NEW FIELDS MESSAGEID, SERIAL OLIMPO, CHANNEL FLAG
!++++++++++++++++++++++LI/IL ILOT+++++++++++++++++++++++++++++++++++++++++++++++   
!===============================================================================
!===============================================================================        
C v24 BEGIN
C INSTANT LOTTERY TRANSACTIONS NEW FIELDS MESSAGEID, SERIAL OLIMPO, CHANNEL FLAG
!++++++++++++++++++++++LI/IL ICAR+++++++++++++++++++++++++++++++++++++++++++++++   
!===============================================================================     
        TYPE*,'==============================================='
        TYPE*,'BEGIN TESTING LI ICAR NEW TRANSACTION FIELDS - MessageId,Serial Olimpo,Channel Flag'
        CALL FASTSET(0,TRABUF,TRALEN)
        CALL FASTSET(0,TBUF,TRALEN)    
CCCCCCCCCCCC TRANSACTION HEADER CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC        
C        TRABUF(TSER)    =64123499
        TRABUF(TCDC)    =9999
        TRABUF(TTER)    =6000
        TRABUF(TAGT)    ='000493E6'X!AGENT NUMBER 0300006
        TRABUF(TNFRAC)  =0
        TRABUF(TTIM)    ='00112233'X
        TRABUF(TTSTCS)  = 'FE'X      !TERMINAL STATISTICS (max possible flags 1111 1110 the last is 0 because x01 is not used so alls 0)
        TRABUF(TCHK)    = '7F'X      !MESSAGE CHECKSUM (generated from the size of the message with the CDC and another field)
        TRABUF(TERR)    = NOER      
        TRABUF(TSTAT)   = GOOD
        TRABUF(TTYP)    = TCRS
CCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TFIL)    = 0           !FILE STATUS
        TRABUF(TINTRA)  = 1        !INTERNAL TRANSACTION FLAG
        TRABUF(TSIZE)   = 2         !Number of Segments used in register the transaction/message in tmf file
        TRABUF(TGAMTYP) = TINS    !INSTANT TICKETS = 14 --- GAME TYPE
        TRABUF(TGAMIND) = 1       !GAME INDEX 1
C        TRABUF(TGAM)=GTNTAB(TINS,TRABUF(TGAMIND))
CCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TTKID)   = 1       !TICKET ID
        TRABUF(TFAMTFLG)  = 0 
        TRABUF(TFRAC)   = 1         !# OF FRACTIONS (its LOTTO its not a fraction so alls 1?)
        TRABUF(TSUBERR) = NOER
C       TRABUF(TCDC)    =9999
        TRABUF(TCDC_SOLD)= 9990

        TRABUF(TIXRF) = 'FFFFFFFF'X
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC TRANSACTION BODY CCCCCCCCCCCCCCCCCCCCCCCCCCC        
        TRABUF(TITYP)   = ICAR   !INSTANT TYPE     
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TCREP)   = 'FFFFFF'X           !INSTANT CAR REP NUMBER     65535
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TCCLS)   = 'FF'X             !INSTANT CAR CLASS NUMBER   65535
        TRABUF(TCGAM)   = 0395              !INSTANT CAR GAME NUMBER
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TCCAR)   = 'FFFFFFFF'X              !INSTANT CAR CARTON NUMBER
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C        I1TEMP(4)       = 0
        TRABUF(TCSTA)   = 'FFFFFFFF'X           !INSTANT CAR START PACK #
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TCEND)   = 'FFFFFFFF'X           !INSTANT CAR END PACK #       
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TCCNT)   = 'FFFFFFFF'X           !INSTANT CAR PACK COUNT  
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TGOLMCOMF_IL) = 1
        TRABUF(TGOLMSERL_IL) = '630FFFFF'X!1661992959
        TRABUF(TGOLMSERM_IL) = '6BC75E2D'X!1808227885       
        TRABUF(TGOLMSERH_IL) = '5'X
        TRABUF(TGOLMMIDL_IL) = 'FFFFFFFF'X
        TRABUF(TGOLMMIDH_IL) = '7F'X    
    

        CALL TRALOG(TRABUF,BUF)
        I4TEMP = BUF(7)
C        I4TEMP = BUF(9)
C        TYPE*,'TLREP:',I4TEMP
C        TYPE*,'TITYP:',TRABUF(TITYP)        
        CALL LOGTRA(TBUF,BUF)
        DO I=1,TRALEN
           IF(TRABUF(I).NE.TBUF(I)) THEN
                IF(I.NE.25 .AND. 
     *          I.NE.TTKID .AND.
     *          I.NE.TFAMTFLG .AND.     
     *          I.NE.TFRAC .AND.
     *          I.NE.TSUBERR .AND.
     *          I.NE.TCDC .AND.     
     *          I.NE.TCDC_SOLD) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
           ENDIF
        ENDDO         
        TYPE*,'END TESTING LI ICAR NEW TRANSACTION FIELDS - MessageId,Serial Olimpo,Channel Flag'                           
!===============================================================================        
C v24 END
C INSTANT LOTTERY TRANSACTIONS NEW FIELDS MESSAGEID, SERIAL OLIMPO, CHANNEL FLAG
!++++++++++++++++++++++LI/IL ICAR+++++++++++++++++++++++++++++++++++++++++++++++   
!===============================================================================
!===============================================================================        
C v24 BEGIN
C INSTANT LOTTERY TRANSACTIONS NEW FIELDS MESSAGEID, SERIAL OLIMPO, CHANNEL FLAG
!++++++++++++++++++++++LI/IL IQTA+++++++++++++++++++++++++++++++++++++++++++++++   
!===============================================================================     
        TYPE*,'==============================================='
        TYPE*,'BEGIN TESTING LI IQTA NEW TRANSACTION FIELDS - MessageId,Serial Olimpo,Channel Flag'
        CALL FASTSET(0,TRABUF,TRALEN)
        CALL FASTSET(0,TBUF,TRALEN)    
CCCCCCCCCCCC TRANSACTION HEADER CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC        
C        TRABUF(TSER)    =64123499
        TRABUF(TCDC)    =9999
        TRABUF(TTER)    =6000
        TRABUF(TAGT)    ='000493E6'X!AGENT NUMBER 0300006
        TRABUF(TNFRAC)  =0
        TRABUF(TTIM)    ='00112233'X
        TRABUF(TTSTCS)  = 'FE'X      !TERMINAL STATISTICS (max possible flags 1111 1110 the last is 0 because x01 is not used so alls 0)
        TRABUF(TCHK)    = '7F'X      !MESSAGE CHECKSUM (generated from the size of the message with the CDC and another field)
        TRABUF(TERR)    = NOER      
        TRABUF(TSTAT)   = GOOD
        TRABUF(TTYP)    = TCRS
CCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TFIL)    = 0           !FILE STATUS
        TRABUF(TINTRA)  = 1        !INTERNAL TRANSACTION FLAG
        TRABUF(TSIZE)   = 2         !Number of Segments used in register the transaction/message in tmf file
        TRABUF(TGAMTYP) = TINS    !INSTANT TICKETS = 14 --- GAME TYPE
        TRABUF(TGAMIND) = 1       !GAME INDEX 1
C        TRABUF(TGAM)=GTNTAB(TINS,TRABUF(TGAMIND))
CCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TTKID)   = 1       !TICKET ID
        TRABUF(TFAMTFLG)  = 0 
        TRABUF(TFRAC)   = 1         !# OF FRACTIONS (its LOTTO its not a fraction so alls 1?)
        TRABUF(TSUBERR) = NOER
C       TRABUF(TCDC)    =9999
        TRABUF(TCDC_SOLD)= 9990

        TRABUF(TIXRF) = 'FFFFFFFF'X
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC TRANSACTION BODY CCCCCCCCCCCCCCCCCCCCCCCCCCC        
        TRABUF(TITYP)   = IQTA      
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TRGAM)   = 'FFF'X                !REPORT GAME NUMBER 1byte+1nibble
        TRABUF(TRCLS)   = 'F'X                  !REPORT CLASS NUMBER
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TRNXT1)  = 'FFFF'X              !REPORT NEXT GAME/PRODUCT #
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TRNXT2)  = 'FFFFFFFF'X          !REPORT NEXT GAME/PRODUCT #
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TGOLMCOMF_IL) = 1
        TRABUF(TGOLMSERL_IL) = '630FFFFF'X!1661992959
        TRABUF(TGOLMSERM_IL) = '6BC75E2D'X!1808227885       
        TRABUF(TGOLMSERH_IL) = '5'X
        TRABUF(TGOLMMIDL_IL) = 'FFFFFFFF'X
        TRABUF(TGOLMMIDH_IL) = '7F'X    
    
        CALL TRALOG(TRABUF,BUF)
        I4TEMP = BUF(7)
C        I4TEMP = BUF(9)
C        TYPE*,'TLREP:',I4TEMP
C        TYPE*,'TITYP:',TRABUF(TITYP)        
        CALL LOGTRA(TBUF,BUF)
        DO I=1,TRALEN
           IF(TRABUF(I).NE.TBUF(I)) THEN
                IF(I.NE.25 .AND. 
     *          I.NE.TTKID .AND.
     *          I.NE.TFAMTFLG .AND.     
     *          I.NE.TFRAC .AND.
     *          I.NE.TSUBERR .AND.
     *          I.NE.TCDC .AND.     
     *          I.NE.TCDC_SOLD) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
           ENDIF
        ENDDO         
        TYPE*,'END TESTING LI IQTA NEW TRANSACTION FIELDS - MessageId,Serial Olimpo,Channel Flag'                           
!===============================================================================        
C v24 END
C INSTANT LOTTERY TRANSACTIONS NEW FIELDS MESSAGEID, SERIAL OLIMPO, CHANNEL FLAG
!++++++++++++++++++++++LI/IL IQTA+++++++++++++++++++++++++++++++++++++++++++++++   
!===============================================================================
!===============================================================================        
C v24 BEGIN
C INSTANT LOTTERY TRANSACTIONS NEW FIELDS MESSAGEID, SERIAL OLIMPO, CHANNEL FLAG
!++++++++++++++++++++++LI/IL IORD+++++++++++++++++++++++++++++++++++++++++++++++   
!===============================================================================     
        TYPE*,'==============================================='
        TYPE*,'BEGIN TESTING LI IORD NEW TRANSACTION FIELDS - MessageId,Serial Olimpo,Channel Flag'
        CALL FASTSET(0,TRABUF,TRALEN)
        CALL FASTSET(0,TBUF,TRALEN)    
CCCCCCCCCCCC TRANSACTION HEADER CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC        
C        TRABUF(TSER)    =64123499
        TRABUF(TCDC)    =9999
        TRABUF(TTER)    =6000
        TRABUF(TAGT)    ='000493E6'X!AGENT NUMBER 0300006
        TRABUF(TNFRAC)  =0
        TRABUF(TTIM)    ='00112233'X
        TRABUF(TTSTCS)  = 'FE'X      !TERMINAL STATISTICS (max possible flags 1111 1110 the last is 0 because x01 is not used so alls 0)
        TRABUF(TCHK)    = '7F'X      !MESSAGE CHECKSUM (generated from the size of the message with the CDC and another field)
        TRABUF(TERR)    = NOER      
        TRABUF(TSTAT)   = GOOD
        TRABUF(TTYP)    = TCRS
CCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TFIL)    = 0           !FILE STATUS
        TRABUF(TINTRA)  = 1        !INTERNAL TRANSACTION FLAG
        TRABUF(TSIZE)   = 2         !Number of Segments used in register the transaction/message in tmf file
        TRABUF(TGAMTYP) = TINS    !INSTANT TICKETS = 14 --- GAME TYPE
        TRABUF(TGAMIND) = 1       !GAME INDEX 1
C        TRABUF(TGAM)=GTNTAB(TINS,TRABUF(TGAMIND))
CCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TTKID)   = 1       !TICKET ID
        TRABUF(TFAMTFLG)  = 0 
        TRABUF(TFRAC)   = 1         !# OF FRACTIONS (its LOTTO its not a fraction so alls 1?)
        TRABUF(TSUBERR) = NOER
C       TRABUF(TCDC)    =9999
        TRABUF(TCDC_SOLD)= 9990

        TRABUF(TIXRF) = 'FFFFFFFF'X
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC TRANSACTION BODY CCCCCCCCCCCCCCCCCCCCCCCCCCC        
        TRABUF(TITYP)   = IORD      
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TGPGAM)   = 'FFFF'X               !GAME NUMBER
        TRABUF(TGPNXT)   = 'FFFF'X               !CONTINUATION GAME NUMBER
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TGPAGT)  = 'FFFFFFFF'X          !RETAILER NUMBER OF CREDIT LIMIT
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TGPRCL)  = 'FFFFFFFF'X          !REPORT NEXT GAME/PRODUCT #
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TGOLMCOMF_IL) = 1
        TRABUF(TGOLMSERL_IL) = '630FFFFF'X!1661992959
        TRABUF(TGOLMSERM_IL) = '6BC75E2D'X!1808227885       
        TRABUF(TGOLMSERH_IL) = '5'X
        TRABUF(TGOLMMIDL_IL) = 'FFFFFFFF'X
        TRABUF(TGOLMMIDH_IL) = '7F'X    
    
        CALL TRALOG(TRABUF,BUF)     
        CALL LOGTRA(TBUF,BUF)
        DO I=1,TRALEN
           IF(TRABUF(I).NE.TBUF(I)) THEN
C                IF(I.NE.25) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
                IF(I.NE.25 .AND. 
     *          I.NE.TTKID .AND.
     *          I.NE.TFAMTFLG .AND.     
     *          I.NE.TFRAC .AND.
     *          I.NE.TSUBERR .AND.
     *          I.NE.TCDC .AND.     
     *          I.NE.TCDC_SOLD) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
           ENDIF
        ENDDO         
        TYPE*,'END TESTING LI IORD NEW TRANSACTION FIELDS - MessageId,Serial Olimpo,Channel Flag'                           
!===============================================================================        
C v24 END
C INSTANT LOTTERY TRANSACTIONS NEW FIELDS MESSAGEID, SERIAL OLIMPO, CHANNEL FLAG
!++++++++++++++++++++++LI/IL IORD+++++++++++++++++++++++++++++++++++++++++++++++   
!===============================================================================   
!===============================================================================        
C v24 BEGIN
C INSTANT LOTTERY TRANSACTIONS NEW FIELDS MESSAGEID, SERIAL OLIMPO, CHANNEL FLAG
!++++++++++++++++++++++LI/IL IMNU+++++++++++++++++++++++++++++++++++++++++++++++   
!===============================================================================     
        TYPE*,'==============================================='
        TYPE*,'BEGIN TESTING LI IMNU NEW TRANSACTION FIELDS - MessageId,Serial Olimpo,Channel Flag'
        AUX_GAME_NUM = 1 
        AUX_INDEX = 1
7010    CONTINUE        
        CALL FASTSET(0,TRABUF,TRALEN)
        CALL FASTSET(0,TBUF,TRALEN)   
CCCCCCCCCCCC TRANSACTION HEADER CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC        
C        TRABUF(TSER)    =64123499
        TRABUF(TCDC)    =9999
        TRABUF(TTER)    =6000
        TRABUF(TAGT)    ='000493E6'X!AGENT NUMBER 0300006
        TRABUF(TNFRAC)  =0
        TRABUF(TTIM)    ='00112233'X
        TRABUF(TTSTCS)  = 'FE'X      !TERMINAL STATISTICS (max possible flags 1111 1110 the last is 0 because x01 is not used so alls 0)
        TRABUF(TCHK)    = '7F'X      !MESSAGE CHECKSUM (generated from the size of the message with the CDC and another field)
        TRABUF(TERR)    = NOER      
        TRABUF(TSTAT)   = GOOD       !STATUS  
        TRABUF(TTYP)    = TCRS
CCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TFIL)    = 0           !FILE STATUS
        TRABUF(TINTRA)  = 1        !INTERNAL TRANSACTION FLAG
        TRABUF(TSIZE)   = 1       !Number of Segments used in register the transaction/message in tmf file that also represents the internal serial number of MILL
        TRABUF(TGAMTYP) = TINS    !INSTANT TICKETS = 14 --- GAME TYPE
        TRABUF(TGAMIND) = 1       !GAME INDEX 1
C        TRABUF(TGAM)=GTNTAB(TINS,TRABUF(TGAMIND))
CCCCCCCCCCCCCCCCCCCCCCCCCCC
C        TRABUF(TTKID)   = 1       !TICKET ID
C        TRABUF(TFAMTFLG)  = 0 
C        TRABUF(TFRAC)   = 1         !# OF FRACTIONS (its LOTTO its not a fraction so alls 1?)
C        TRABUF(TSUBERR) = NOER
C       TRABUF(TCDC)    =9999
C        TRABUF(TCDC_SOLD)= 9990

        TRABUF(TIXRF) = 'FFFFFFFF'X
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC TRANSACTION BODY CCCCCCCCCCCCCCCCCCCCCCCCCCC        
        TRABUF(TITYP)   = IMNU      
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TIBCH)   = AUX_GAME_NUM     !NUMBER IN BATCH - being the max value of 40 supported by IPS and
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC  controlled at dimnu at "GET NUMBER OF ORDERS IN BATCH" returns a error message        
        TRABUF(TSORD)  = 'FFFFFFFF'X         !ORDER NUMBER - 'FFFFFFFF'X 
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TSINF)  = 'FFFFFFFF'X         !ORDER INFO
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        DO X = 0, AUX_GAME_NUM-1
            TRABUF(TSGAM+X) = (436+X)+4096   !GAME (REQUESTED)  4535-4096=439 -- 31+3=34  (31-70)  last nible is alls 1 for Game Type that is Instant Game thats 0x1000=4096 constant
            TRABUF(TSQTY+X) = 1              !SUPPLY QUANTITY (REQUESTED) 71+3=74  (71-110)
        ENDDO
C        TRABUF(TSSTK1) = 0                              !OUT OF STOCK BITMAP (1 TO 32)  (112)
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TGOLMCOMF_IL) = 1
        TRABUF(TGOLMSERL_IL) = '630FFFFF'X!1661992959
        TRABUF(TGOLMSERM_IL) = '6BC75E2D'X!1808227885       
        TRABUF(TGOLMSERH_IL) = '5'X
        TRABUF(TGOLMMIDL_IL) = 'FFFFFFFF'X
        TRABUF(TGOLMMIDH_IL) = '7F'X    

CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        IF(TRABUF(TGOLMCOMF_IL) .EQ. 1) THEN
           IF(TRABUF(TIBCH).GT.3 .AND. TRABUF(TIBCH).LE.24) THEN  
              TRABUF(TSIZE) = 2
           ELSE IF (TRABUF(TIBCH).GT.24) THEN 
              TRABUF(TSIZE) = 3
           ENDIF
        ELSE
           IF(TRABUF(TIBCH).GE.9.AND.TRABUF(TIBCH).LE.28) THEN
              TRABUF(TSIZE) = 2
           ELSE IF (TRABUF(TIBCH).GE.29) THEN
              TRABUF(TSIZE) = 3
           ENDIF
        ENDIF    

        TYPE *,'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX'
        TYPE *,'GAMES BLOCK:',AUX_MAX_GAMES(AUX_INDEX)
        TYPE *,'Games in batch:',AUX_GAME_NUM
C        TYPE *,'TRABUF(TSIZE):',TRABUF(TSIZE)

        CALL TRALOG(TRABUF,BUF) 
        
        I4TEMP = BUF(10)
C        TYPE *,'10 -- I1TEMP(1):',I1TEMP(1)
C        TYPE *,'10 -- I1TEMP(2):',I1TEMP(2)
C        TYPE *,'10 -- I1TEMP(3):',I1TEMP(3)
C        TYPE *,'10 -- I1TEMP(4):',I1TEMP(4)
C
C        I4TEMP = BUF(11)
C        TYPE *,'11 -- I1TEMP(1):',I1TEMP(1)
C        TYPE *,'11 -- I1TEMP(2):',I1TEMP(2)
C        TYPE *,'11 -- I1TEMP(3):',I1TEMP(3)
C        TYPE *,'11 -- I1TEMP(4):',I1TEMP(4)
C
C        BUFF(1) = I1TEMP(3)
C        BUFF(2) = I1TEMP(4)
C        I4TEMP = BUF(12)
C        TYPE *,'12 -- I1TEMP(1):',I1TEMP(1)
C        TYPE *,'12 -- I1TEMP(2):',I1TEMP(2)
C        TYPE *,'12 -- I1TEMP(3):',I1TEMP(3)
C        TYPE *,'12 -- I1TEMP(4):',I1TEMP(4)

        BUFF(3) = I1TEMP(1)
        I1TEMP(1) = BUFF(1)
        I1TEMP(2) = BUFF(2)
        I1TEMP(3) = BUFF(3)
        I1TEMP(4) = 0

C        GTYP_AUX = ISHFT(I4TEMP,-20) !should alls be 1
C        TYPE *,'GTYP (1)?:',GTYP_AUX
C        GNUM = IAND(I4TEMP,'000FFFFF'X) 
C        TSQTY_AUX = MOD(GNUM,1000)
C        GNUM = (GNUM - GTYP_AUX)/1000
C        TSGAM_AUX = ISHFT(GTYP_AUX,12) + IAND(GNUM,'0FFF'X)
C        TYPE *,'GNUM (438)?:',GNUM
C        TYPE *,'TSQTY (1)?:',TSQTY_AUX

        CALL LOGTRA(TBUF,BUF)

C        DO X = 0, AUX_GAME_NUM-1
C          TYPE *,'Game Number:',IAND(TBUF(TSGAM+X),'0FFF'X)
C          TYPE *,'Quantity Reserved:',TBUF(TSQTY+X)
C        ENDDO        

CCCCC
CCCCC
CCCCCCCCC
CC
CC
        DO I=1,TRALEN
           IF(TRABUF(I).NE.TBUF(I)) THEN
C                IF(I.NE.25) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
                IF(I.NE.25 .AND. 
     *          I.NE.TTKID .AND.
     *          I.NE.TFAMTFLG .AND.     
     *          I.NE.TFRAC .AND.
     *          I.NE.TSUBERR .AND.
     *          I.NE.TCDC .AND.     
     *          I.NE.TCDC_SOLD) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
           ENDIF
        ENDDO 
        AUX_GAME_NUM = AUX_GAME_NUM + 1 
        IF (AUX_GAME_NUM .GT. AUX_MAX_GAMES(AUX_INDEX)) THEN
            AUX_INDEX = AUX_INDEX + 1
            AUX_GAME_NUM = 1
        ENDIF
        IF (AUX_INDEX .LE. 3 .AND. AUX_GAME_NUM .LE. AUX_MAX_GAMES(AUX_INDEX)) GOTO 7010  !3 !24 !40 ciclys     
        TYPE*,'END TESTING LI IMNU NEW TRANSACTION FIELDS - MessageId,Serial Olimpo,Channel Flag'                           
!===============================================================================        
C v24 END
C INSTANT LOTTERY TRANSACTIONS NEW FIELDS MESSAGEID, SERIAL OLIMPO, CHANNEL FLAG
!++++++++++++++++++++++LI/IL IMNU+++++++++++++++++++++++++++++++++++++++++++++++   
!===============================================================================  
!===============================================================================        
C v24 BEGIN
C INSTANT LOTTERY TRANSACTIONS NEW FIELDS MESSAGEID, SERIAL OLIMPO, CHANNEL FLAG
!++++++++++++++++++++++LI/IL ICNF+++++++++++++++++++++++++++++++++++++++++++++++   
!===============================================================================     
        TYPE*,'==============================================='
        TYPE*,'BEGIN TESTING LI ICNF NEW TRANSACTION FIELDS - MessageId,Serial Olimpo,Channel Flag'
        CALL FASTSET(0,TRABUF,TRALEN)
        CALL FASTSET(0,TBUF,TRALEN)    
CCCCCCCCCCCC TRANSACTION HEADER CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC        
C        TRABUF(TSER)    =64123499
        TRABUF(TCDC)    =9999
        TRABUF(TTER)    =6000
        TRABUF(TAGT)    ='000493E6'X!AGENT NUMBER 0300006
        TRABUF(TNFRAC)  =0
        TRABUF(TTIM)    ='00112233'X
        TRABUF(TTSTCS)  = 'FE'X      !TERMINAL STATISTICS (max possible flags 1111 1110 the last is 0 because x01 is not used so alls 0)
        TRABUF(TCHK)    = '7F'X      !MESSAGE CHECKSUM (generated from the size of the message with the CDC and another field)
        TRABUF(TERR)    = NOER      
        TRABUF(TSTAT)   = GOOD
        TRABUF(TTYP)    = TCRS
CCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TFIL)    = 0           !FILE STATUS
        TRABUF(TINTRA)  = 1        !INTERNAL TRANSACTION FLAG
        TRABUF(TSIZE)   = 1         !Number of Segments used in register the transaction/message in tmf file
        TRABUF(TGAMTYP) = TINS    !INSTANT TICKETS = 14 --- GAME TYPE
        TRABUF(TGAMIND) = 1       !GAME INDEX 1
C        TRABUF(TGAM)=GTNTAB(TINS,TRABUF(TGAMIND))
CCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TTKID)   = 1       !TICKET ID
        TRABUF(TFAMTFLG)  = 0 
        TRABUF(TFRAC)   = 1         !# OF FRACTIONS (its LOTTO its not a fraction so alls 1?)
        TRABUF(TSUBERR) = NOER
C       TRABUF(TCDC)    =9999
        TRABUF(TCDC_SOLD)= 9990

        TRABUF(TIXRF) = 'FFFFFFFF'X
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC TRANSACTION BODY CCCCCCCCCCCCCCCCCCCCCCCCCCC        
        TRABUF(TITYP)   = ICNF      !INSTANT ORDER CONFIRMATION
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TIINV1)   = '7FFF'X         !INSTANT INVOICE 1
        TRABUF(TIINV2)   = '7FFF'X         !INSTANT INVOICE 2
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TIINV3)  = 'FFFFFFFF'X      !INSTANT INVOICE THREE
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TGOLMCOMF_IL) = 1
        TRABUF(TGOLMSERL_IL) = '630FFFFF'X!1661992959
        TRABUF(TGOLMSERM_IL) = '6BC75E2D'X!1808227885       
        TRABUF(TGOLMSERH_IL) = '5'X
        TRABUF(TGOLMMIDL_IL) = 'FFFFFFFF'X
        TRABUF(TGOLMMIDH_IL) = '7F'X        
        CALL TRALOG(TRABUF,BUF)      
        CALL LOGTRA(TBUF,BUF)
        DO I=1,TRALEN
           IF(TRABUF(I).NE.TBUF(I)) THEN
C                IF(I.NE.25) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
                IF(I.NE.25 .AND. 
     *          I.NE.TTKID .AND.
     *          I.NE.TFAMTFLG .AND.     
     *          I.NE.TFRAC .AND.
     *          I.NE.TSUBERR .AND.
     *          I.NE.TCDC .AND.     
     *          I.NE.TCDC_SOLD) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
           ENDIF
        ENDDO         
        TYPE*,'END TESTING LI ICNF NEW TRANSACTION FIELDS - MessageId,Serial Olimpo,Channel Flag'                           
!===============================================================================        
C v24 END
C INSTANT LOTTERY TRANSACTIONS NEW FIELDS MESSAGEID, SERIAL OLIMPO, CHANNEL FLAG
!++++++++++++++++++++++LI/IL ICNF+++++++++++++++++++++++++++++++++++++++++++++++   
!=============================================================================== 
!===============================================================================        
C v24 BEGIN
C INSTANT LOTTERY TRANSACTIONS NEW FIELDS MESSAGEID, SERIAL OLIMPO, CHANNEL FLAG
!++++++++++++++++++++++LI/IL IOACT+++++++++++++++++++++++++++++++++++++++++++++++   
!===============================================================================     
        TYPE*,'==============================================='
        TYPE*,'BEGIN TESTING LI IOACT NEW TRANSACTION FIELDS - MessageId,Serial Olimpo,Channel Flag'
        CALL FASTSET(0,TRABUF,TRALEN)
        CALL FASTSET(0,TBUF,TRALEN)    
CCCCCCCCCCCC TRANSACTION HEADER CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC        
C        TRABUF(TSER)    =64123499
        TRABUF(TCDC)    =9999
        TRABUF(TTER)    =6000
        TRABUF(TAGT)    ='000493E6'X!AGENT NUMBER 0300006
        TRABUF(TNFRAC)  =0
        TRABUF(TTIM)    ='00112233'X
        TRABUF(TTSTCS)  = 'FE'X      !TERMINAL STATISTICS (max possible flags 1111 1110 the last is 0 because x01 is not used so alls 0)
        TRABUF(TCHK)    = '7F'X      !MESSAGE CHECKSUM (generated from the size of the message with the CDC and another field)
        TRABUF(TERR)    = NOER      
        TRABUF(TSTAT)   = GOOD
        TRABUF(TTYP)    = TCRS
CCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TFIL)    = 0           !FILE STATUS
        TRABUF(TINTRA)  = 1        !INTERNAL TRANSACTION FLAG
        TRABUF(TSIZE)   = 1         !Number of Segments used in register the transaction/message in tmf file
        TRABUF(TGAMTYP) = TINS    !INSTANT TICKETS = 14 --- GAME TYPE
        TRABUF(TGAMIND) = 1       !GAME INDEX 1
C        TRABUF(TGAM)=GTNTAB(TINS,TRABUF(TGAMIND))
CCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TTKID)   = 1       !TICKET ID
        TRABUF(TFAMTFLG)  = 0 
        TRABUF(TFRAC)   = 1         !# OF FRACTIONS (its LOTTO its not a fraction so alls 1?)
        TRABUF(TSUBERR) = NOER
C       TRABUF(TCDC)    =9999
        TRABUF(TCDC_SOLD)= 9990

        TRABUF(TIXRF) = 'FFFFFFFF'X
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC TRANSACTION BODY CCCCCCCCCCCCCCCCCCCCCCCCCCC        
        TRABUF(TITYP)   = IOACT      !INSTANT ORDER CONFIRMATION
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TIINV1)   = '7FFF'X         !INSTANT INVOICE 1
        TRABUF(TIINV2)   = '7FFF'X         !INSTANT INVOICE 2
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TIINV3)  = 'FFFFFFFF'X      !INSTANT INVOICE THREE
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        TRABUF(TGOLMCOMF_IL) = 1
        TRABUF(TGOLMSERL_IL) = '630FFFFF'X!1661992959
        TRABUF(TGOLMSERM_IL) = '6BC75E2D'X!1808227885       
        TRABUF(TGOLMSERH_IL) = '5'X
        TRABUF(TGOLMMIDL_IL) = 'FFFFFFFF'X
        TRABUF(TGOLMMIDH_IL) = '7F'X        
        CALL TRALOG(TRABUF,BUF)      
        CALL LOGTRA(TBUF,BUF)
        DO I=1,TRALEN
           IF(TRABUF(I).NE.TBUF(I)) THEN
C                IF(I.NE.25) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
                IF(I.NE.25 .AND. 
     *          I.NE.TTKID .AND.
     *          I.NE.TFAMTFLG .AND.     
     *          I.NE.TFRAC .AND.
     *          I.NE.TSUBERR .AND.
     *          I.NE.TCDC .AND.     
     *          I.NE.TCDC_SOLD) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
           ENDIF
        ENDDO         
        TYPE*,'END TESTING LI IOACT NEW TRANSACTION FIELDS - MessageId,Serial Olimpo,Channel Flag'                           
!===============================================================================        
C v24 END
C INSTANT LOTTERY TRANSACTIONS NEW FIELDS MESSAGEID, SERIAL OLIMPO, CHANNEL FLAG
!++++++++++++++++++++++LI/IL IOACT+++++++++++++++++++++++++++++++++++++++++++++++   
!===============================================================================         
!===============================================================================  
C
C EM TRANSACTIONS
C
!+++++++WAGER+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
        TYPE*,'==============================================='
        TYPE*,'TESTING EM WAGER......'
        CALL FASTSET(0,TRABUF,TRALEN)
        CALL FASTSET(0,TBUF,TRALEN)
C-------INMGR-------------------------------------------------------------------
        TRABUF(TTYP)      = TEUR
        TRABUF(TSTAT)     = VOID
        TRABUF(TERR)      = REJT
        TRABUF(TCDC)      = 9999
        TRABUF(TCDC_SOLD) = 9909
        TRABUF(TTER)      = 69
        TRABUF(TAGT)      = 6969
        TRABUF(TINTRA)    = 1
        TRABUF(TFIL)      = 0
        TRABUF(TGAMIND)   = 1
        TRABUF(TGAMTYP)   = TEUM
        TRABUF(TGAM)      = 0
        TRABUF(TTRN)      = 2
!        TRABUF(TSIZE)     = 2
        TRABUF(TSIZE)     = 3                                                   !V23
        TRABUF(TCHK)      = 69
        TRABUF(TTSTCS)    = 69
        TRABUF(TEUTYP)    = TWAG
        TRABUF(TEUWNBET)  = 1 
        TRABUF(TEUWDUR)   = 1
        TRABUF(TEUWQP)    = 1
        TRABUF(TEUWNMK)   = 6
        TRABUF(TEUWNST)   = 9
C
        TRABUF(TEUW_KIWFL)= 1                                                   !PARTICIPATING IN JOKER 1 FLAG                    !V23
        TRABUF(TEUW_PLNIF)= 999999999                                           !PORTUGUESE PLAYER NIV                            !V23
        TRABUF(TEUW_EUWCH)= 1                                                   !EM WAGERING CHANNEL                              !V23
        TRABUF(TEUWDRWIND)= 2                                                   !DRAW INDICATOR (0 - NEXT DRAW, 1-7 MONDAY-SUNDAY !V23
C
        TRABUF(TEUWBOARD) = 9999
C-------OUTMGR------------------------------------------------------------------
        TRABUF(TSER)      = 696969
        TRABUF(TTIM)      ='00112233'X                    
        TRABUF(TEUMESSQ)  = 62
        TRABUF(TEUSER)    = 63
        TRABUF(TEUCHK)    = 64
        TRABUF(TEUWOFS1)  = 65
        TRABUF(TEUWOFS2)  = 66
        TRABUF(TEUWBEGW)  = 67
        TRABUF(TEUWBEGY)  = 68
        TRABUF(TEUWENDW)  = 69
        TRABUF(TEUWENDY)  = 70
        TRABUF(TEUWTIMEH) = 71
        TRABUF(TEUWTIMEM) = 72
        TRABUF(TEUWTIMES) = 73
C
        TRABUF(TEUW_SMWFL)= 1                                                   !SM DATA PRESENT FLAG                  !V23
        TRABUF(TEUW_SMWTB)= 5                                                   !SM TOTAL BETS                         !V23
        TRABUF(TEUW_SMWSN)= 1234567                                             !SM EXTERNAL SERIAL NUMBER             !V23
        TRABUF(TEUW_SMWCD)= 255                                                 !SM CHECK DIGITS                       !V23
        TRABUF(TEUW_SMWDN)= 45                                                  !SM DRAW NUMBER                        !V23
        TRABUF(TEUW_SMWDY)= 16                                                  !SM DRAW YEAR                          !V23
        TRABUF(TEUW_SMWOF)= 4                                                   !OFFSET TO SM DRAW CDC DATE            !V23
        TRABUF(TEUW_SMWB1)= '424344FF'X                                         !SM WAGER FIRST NUMBER (ALPHA PART)    !V23
        TRABUF(TEUW_SMWB2)= 1                                                   !SM WAGER FIRST NUMBER (NUMERIC PART)  !V23
        TRABUF(TEUW_SMWE1)= '454647FF'X                                         !SM WAGER LAST NUMBER (ALPHA PART)     !V23
        TRABUF(TEUW_SMWE2)= 99999                                               !SM WAGER LAST NUMBER (NUMERIC PART)   !V23
        TRABUF(TEUW_SHWFL)= 1                                                   !SoM WAGER DATA IS PRESENT             !V23
        TRABUF(TEUW_SHWDN)= 99                                                  !SoM DRAW NUMBER                       !V23
        TRABUF(TEUW_SHWDY)= 16                                                  !SoM DRAW YEAR                         !V23
        TRABUF(TEUW_SHWOF)= 5                                                   !OFFSET TO SoM DRAW CDC DATE           !V23
        TRABUF(TEUW_SHWTB)= 4                                                   !SoM TOTAL BETS                        !V23
        TRABUF(TEUW_SHWB1)= '484950FF'X                                         !SoM WAGER FIRST NUMBER (ALPHA PART)   !V23
        TRABUF(TEUW_SHWB2)= 12345                                               !SoM WAGER FIRST NUMBER (NUMERIC PART) !V23
        TRABUF(TEUW_SHWE1) = '515253FF'X                                        !SoM WAGER LAST NUMBER (ALPHA PART)    !V23
        TRABUF(TEUW_SHWE2) = 1                                                  !SoM WAGER LAST NUMBER (NUMERIC PART)  !V23
C-------------------------------------------------------------------------------
        CALL TRALOG(TRABUF,BUF)
        CALL LOGTRA(TBUF,BUF)
        DO I=1,TRALEN
           IF(TRABUF(I).NE.TBUF(I)) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
        ENDDO 
        TYPE*,'EM WAGER TRANSACTION DONE!'
        !TYPE*,'==============================================='
!+++++++CANCELLATION++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
        TYPE*,'==============================================='
        TYPE*,'TESTING EM CANCELLATION......'
        CALL FASTSET(0,TRABUF,TRALEN)
        CALL FASTSET(0,TBUF,TRALEN)
C-------INMGR-------------------------------------------------------------------
        TRABUF(TTYP)      = TEUR
        TRABUF(TSTAT)     = VOID
        TRABUF(TERR)      = REJT
        TRABUF(TCDC)      = 9999
        TRABUF(TCDC_SOLD) = 9909
        TRABUF(TTER)      = 69
        TRABUF(TAGT)      = 6969
        TRABUF(TFIL)      = 0
        TRABUF(TGAMIND)   = 1
        TRABUF(TGAMTYP)   = TEUM
        TRABUF(TGAM)      = 0
        TRABUF(TTRN)      = 2
!        TRABUF(TSIZE)     = 3                                                  !V23
        TRABUF(TSIZE)     = 2
        TRABUF(TINTRA)    = 1 
        TRABUF(TCHK)      = 69    
        TRABUF(TTSTCS)    = 69       
        TRABUF(TEUTYP)    = TCAN     
        TRABUF(TEUCWJUL)  = 128
        TRABUF(TEUCWSER)  = 696969
        TRABUF(TEUCWCKD)  = 128
C-------OUTMGR------------------------------------------------------------------
        TRABUF(TSER)      = 696969
        TRABUF(TTIM)      ='00112233'X                    
        TRABUF(TEUMESSQ)  = 62   
        TRABUF(TEUSER)    = 63
        TRABUF(TEUCHK)    = 64
        TRABUF(TEUCTIMEH) = 65
        TRABUF(TEUCTIMEM) = 66
        TRABUF(TEUCTIMES) = 67
        TRABUF(TEUCST)    = 68
        TRABUF(TEUCAM)    = 69
C
        TRABUF(TEUC_SMCFL) = 1                                                  !SM CANCELLATION DATA IS PRESENT         !V23
        TRABUF(TEUC_SMWSN) = 7654321                                            !SM WAGER EXTERNAL SERIAL NUMBER         !V23
        TRABUF(TEUC_SMWCD) = 128                                                !SM WAGER CHECK DIGITS                   !V23
        TRABUF(TEUC_SMCSN) = 1                                                  !SM CANCELLATION EXTERNAL SERIAL NUMBER  !V23
        TRABUF(TEUC_SMCCD) = 1                                                  !SM CANCELLATION CHECK DIGITS            !V23
        TRABUF(TEUC_SMWCA) = 1250                                               !SM CANCEL AMOUNT (WAGER UNITS)          !V23
        TRABUF(TEUC_SHCFL) = 1                                                  !SoM CANCELLATION FLAG                   !V23
C-------------------------------------------------------------------------------
        CALL TRALOG(TRABUF,BUF)
        CALL LOGTRA(TBUF,BUF)
        DO I=1,TRALEN
           IF(TRABUF(I).NE.TBUF(I)) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
        ENDDO 
        TYPE*,'EM CANCELLATION TRANSACTION DONE!'
        !TYPE*,'==============================================='            
!+++++++VALIDATION++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
        TYPE*,'==============================================='
        TYPE*,'TESTING EM VALIDATION......'
        CALL FASTSET(0,TRABUF,TRALEN)
        CALL FASTSET(0,TBUF,TRALEN)
C-------COMMON------------------------------------------------------------------
        TRABUF(TSTAT)     = VOID                            !# 01
        TRABUF(TERR)      = REJT                            !# 02
        TRABUF(TCDC)      = 9999                            !# 03
        TRABUF(TSER)      = 69696969                        !# 04
        TRABUF(TTIM)      ='00112233'X                      !# 05
        TRABUF(TTER)      = 69                              !# 06
        TRABUF(TAGT)      = 6969                            !# 07
        TRABUF(TTRN)      = 2                               !# 08
        TRABUF(TTYP)      = TEUR                            !# 09
        TRABUF(TGAM)      = 0                               !# 10
        TRABUF(TGAMTYP)   = TEUM                            !# 11
        TRABUF(TGAMIND)   = 1                               !# 12
        TRABUF(TTSTCS)    = 69                              !# 13
        TRABUF(TINTRA)    = 1                               !# 14
        TRABUF(TFIL)      = 1                               !# 15
        TRABUF(TTKID)     = 1                               !# 16
        TRABUF(TCHK)      = 69                              !# 17
        TRABUF(TFRAC)     = 1                               !# 18
!        TRABUF(TSIZE)     = 3                               !# 19
        TRABUF(TSIZE)     = 2                               !# 19               !V23
        TRABUF(TSUBERR)   = 1                               !# 20
        TRABUF(TCDC_SOLD) = 9999                            !# 21
        TRABUF(TFAMTFLG)  = 1                               !# 22
        TRABUF(TNFRAC)    = 1                               !# 23
C-------SPECIFIC----------------------------------------------------------------
        TRABUF(TEUTYP)    = TVAL                            !# 25
        TRABUF(TEUSER)    = 69696969                        !# 26
        TRABUF(TEUCHK)    = 128                             !# 27
        TRABUF(TEUMESSQ)  = 1                               !# 28
        TRABUF(TEUVSBT)   = 2                               !# 29
        TRABUF(TEUVWJUL)  = 128                             !# 30
        TRABUF(TEUVWSER)  = 69696969                        !# 31     
        TRABUF(TEUVWCKD)  = 128                             !# 32
        TRABUF(TEUVTIMEH) = 65                              !# 33
        TRABUF(TEUVTIMEM) = 66                              !# 34
        TRABUF(TEUVTIMES) = 67                              !# 35
        TRABUF(TEUVST)    = 68                              !# 36
        TRABUF(TEUVCAM)   = '10000000'X                     !# 37
        TRABUF(TEUVRAM)   = '10000000'X                     !# 38
        TRABUF(TEUVCAMH)  = 1                               !# 57
        TRABUF(TEUVRAMH)  = 1                               !# 58
C
        TRABUF(TEUVPLIDTYP)= 1                                                  !PLAYER ID TYPE                              !V23
        TRABUF(TEUVPLCARD) = 123456789                                          !PLAYER ID                                   !V23
        TRABUF(TEUVNIBBB)  = 9999                                               !PLAYER NIB BRANCH (4 DIGITS)                !V23
        TRABUF(TEUVNIBBO)  = 1234                                               !PLAYER NIB OFFICE (4 DIGITS)                !V23
        TRABUF(TEUVNIBBA1) = 123456789                                          !PLAYER NIB ACCOUNT NUMBER PART 1 (9 DIGITS) !V23
        TRABUF(TEUVNIBBA2) = 99                                                 !PLAYER NIB ACCOUNT NUMBER PART 2 (2 DIGITS) !V23
        TRABUF(TEUVNIBCD)  = 99                                                 !PLAYER NIB CHECK DIGITS (2 DIGITS)          !V23
C
        TRABUF(TEUV_NIFFL) = 1                                                  !PLAYER NIF IS PRESENT               !V23
        TRABUF(TEUV_PLNIF) = 123456789                                          !PLAYER NIF                          !V23
        TRABUF(TEUV_NIFCF) = 1                                                  !PLAYER NIF CONFIRMATION IS REQUIRED !V23
        TRABUF(TEUV_SHVFL) = 1                                                  !SoM WAS VALIDATED ALONG EM          !V23
C-------------------------------------------------------------------------------
        CALL TRALOG(TRABUF,BUF)
        CALL LOGTRA(TBUF,BUF)
        DO I=1,TRALEN
           IF(TRABUF(I).NE.TBUF(I)) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
        ENDDO 
        TYPE*,'EM VALIDATION TRANSACTION DONE!'
        !TYPE*,'==============================================='        
!===============================================================================                
C
C TEST PSDN CONVERSION - TRANSPORT LAYER.
C
        TYPE*,'==============================================='
        CALL FASTSET(0,TRABUF,TRALEN)
        CALL FASTSET(0,TBUF,TRALEN)
        DO I=1,TXTBTYP
           TRABUF(I)=I
        ENDDO
        DO I=1,NOTUSD_CNT
           TRABUF(NOTUSD(I))=0
        ENDDO
        TRABUF(TTKID) = 0
        TRABUF(TTYP)=TSPE
        TRABUF(TGAMTYP)=TLTO
        TRABUF(TTIM)='00112233'X
        TRABUF(TAGT)='00AABBCC'X
        TRABUF(TINTRA)=1
        TRABUF(TFIL)=4
        TRABUF(TSIZE)=1
        TRABUF(TSFUN)=TSX2X
        TRABUF(TXLAY)=X2X_TRATYP_XPORT
        CALL TRALOG(TRABUF,BUF)
        CALL LOGTRA(TBUF,BUF)
        TYPE*,'TESTING SPESRV PSDN - TRANSPORT LAYER'
        DO I=1,TRALEN
           IF(TRABUF(I).NE.TBUF(I)) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
        ENDDO
C
C TEST SPESRV - FRONT END LAYER - COMMAND
C
        CALL FASTSET(0,TRABUF,TRALEN)
        CALL FASTSET(0,TBUF,TRALEN)
        DO I=1,TXFCC
           TRABUF(I)=I
        ENDDO
        DO I=1,NOTUSD_CNT
           TRABUF(NOTUSD(I))=0
        ENDDO
        TRABUF(TTKID) = 0
        TRABUF(TTYP)=TSPE
        TRABUF(TGAMTYP)=TLTO
        TRABUF(TTIM)='00112233'X
        TRABUF(TAGT)='00AABBCC'X
        TRABUF(TINTRA)=1
        TRABUF(TFIL)=4
        TRABUF(TSIZE)=1
        TRABUF(TSFUN)=TSX2X
        TRABUF(TXLAY)=X2X_TRATYP_FE
        TRABUF(TXFMDUT)=X2FEMES_MESTYP_CMD
        CALL TRALOG(TRABUF,BUF)
        CALL LOGTRA(TBUF,BUF)
        TYPE*,'TESTING SPESRV PSDN - FE COMMAND'
        DO I=1,TRALEN
           IF(TRABUF(I).NE.TBUF(I)) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
        ENDDO
C
C TEST SPESRV - FRONT END LAYER - ERROR
C
        CALL FASTSET(0,TRABUF,TRALEN)
        CALL FASTSET(0,TBUF,TRALEN)
        DO I=1,TXFDEC
          TRABUF(I)=I
        ENDDO
        DO I=1,NOTUSD_CNT
           TRABUF(NOTUSD(I))=0
        ENDDO
        TRABUF(TTKID) = 0
        TRABUF(TTYP)=TSPE
        TRABUF(TGAMTYP)=TLTO
        TRABUF(TTIM)='00112233'X
        TRABUF(TAGT)='00AABBCC'X
        TRABUF(TINTRA)=1
        TRABUF(TFIL)=4
        TRABUF(TSIZE)=1
        TRABUF(TSFUN)=TSX2X
        TRABUF(TXLAY)=X2X_TRATYP_FE
        TRABUF(TXFMDUT)=X2FEMES_MESTYP_ERR
        CALL TRALOG(TRABUF,BUF)
        CALL LOGTRA(TBUF,BUF)
        TYPE*,'TESTING SPESRV PSDN - FE ERROR'
        DO I=1,TRALEN
           IF(TRABUF(I).NE.TBUF(I)) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
        ENDDO
C
C TEST SPESRV - FRONT END LAYER - ALARM
C
        CALL FASTSET(0,TRABUF,TRALEN)
        CALL FASTSET(0,TBUF,TRALEN)
        DO I=1,TXFLMC
           TRABUF(I)=I
        ENDDO
        DO I=1,NOTUSD_CNT
           TRABUF(NOTUSD(I))=0
        ENDDO
        TRABUF(TTKID) = 0
        TRABUF(TTYP)=TSPE
        TRABUF(TGAMTYP)=TLTO
        TRABUF(TTIM)='00112233'X
        TRABUF(TAGT)='00AABBCC'X
        TRABUF(TINTRA)=1
        TRABUF(TFIL)=4
        TRABUF(TSIZE)=1
        TRABUF(TSFUN)=TSX2X
        TRABUF(TXLAY)=X2X_TRATYP_FE
        TRABUF(TXFMDUT)=X2FEMES_MESTYP_ALARM
        CALL TRALOG(TRABUF,BUF)
        CALL LOGTRA(TBUF,BUF)
        TYPE*,'TESTING SPESRV PSDN - FE ALARM'
        DO I=1,TRALEN
           IF(TRABUF(I).NE.TBUF(I)) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
        ENDDO
C
C TEST SPESRV - STATION LAYER - HELP
C
        CALL FASTSET(0,TRABUF,TRALEN)
        CALL FASTSET(0,TBUF,TRALEN)
        DO I=1,TXSSPHID
           TRABUF(I)=I
        ENDDO
        DO I=1,NOTUSD_CNT
           TRABUF(NOTUSD(I))=0
        ENDDO
        TRABUF(TTKID) = 0
        TRABUF(TTYP)=TSPE
        TRABUF(TGAMTYP)=TLTO
        TRABUF(TTIM)='00112233'X
        TRABUF(TAGT)='00AABBCC'X
        TRABUF(TINTRA)=1
        TRABUF(TFIL)=4
        TRABUF(TSIZE)=1
        TRABUF(TSFUN)=TSX2X
        TRABUF(TXLAY)=X2X_TRATYP_STTN
        TRABUF(TXSSDTU)=X2STMES_DATATYPE_CMD_UP
        CALL TRALOG(TRABUF,BUF)
        CALL LOGTRA(TBUF,BUF)
        TYPE*,'TESTING SPESRV PSDN - STATION HELP'
        DO I=1,TRALEN
           IF(TRABUF(I).NE.TBUF(I)) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
        ENDDO
C
C TEST SPESRV - STATION LAYER - COMMAND
C
        CALL FASTSET(0,TRABUF,TRALEN)
        CALL FASTSET(0,TBUF,TRALEN)
        DO I=1,TXSSNUM
           TRABUF(I)=I
        ENDDO
        DO I=1,NOTUSD_CNT
           TRABUF(NOTUSD(I))=0
        ENDDO
        TRABUF(TTKID) = 0
        TRABUF(TTYP)=TSPE
        TRABUF(TGAMTYP)=TLTO
        TRABUF(TTIM)='00112233'X
        TRABUF(TAGT)='00AABBCC'X
        TRABUF(TINTRA)=1
        TRABUF(TFIL)=4
        TRABUF(TSIZE)=1
        TRABUF(TSFUN)=TSX2X
        TRABUF(TXLAY)=X2X_TRATYP_STTN
        TRABUF(TXSSDTU)=X2STMES_DATATYPE_RESET
        CALL TRALOG(TRABUF,BUF)
        CALL LOGTRA(TBUF,BUF)
        TYPE*,'TESTING SPESRV PSDN - STATION COMMAND'
        DO I=1,TRALEN
           IF(TRABUF(I).NE.TBUF(I)) TYPE*,'IND ',I,TRABUF(I),TBUF(I)
        ENDDO
C
        TYPE*,'==============================================='
        CALL GSTOP(GEXIT_SUCCESS)
        END

C ******************************************************************************
C
C     SUBROUTINE: SET_CANCELATION_EVENTS_BITMAP
C     AUTHOR    : J.H.R
C     VERSION   : 01            DATE: 03 / 04 / 2017
C
C ******************************************************************************
C
C FUNCTION TO GE THE TOTAL NUMBER OF CANCELLED EVENTS FROM COMMON MEMORY
C
C==== OPTIONS /CHECK=NOOVERFLOW
      SUBROUTINE SET_CANCELATION_EVENTS_BITMAP(TRABUF)
      IMPLICIT NONE
C
      INCLUDE 'INCLIB:GLOBAL.DEF'
      INCLUDE 'INCLIB:DESTRA.DEF'
      INCLUDE 'INCLIB:SPTCOM.DEF'
C
      INTEGER * 4 ROW_IDX       ! ROW INDEX COUNTER
C
      IF(TRABUF(TSTAT)   .NE. GOOD) RETURN
      IF(TRABUF(TERR)    .NE. NOER) RETURN
      IF(TRABUF(TGAMTYP) .NE. TSPT) RETURN   ! ONLY SPORTS GAME TYPE
C
      IF(MIN(SPTMAX(TRABUF(TGAMIND)), SPGNBR) .GE. 33) THEN
        CALL OPSTXT('WRONG DRAW SETUP TO TO UPDATE EVENT CANCELTAION BITMAP !!!')
        RETURN
      ENDIF
C
      TRABUF(TWCEBM) = 0
C
      DO ROW_IDX = 1, MIN(SPTMAX(TRABUF(TGAMIND)), SPGNBR)
        IF(SPTECD(ROW_IDX, TRABUF(TGAMIND)) .NE. 0) CALL BSET(TRABUF(TWCEBM), 32 - ROW_IDX)
      ENDDO
C
      END
