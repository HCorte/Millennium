C
C     FILE   : PAS_PRG_DAY.FOR
C     AUTHOR : J.H.R
C     VERSION: 01            DATE: 03 / 12 / 2001
C
C
C V01 JHR INITIAL RELEASE FOR PORTUGAL PROJECT
C
C PASSIVE GET PURGE DAY ( GETS DAY CDC TO PURGE PASSIVE EMISSION )
C
C     **************************************************************************
C
C        THIS ITEM IS THE PROPERTY OF GTECH CORPORATION, POVIDENCE, RHODE
C     ISLAND, AND CONTAINS CONFIDENTIAL AND TRADE SECRET INFORMATION. IT MAY
C     NOT BE TRANSFERRED FROM THE CUSTODY OR CONTROL OF GTECH EXCEPT AS AUTO -
C     RIZED IN WRITING BY AN OFFICER OF GTECH. NEITHER THIS ITEM NOR THE
C     INFORMATION IT CONTAINS MAY BE USED, TRANSFERRED, REPRODUCED, PUBLISHED
C     OR DISCLOSED, IN WHOLE OR IN PART, AND DIRECTLY OR INDIRECTLY, EXCEPT AS
C     EXPRESSLY AUTHORIZED BY AN OFFICER OR GTECH, PURSUANT TO WRITTEN AGREEMENT
C
C     Copyright 2000 GTECH Corporation. All Rigth Reserved
C
C     **************************************************************************
C
C THIS PROCEDURE GETS DAY CDC WHEN PASSIVE EMISSION SHOULD BE PURGED
C
C=======OPTIONS /CHECK = NOOVERFLOW /EXT
      SUBROUTINE GET_PAS_PRG_DAY(PRG_DAY, PAS_ESD, PAS_MAX_DAYS, GNUM)
      IMPLICIT NONE
C
C INCLUDES DEFINITION TO GET DAY CDC WHEN PASSIVE EMISSION SHOULD BE PURGED
C
      INCLUDE 'INCLIB:SYSPARAM.DEF'
      INCLUDE 'INCLIB:SYSEXTRN.DEF'
      INCLUDE 'INCLIB:GLOBAL.DEF'
      INCLUDE 'INCLIB:CONCOM.DEF'
C
C PARAMETERS DEFINITION TO GET DAY CDC WHEN PASSIVE EMISSION SHOULD BE PURGED
C
      INTEGER * 4 PRG_DAY           ! PURGE DAY CDC
      INTEGER * 4 PAS_ESD           ! END SALES DATE CDC ( WINNER SELECTION )
      INTEGER * 4 PAS_MAX_DAYS      ! MAXIMUM NUMBER OF DAY TO PAY BY THE AGENT
      INTEGER * 4 GNUM              ! GAME NUMBER
C
C VARIABLES DEFINITION TO GET DAY CDC WHEN PASSIVE EMISSION SHOULD BE PURGED
C
      INTEGER * 4 LST_PRG_AGT_CDC   ! LAST CDC TO PURGED BY AN ANGENT
      INTEGER * 4 FSTS              ! FUNCTION STATUS
C
C SET DAY CDC TO PURGE PASSIVE GAME
C
      PRG_DAY = DAYCDC + PRGDAY(GNUM)
      LST_PRG_AGT_CDC = PAS_ESD + PAS_MAX_DAYS
C
C CHECK IF WINNER SELECTION + NUMBER OF DAYS TO PAY BY THE AGENT IS GREATER
C THAN PURGE CDC DATE ( IF NOT RETURN, NO MORE TO DO )
C
      IF(PRG_DAY .GE. LST_PRG_AGT_CDC) RETURN
C
C SHOW MESSAGE ERROR TO USER ( IF WE ARE HERE IT'S A WARNING )
C
      CALL OPS('WARNING ...', FSTS, 0)
      CALL OPS('           ', FSTS, 0)
      CALL OPS('NUMBER OF DAYS TO PURGED CONFIGURED IN BLDSYS IS', FSTS, 0)
      CALL OPS('LESS THAN NUMBER OF DAYS TO PAY BY AN AGENT, SO ', FSTS, 0)
      CALL OPS('THAT THIS PURGE CDC IS REASIGNED TO DRAW DAY    ', FSTS, 0)
      CALL OPS('PLUS NUMBER OF DAY TO PAY BY AN AGENT !!!!      ', FSTS, 0)
      CALL OPS('           ', FSTS, 0)
C
C SET NEW PURGE DAY
C
      PRG_DAY = LST_PRG_AGT_CDC
C
C THIS IS THE END TO GET DAY CDC WHEN PASSIVE EMISSION SHOULD BE PURGED
C
      END
