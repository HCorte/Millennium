C
C SUBROUTINE OFFODDS
C $Log:   GXAFXT:[GOLS]OFFODDS.FOV  $
C  
C     Rev 1.0   17 Apr 1996 14:16:54   HXK
C  Release of Finland for X.25, Telephone Betting, Instant Pass Thru Phase 1
C  
C     Rev 1.0   21 Jan 1993 17:11:34   DAB
C  Initial Release
C  Based on Netherlands Bible, 12/92, and Comm 1/93 update
C  DEC Baseline
C
C ** Source - offodds.for **
C
C OFFODDS.FOR
C
C V01 01-AUG-90 XXX RELEASED FOR VAX
C
C
C COPYRITF.DEF+++++++++++++++++++++++++++++++++++++++++++++++++++++++
C
C COPYRIGHT 1991 GTECH CORPORATION.  ALL RIGHTS RESERVED.
C
C CONFIDENTIAL PROPRIETARY INFORMATION
C This item is the property of GTECH Corporation, W. Greenwich, Rhode
C Island, and contains confidential and trade secret information.  It
C may not be transferred from the custody or control of GTECH except
C as authorized in writing by an officer of GTECH.  Neither this item
C nor the information it contains may be used, transferred,
C reproduced, published or disclosed, in whold or in part, directly
C or indirectly, except as expressly authorized by an officer of
C GTECH pursuant to written agreement.
C COPYRITF.DEF-------------------------------------------------------
C
C=======OPTIONS /CHECK=NOOVERFLOW
	SUBROUTINE OFFODDS(OFFSETX,NO_OF_ROWSX,ROW_NRS,TAB_1X2)
	IMPLICIT NONE
C
	INCLUDE 'INCLIB:SYSPARAM.DEF'
	INCLUDE 'INCLIB:SYSEXTRN.DEF'
C
	INTEGER*4 MAX_I4,MAX_ODDS6,MAX_RAWS
	PARAMETER (MAX_RAWS = 6)
	PARAMETER (MAX_I4='7FFFFFFF'X)
	PARAMETER (MAX_ODDS6=MAX_I4/731)
C
	INTEGER*4 ROW_NRS(MAX_RAWS)
	INTEGER*4 NO_OF_ROWS,NO_OF_ROWSX
	INTEGER*4 TAB_1X2(MAX_RAWS)
	INTEGER*4 OFFSET,OFFSETX
	INTEGER*4 OFFSET_ODDS1,OFFSET_ODDS2
	INTEGER*4 POWER3(0:6) /1,3,9,27,81,243,729/  !FOR SPEED POWERS OF 3
	INTEGER*4 MAX_OFFSET_ODDS2
C
C CLEAR VARIABLES
C
	OFFSET=OFFSETX
	NO_OF_ROWS=NO_OF_ROWSX
	CALL FASTSET(0,ROW_NRS,MAX_RAWS)
	CALL FASTSET(0,TAB_1X2,MAX_RAWS)
C
	IF (NO_OF_ROWS.GT.MAX_RAWS.OR.NO_OF_ROWS.LT.1) RETURN
C
	IF (OFFSET.LT.0) THEN
	   OFFSET=-OFFSET
	   CALL OFFSPT(TAB_1X2,NO_OF_ROWS,OFFSET)
	   OFFSET=-OFFSET
	ELSE
	   CALL OFFSPT(TAB_1X2,NO_OF_ROWS,OFFSET)
	ENDIF
	CALL SPTOFF1(TAB_1X2,NO_OF_ROWS,OFFSET_ODDS2)
C
C CALCULATE SINGLE OFFSET NOW
C WE CAN FIT 5 RAW GAMES IN I4
C
	MAX_OFFSET_ODDS2 = POWER3(NO_OF_ROWS)
C
C 6 RAWS EXCEED RANGE OF POSITIVE NUMBERS
C WE SHOULD CHECK IF WE EXCEED THE RANGE, AND GO INTO NEGATIVE
C RANGE
C
	IF(NO_OF_ROWS .LE. 5) THEN
	  OFFSET_ODDS1 = ((OFFSET-OFFSET_ODDS2)/MAX_OFFSET_ODDS2)+1
	ELSE
	  IF(OFFSET.GT.0) THEN
	    OFFSET_ODDS1 = ((OFFSET-OFFSET_ODDS2)/MAX_OFFSET_ODDS2)+1
	  ELSE
	    OFFSET=-OFFSET
	    OFFSET_ODDS1=((OFFSET-OFFSET_ODDS2)/MAX_OFFSET_ODDS2)+1
	    OFFSET_ODDS1=OFFSET_ODDS1+MAX_ODDS6
	  ENDIF
	ENDIF
C
	CALL OFFCMB(ROW_NRS,OFFSET_ODDS1,NO_OF_ROWS)
	RETURN
	END
