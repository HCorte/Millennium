C
C SUBROUTINE IOQINIT
C $Log:   GXAFXT:[GOLS]IOQINIT.FOV  $
C  
C     Rev 1.0   17 Apr 1996 13:40:16   HXK
C  Release of Finland for X.25, Telephone Betting, Instant Pass Thru Phase 1
C  
C     Rev 1.0   21 Jan 1993 16:41:50   DAB
C  Initial Release
C  Based on Netherlands Bible, 12/92, and Comm 1/93 update
C  DEC Baseline
C
C ** Source - nrm_diskqio.for **
C
C
C
C
C
C **** IOQINIT
C
C=======OPTIONS /CHECK=NOOVERFLOW
	SUBROUTINE IOQINIT(FDB, LUN, NUMBYTES)
	IMPLICIT NONE
C
	INCLUDE	'INCLIB:SYSPARAM.DEF'
	INCLUDE	'INCLIB:SYSEXTRN.DEF'
	INCLUDE	'INCLIB:DISKQIO.DEF'
	INCLUDE '($RMSDEF)'
C
	INTEGER*4   FDB(7)
	INTEGER*4   LUN
	INTEGER*4   NUMBYTES
	INTEGER*4   K
C
	CALL CHKQINIT()
C
C
	DO 110 K = 1, 7
	  FDB(K) = 0
110	CONTINUE
C
	IF(LUN.LT.1 .OR. LUN.GT.MAXLUNARRAY)THEN
	  TYPE *,IAM(),'BAD LUN IN VAX_DISKQIO/VAXIOQINIT = ',LUN
C***	  CALL LIB$SIGNAL(%VAL(RMS$_FNF))
	  GOTO 9000
	ENDIF
	IF(LUNARRAY(LUN).LE.0)THEN
	  IF(LUNARRAY(LUN).EQ.-1)GOTO 9000  !SPECIAL CASE FOR NOT FOUND
	  TYPE *,IAM(),'BAD CHAN IN VAX_DISKQIO/VAXIOQINIT = ',LUNARRAY(LUN)
	  GOTO 9000
	ENDIF
C
	FDB(FDB_LUN)   = LUN		    !LUN #
	FDB(FDB_CHAN)  = LUNARRAY(LUN)	    !CHANNEL #
	FDB(FDB_BYTES) = NUMBYTES	    !SECTORS PER I/O
C
9000	CONTINUE
	RETURN
	END
