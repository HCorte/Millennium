C
C SUBROUTINE POSTSTS
C
C V08 29-NOV-2000 UXN TOTOGOLO ADDED.
C V07 11-APR-2000 UXN WINCOM.DEF added.
C V06 15-FEB-2000 UXN BIGWRL added.
C V05 13-OCT-1999 RXK World Tour added.
C V04 27-APR-1999 RXK If multiwinsel then wait for ASF file access.
C V03 11-DEC-1994 HXK Write Bingo Status
C V02 03-NOV-1993 HXK CHANGE FOR RAVI AND SPEDE.
C V01 10-SEP-1993 HXK Made UPDCOM consistent with other modules
C  
C
C SUBROUTINE TO POST FINAL STATUS TO GAME FILES
C
C
C+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
C This item is the property of GTECH Corporation, Providence, Rhode
C Island, and contains confidential and trade secret information. It
C may not be transferred from the custody or control of GTECH except
C as authorized in writing by an officer of GTECH. Neither this item
C nor the information it contains may be used, transferred,
C reproduced, published, or disclosed, in whole or in part, and
C directly or indirectly, except as expressly authorized by an
C officer of GTECH, pursuant to written agreement.
C
C Copyright 2000 GTECH Corporation. All rights reserved.
C+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
C
C=======OPTIONS /CHECK=NOOVERFLOW
	SUBROUTINE POSTSTS
	IMPLICIT NONE
C
	INCLUDE 'INCLIB:SYSPARAM.DEF'
	INCLUDE 'INCLIB:SYSEXTRN.DEF'
	INCLUDE 'INCLIB:GLOBAL.DEF'
	INCLUDE 'INCLIB:RECSCF.DEF'
	INCLUDE 'INCLIB:DLTREC.DEF'
	INCLUDE 'INCLIB:DSPREC.DEF'
	INCLUDE 'INCLIB:DTGREC.DEF'
	INCLUDE 'INCLIB:DKKREC.DEF'
        INCLUDE 'INCLIB:DBNREC.DEF'
	INCLUDE 'INCLIB:WINCOM.DEF'
	INCLUDE 'INCLIB:PRMAGT.DEF'
        INCLUDE 'INCLIB:PRZCOM.DEF'
        INCLUDE 'INCLIB:STOPCOM.DEF'
	INCLUDE 'INCLIB:WINUPD.DEF'
	INTEGER*4 FDB(7), ST, K, GNUM, DRAW, GIND
C
C
	DO 100 GIND=1,NUMLTO
	DRAW=LLTDRW(GIND)
	IF(DRAW.LE.0) GOTO 100
	GNUM=SCFGTN(TLTO,GIND)
	WRITE(5,900) IAM(),(SCFGFN(K,GNUM),K=1,5)
	CALL OPENW(1,SCFGFN(1,GNUM),4,0,0,ST)
	IF(ST.NE.0) CALL FILERR(SCFGFN(1,GNUM),1,ST,0)
	CALL IOINIT(FDB,1,DLTSEC*256)
	LLTSTS(GIND)=GFINAL
	CALL GAMLOG(TLTO,GIND,DLTREC,LLTSTS)
	CALL WRITEW(FDB,DRAW,DLTREC,ST)
	IF(ST.NE.0) CALL FILERR(SCFGFN(1,GNUM),3,ST,DRAW)
	CALL CLOSEFIL(FDB)
        CALL FASTMOV(DLTSHV,LPZSHV(1,1,1,GIND),LTGDIV*2)
100	CONTINUE
C
C
	DO 200 GIND=1,NUMSPT
	DRAW=LSPDRW(GIND)
	IF(DRAW.LE.0) GOTO 200
	GNUM=SCFGTN(TSPT,GIND)
	WRITE(5,900) IAM(),(SCFGFN(K,GNUM),K=1,5)
	CALL OPENW(1,SCFGFN(1,GNUM),4,0,0,ST)
	IF(ST.NE.0) CALL FILERR(SCFGFN(1,GNUM),1,ST,0)
	CALL IOINIT(FDB,1,DSPSEC*256)
	LSPSTS(GIND)=GFINAL
	CALL GAMLOG(TSPT,GIND,DSPREC,LSPSTS)
	CALL WRITEW(FDB,DRAW,DSPREC,ST)
	IF(ST.NE.0) CALL FILERR(SCFGFN(1,GNUM),3,ST,DRAW)
	CALL CLOSEFIL(FDB)
        CALL FASTMOV(DSPSHV,SPZSHV(1,1,GIND),SPGDIV)
200	CONTINUE
C
C
	DO 300 GIND=1,NUMKIK
	DRAW=LKKDRW(GIND)
	IF(DRAW.LE.0) GOTO 300
	GNUM=SCFGTN(TKIK,GIND)
	WRITE(5,900) IAM(),(SCFGFN(K,GNUM),K=1,5)
	CALL OPENW(1,SCFGFN(1,GNUM),4,0,0,ST)
	IF(ST.NE.0) CALL FILERR(SCFGFN(1,GNUM),1,ST,0)
	CALL IOINIT(FDB,1,DKKSEC*256)
	LKKSTS(GIND)=GFINAL
	CALL GAMLOG(TKIK,GIND,DKKREC,LKKSTS)
	CALL WRITEW(FDB,DRAW,DKKREC,ST)
	IF(ST.NE.0) CALL FILERR(SCFGFN(1,GNUM),3,ST,DRAW)
	CALL CLOSEFIL(FDB)
        CALL FASTMOV(DKKSHV,KPZSHV(1,1,GIND),KIGDIV)
300	CONTINUE
C
C
	DO 400 GIND=1,NUMTGL
	DRAW=LTGDRW(GIND)
	IF(DRAW.LE.0) GOTO 400
	GNUM=SCFGTN(TTGL,GIND)
	WRITE(5,900) IAM(),(SCFGFN(K,GNUM),K=1,5)
	CALL OPENW(1,SCFGFN(1,GNUM),4,0,0,ST)
	IF(ST.NE.0) CALL FILERR(SCFGFN(1,GNUM),1,ST,0)
	CALL IOINIT(FDB,1,DTGSEC*256)
	LTGSTS(GIND)=GFINAL
	CALL GAMLOG(TTGL,GIND,DTGREC,LTGSTS)
	CALL WRITEW(FDB,DRAW,DTGREC,ST)
	IF(ST.NE.0) CALL FILERR(SCFGFN(1,GNUM),3,ST,DRAW)
	CALL CLOSEFIL(FDB)
        CALL FASTMOV(DTGSHV,TGZSHV(1,1,GIND),TGGDIV)
400	CONTINUE
C
        DO 600 GIND=1,NUMBGO
        DRAW=LBNDRW(GIND)
        IF(DRAW.LE.0) GOTO 600
        GNUM=SCFGTN(TBNG,GIND)
        WRITE(5,900) IAM(),(SCFGFN(K,GNUM),K=1,5)
        CALL OPENW(1,SCFGFN(1,GNUM),4,0,0,ST)
        IF(ST.NE.0) CALL FILERR(SCFGFN(1,GNUM),1,ST,0)
        CALL IOINIT(FDB,1,DBNSEC*256)
        LBNSTS(GIND)=GFINAL
        CALL GAMLOG(TBNG,GIND,DBNREC,LBNSTS)
        CALL WRITEW(FDB,DRAW,DBNREC,ST)
        IF(ST.NE.0) CALL FILERR(SCFGFN(1,GNUM),3,ST,DRAW)
        CALL CLOSEFIL(FDB)
        CALL FASTMOV(DBNSHV(1,BGOBAB),BPZSHV(1,BGOBAB,1,GIND),BGODIV)
        CALL FASTMOV(DBNSHV(1,BGOFHS),BPZSHV(1,BGOFHS,1,GIND),BGODIV)
600     CONTINUE
C
C
C
        TYPE*,IAM(),' Posting big winners to agent file'

        IF(STOPMOD.EQ.WINMANUAL) THEN 
           CALL PSTAWN(WINTAB)
           RETURN
        ENDIF
C
C IF MULTIWINSEL WAIT FOR ASF FILE ACCESS
C
        CALL WAITLOCK(ASFBIT,ASFLOCK) 
        CALL PSTAWN(WINTAB)
        CALL FREELOCK(ASFBIT,ASFLOCK)
C
	RETURN
C
C
900	FORMAT(1X,A,1X,'Posting final status to ',5A4)
	END
