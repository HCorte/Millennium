C SUBROUTINE GETEUM1CONF
C  
C V01 14-MAR-2016 SCML CREATION (M16 PROJECT)
C
C SUBROUTINE TO GET THE EUM1 CONFIGURATION RECORD FROM THE EUM1CF.FIL
C
C+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++C
C Copyright 2016 SCML Corporation. All rights reserved.
C+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
C
C=======OPTIONS /CHECK=NOOVERFLOW
        SUBROUTINE GETEUM1CONF(RECORD,ST)
        IMPLICIT NONE
C
        INCLUDE 'INCLIB:SYSPARAM.DEF'
        INCLUDE 'INCLIB:SYSEXTRN.DEF'
        INCLUDE 'INCLIB:GLOBAL.DEF'
        INCLUDE 'INCLIB:RECEUM1CF.DEF'
C
        INTEGER*4 EUM1LU
        LOGICAL*4 ISTHERE
C
        INTEGER*4 EUM1FDB(7)
        INTEGER*4 RECORD(*), I, ST
C
        ST=-1
C
C       FIND A FREE LUN TO USE
C
        DO 10 EUM1LU = 1, 200
          INQUIRE(UNIT=EUM1LU, OPENED=ISTHERE, IOSTAT=ST)
          IF(ST.EQ.0.AND..NOT.ISTHERE) GOTO 20
10      CONTINUE
        TYPE*,IAM(),'GETEUM1CONF(): NO LUN AVAILABLE BETWEEN 1..200!'
        RETURN
20      CONTINUE
C
C       OPEN THE EUROCONFIG.FIL AND READ THE CONFIGURATION
C
        CALL OPENW(EUM1LU,EUM1CFNAM,4,0,0,ST)
        IF(ST.NE.0) THEN
          CALL FILERR(EUM1CFNAM,1,ST,0)
          RETURN
        ENDIF
        CALL IOINIT(EUM1FDB,EUM1LU,EUM1CF_SEC*256)
        CALL READW(EUM1FDB,1,EUM1CF_REC,ST)
        IF(ST.NE.0) THEN
           CALL FILERR(EUM1CFNAM,2,ST,1)
           CALL CLOSEFIL(EUM1FDB)
           RETURN
        ENDIF
        CALL CLOSEFIL(EUM1FDB)
C
C       MOVE RECORD OVER TO OUTPUT RECORD
C
        CALL FASTMOV(EUM1CF_REC,RECORD,EUM1CF_LEN)
C
        ST=0
        RETURN
        END
