C
C PROGRAM PAYUPD
C
C PAYUPD.FOR
C
C V21 05-FEB-2001 EPH Accumulate values just for prizes paid in cash (not OPs)
C V20 29-NOV-2000 UXN TOTOGOLO ADDED.
C V19 13-OCT-1999 RXK World Tour added.
C V18 27-MAY-1999 RXK Modified for Oddset games (fractions). 
C V17 25-MAY-1999 RXK Bugs for Ravi and Spede fixed (the case if update 
C                     date=cdc)
C V16 14-MAY-1999 UXN Super Triple added.
C V15 23-DEC-1997 RXK Super Score and Today's Triple added.
C V14 10-JAN-1996 HXK Fix for overwriting SuperDouble with WinnersTip record
C V13 23-NOV-1995 HXK Merge of post 65 stuff; changes for Double/Couple
C V12 31-OCT-1994 HXK Redimensioned BPAY, DBNPAD for Bingo
C V11 15-OCT-1994 HXK Adding /developing Bingo (15.Oct.94)
C V10 02-FEB-1994 HXK KICKER NOT UPDATING.
C V09 18-JAN-1994 HXK ADDED UPDATE OF DSCWPO,DSCWRO,DWIWPO,DWIWRO.
C V08 03-JAN-1994 HXK ADDED PAID DATA FOR SCORE, WINNERSTIP.
C V07 02-NOV-1993 HXK FIX FOR 2ND KICKER CASHED TODAY. (DISCREPENCY IN LIABLE 
C                     REPORTS)
C V06 07-OCT-1993 GXA Added liability update by division for Toto Select,
C                     added check for bank winners, second kicker game and
C                     partial purged detailes for all games.
C V05 10-SEP-1993 GXA Added check for Fractions less then zero.
C V04 14-JUL-1993 SXH Released for Finland, added fractions, SPEDEN and RAVI
C V03 21-JAN-1993 DAB Initial Release
C                     Based on Netherlands Bible, 12/92, and Comm 1/93 update
C                     DEC Baseline
C V02 12-NOV-1991 MTK INITIAL RELEASE FOR NETHERLANDS
C V01 01-AUG-1990 XXX RELEASED FOR VAX
C
C PROGRAM TO UPDATE PAYOFF DATA IN THE GAME FILES.
C SCAN THE VALIDATION FILE AND POST ALL OF TODAYS VALIDATIONS
C TO THE GAME FILES.
C
C
C
C+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
C This item is the property of GTECH Corporation, Providence, Rhode
C Island, and contains confidential and trade secret information. It
C may not be transferred from the custody or control of GTECH except
C as authorized in writing by an officer of GTECH. Neither this item
C nor the information it contains may be used, transferred,
C reproduced, published, or disclosed, in whole or in part, and
C directly or indirectly, except as expressly authorized by an
C officer of GTECH, pursuant to written agreement.
C
C Copyright 1999 GTECH Corporation. All rights reserved.
C+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
C
C=======OPTIONS /CHECK=NOOVERFLOW/EXT
	PROGRAM PAYUPD
	IMPLICIT NONE
C
	INCLUDE 'INCLIB:SYSPARAM.DEF'
	INCLUDE 'INCLIB:SYSEXTRN.DEF'

	INCLUDE 'INCLIB:GLOBAL.DEF'
	INCLUDE 'INCLIB:CONCOM.DEF'
	INCLUDE 'INCLIB:DESVAL.DEF'
	INCLUDE 'INCLIB:VALFIL.DEF'
	INCLUDE 'INCLIB:HSHCOM.DEF'
	INCLUDE 'INCLIB:VDETAIL.DEF'
	INCLUDE 'INCLIB:GTNAMES.DEF'
	INCLUDE 'INCLIB:KIKCOM.DEF'

	INCLUDE 'INCLIB:DLTREC.DEF'
	INCLUDE 'INCLIB:DSPREC.DEF'
	INCLUDE 'INCLIB:DTGREC.DEF'
	INCLUDE 'INCLIB:DKKREC.DEF'
        INCLUDE 'INCLIB:DNBREC.DEF'
        INCLUDE 'INCLIB:DSCREC.DEF'
        INCLUDE 'INCLIB:DWIREC.DEF'
	INCLUDE 'INCLIB:DTSREC.DEF'
        INCLUDE 'INCLIB:DBNREC.DEF'
        INCLUDE 'INCLIB:DDBREC.DEF'
        INCLUDE 'INCLIB:DCPREC.DEF'
        INCLUDE 'INCLIB:DSSREC.DEF'
        INCLUDE 'INCLIB:DTRREC.DEF'
        INCLUDE 'INCLIB:DSTREC.DEF'
	INCLUDE 'INCLIB:DATBUF.DEF'

        ! parameters
	INTEGER*4  TUBSIZ, MDRAWS
	PARAMETER (TUBSIZ=I4BUCSIZ*7)
	PARAMETER (MDRAWS=400)
C
C
        ! variables
	INTEGER*4  VLFBUF(TUBSIZ)                           !
        INTEGER*4  FDB(7)                                   !
	INTEGER*4  LPAY(LTGDIV,2,MDRAWS,NUMLTO)             !
        INTEGER*4  NPAY(2,NBGPOL,2,MDRAWS,NUMNBR)           !
	INTEGER*4  SPAY(SPGDIV,MDRAWS,NUMSPT)               !
	INTEGER*4  TGPAY(TGGDIV,MDRAWS,NUMTGL)               !
	INTEGER*4  KPAY(KIGDIV,MDRAWS,NUMKIK)             !
        INTEGER*4  BPAY(BGODIV,BGOSUB,MDRAWS,NUMBGO)        !
        INTEGER*4  RPAY(2,MDRAWS,NUMSCR)                    !
        INTEGER*4  RRPAY(MDRAWS,NUMTOT,NUMSCR)              !
        INTEGER*4  WPAY(2,MDRAWS,NUMWIT)                    !
        INTEGER*4  WWPAY(MDRAWS,NUMTOT,NUMWIT)              !
        INTEGER*4  TPAY(2,MDRAWS,NUMTSL)                    !
	INTEGER*4  TTPAY(TSLDIV,MDRAWS,NUMTOT,NUMTSL)	    !
        INTEGER*4  DPAY(2,MDRAWS,NUMDBL)                    !
        INTEGER*4  DDPAY(MDRAWS,NUMTOT,NUMDBL)              !
        INTEGER*4  CPAY(2,MDRAWS,NUMCPL)                    !
        INTEGER*4  CCPAY(MDRAWS,NUMTOT,NUMCPL)              !
        INTEGER*4  UPAY(2,MDRAWS,NUMSSC)                    !
        INTEGER*4  UUPAY(MDRAWS,NUMTOT,NUMSSC)              !
        INTEGER*4  IPAY(2,MDRAWS,NUMTRP)                    !
        INTEGER*4  IIPAY(MDRAWS,NUMTOT,NUMTRP)              !
        INTEGER*4  STPAY(2,MDRAWS,NUMSTR)                    !
        INTEGER*4  STRPAY(MDRAWS,NUMTOT,NUMSTR)              !
	INTEGER*4  LFLAGS(MDRAWS,NUMLTO)                    !
	INTEGER*4  SFLAGS(MDRAWS,NUMSPT)                    !
	INTEGER*4  TGFLAGS(MDRAWS,NUMTGL)                    !
	INTEGER*4  KFLAGS(MDRAWS,NUMKIK)                    !
	INTEGER*4  NFLAGS(MDRAWS,NUMNBR)                    !
	INTEGER*4  RFLAGS(MDRAWS,NUMSCR)                    !
	INTEGER*4  WFLAGS(MDRAWS,NUMWIT)                    !
        INTEGER*4  BFLAGS(MDRAWS,NUMBGO)                    !
	INTEGER*4  TFLAGS(MDRAWS,NUMTSL)                    !
	INTEGER*4  DFLAGS(MDRAWS,NUMDBL)                    !
	INTEGER*4  CFLAGS(MDRAWS,NUMCPL)                    !
	INTEGER*4  UFLAGS(MDRAWS,NUMSSC)                    !
	INTEGER*4  IFLAGS(MDRAWS,NUMTRP)                    !
	INTEGER*4  STFLAGS(MDRAWS,NUMSTR)                    !
	INTEGER*4  DRAW                                     !
	INTEGER*4  GNUM                                     !
	INTEGER*4  SHR                                      !
	INTEGER*4  DIV                                      !
	INTEGER*4  DRWIND                                   !
	INTEGER*4  I                                        !
	INTEGER*4  KIND                                     !
	INTEGER*4  POL                                      !
	INTEGER*4  KGAM                                     !
	INTEGER*4  GIND                                     !
	INTEGER*4  GAM                                      !
	INTEGER*4  K                                        !
	INTEGER*4  CDC                                      !
	INTEGER*4  ST                                       !
	INTEGER*4  BNS                                      !
	INTEGER*4  REF                                      !
        INTEGER*4  FRCS                                     !
        INTEGER*4  SUBGAME                                  !
        INTEGER*4  KSUB

	INTEGER*2  DAT(LDATE_LEN)                           !

	LOGICAL KIKWON                                      !

	EQUIVALENCE(DLTREC,DSPREC,DKKREC,DNBREC,DBNREC)
	EQUIVALENCE(DLTREC,DSSREC,DTRREC)
	CALL COPYRITE
	CALL SNIF_AND_WRKSET
C
C
	CALL FASTSET(0,LPAY,LTGDIV*MDRAWS*NUMLTO*2)
        CALL FASTSET(0,NPAY,2*NBGPOL*MDRAWS*NUMNBR*2)
	CALL FASTSET(0,SPAY,SPGDIV*MDRAWS*NUMSPT)
	CALL FASTSET(0,TGPAY,TGGDIV*MDRAWS*NUMTGL)
	CALL FASTSET(0,KPAY,KIGDIV*MDRAWS*NUMKIK)
        CALL FASTSET(0,BPAY,BGODIV*BGOSUB*MDRAWS*NUMBGO)
        CALL FASTSET(0,RPAY,2*MDRAWS*NUMSCR)
        CALL FASTSET(0,RRPAY,MDRAWS*NUMTOT*NUMSCR)
        CALL FASTSET(0,WPAY,2*MDRAWS*NUMWIT)
        CALL FASTSET(0,WWPAY,MDRAWS*NUMTOT*NUMWIT)
        CALL FASTSET(0,TPAY,2*MDRAWS*NUMTSL)
	CALL FASTSET(0,TTPAY,TSLDIV*MDRAWS*NUMTOT*NUMTSL)
        CALL FASTSET(0,DPAY,2*MDRAWS*NUMDBL)
        CALL FASTSET(0,DDPAY,MDRAWS*NUMTOT*NUMDBL)
        CALL FASTSET(0,CPAY,2*MDRAWS*NUMCPL)
        CALL FASTSET(0,CCPAY,MDRAWS*NUMTOT*NUMCPL)
        CALL FASTSET(0,UPAY,2*MDRAWS*NUMSSC)
        CALL FASTSET(0,UUPAY,MDRAWS*NUMTOT*NUMSSC)
        CALL FASTSET(0,IPAY,2*MDRAWS*NUMTRP)
        CALL FASTSET(0,IIPAY,MDRAWS*NUMTOT*NUMTRP)
        CALL FASTSET(0,STPAY,2*MDRAWS*NUMSTR)
        CALL FASTSET(0,STRPAY,MDRAWS*NUMTOT*NUMSTR)

	CALL FASTSET(0,LFLAGS,MDRAWS*NUMLTO)
	CALL FASTSET(0,SFLAGS,MDRAWS*NUMSPT)
	CALL FASTSET(0,TGFLAGS,MDRAWS*NUMTGL)
	CALL FASTSET(0,KFLAGS,MDRAWS*NUMKIK)
	CALL FASTSET(0,NFLAGS,MDRAWS*NUMNBR)
        CALL FASTSET(0,RFLAGS,MDRAWS*NUMSCR)
        CALL FASTSET(0,WFLAGS,MDRAWS*NUMWIT)
        CALL FASTSET(0,TFLAGS,MDRAWS*NUMTSL)
        CALL FASTSET(0,BFLAGS,MDRAWS*NUMBGO)
        CALL FASTSET(0,DFLAGS,MDRAWS*NUMDBL)
        CALL FASTSET(0,CFLAGS,MDRAWS*NUMCPL)
        CALL FASTSET(0,UFLAGS,MDRAWS*NUMSSC)
        CALL FASTSET(0,IFLAGS,MDRAWS*NUMTRP)
        CALL FASTSET(0,STFLAGS,MDRAWS*NUMSTR)
C
C
	CDC=DAYCDC
	IF(DAYSTS.NE.DSCLOS) THEN
	    TYPE*,IAM(),' Invalid daysts > ',DAYSTS
	    CALL GPAUSE
	ENDIF

	DAT(5)=CDC
	CALL LCDATE(DAT)
	WRITE(5,900) IAM(),(DAT(K),K=7,13)
C
C OPEN VALIDATION FILE FOR SEQUENTIAL READ
C
	CALL IOPEN(SFNAMES(1,VLF),VLF,VFLEN*2,VFSCDC,VFSSER*2-1,ST)
	IF(ST.NE.0) CALL FILERR(SFNAMES(1,VLF),1,ST,0)
	CALL ITUBSIZE(VLF,TUBSIZ)
C
C
C SCAN VLF FILE FOR TODAYS VALIDATIONS
C
	TYPE*,IAM(),' Extracting payoff data from the VLF.FIL'
100	CONTINUE
	CALL ISREAD(V4BUF,VLF,VLFBUF,ST)
	IF(ST.EQ.ERREND) THEN
	    CALL ICLOSE(VLF,VLFBUF,ST)
	    GOTO 8000
	ENDIF
	IF(ST.NE.0) CALL FILERR(SFNAMES(1,VLF),2,ST,0)
C
C CHECK IF CASHED TODAY
C
	CALL LOGVAL(VALREC,V4BUF)
	IF(VALREC(VCCDC).NE.CDC) GOTO 100
	IF(VALREC(VSTAT).NE.VCASH.AND.VALREC(VSTAT).NE.VCASHX.AND.
     *     VALREC(VSTAT).NE.VBANK)  GOTO 100
C
C
	KIKWON = .FALSE.
	GAM    = VALREC(VGAM)
	GIND   = VALREC(VGIND)
	KGAM   = VALREC(VKGME)
	IF(KGAM.NE.0) KIND=GNTTAB(GAMIDX,KGAM)
	CALL DLOGVAL(VALREC,VDETAIL)
C
C
	IF(VALREC(VGTYP).EQ.TLTO) GOTO 1000
	IF(VALREC(VGTYP).EQ.TSPT) GOTO 2000
	IF(VALREC(VGTYP).EQ.TKIK) GOTO 3000
        IF(VALREC(VGTYP).EQ.TNBR) GOTO 4000
        IF(VALREC(VGTYP).EQ.TSCR) GOTO 5000
        IF(VALREC(VGTYP).EQ.TWIT) GOTO 6000
	IF(VALREC(VGTYP).EQ.TTSL) GOTO 7000
        IF(VALREC(VGTYP).EQ.TBNG) GOTO 19000
        IF(VALREC(VGTYP).EQ.TDBL) GOTO 20000
        IF(VALREC(VGTYP).EQ.TCPL) GOTO 21000
        IF(VALREC(VGTYP).EQ.TSSC) GOTO 22000
        IF(VALREC(VGTYP).EQ.TTRP) GOTO 23000
        IF(VALREC(VGTYP).EQ.TSTR) GOTO 24000
	IF(VALREC(VGTYP).EQ.TTGL) GOTO 25000
	GOTO 100
C
C UPDATE LOTTO GAME PAYOFF DATA
C
1000	CONTINUE
	DO 1010 I=1,VALREC(VPZOFF)
	    IF(VDETAIL(VPRG,I).EQ.1) GOTO 1010
            IF (VDETAIL(VOP,I).EQ.1) GOTO 1010     !V21
	    IF(VDETAIL(VKIK,I).NE.0.OR.VDETAIL(VKI2,I).NE.0) THEN
	        KIKWON=.TRUE.
	        GOTO 1010
	    ENDIF

	    DRWIND=DAYHDR(GAM)-VDETAIL(VDRW,I)+1
	    IF(DRWIND.LT.1.OR.DRWIND.GT.MDRAWS) THEN
	        WRITE(5,901) IAM(),GTNAMES(TLTO),GIND,DRWIND
	        CALL GPAUSE
	    ENDIF

	    BNS = 1
	    DIV = VDETAIL(VDIV,I)
	    SHR = VDETAIL(VSHR,I)
            FRCS = VALREC(VFRAC)
            IF(FRCS .EQ. 0) FRCS=MAXFRC(GAM)
	    IF(FRCS .EQ. 0) FRCS = 1
	    IF(VDETAIL(VBDR,I).NE.0) BNS=2
	    LPAY(DIV,BNS,DRWIND,GIND)=LPAY(DIV,BNS,DRWIND,GIND)+SHR*FRCS
	    LFLAGS(DRWIND,GIND)=1
1010	CONTINUE
	IF(KIKWON) GOTO 3000
	GOTO 100
C
C UPDATE SPORTS GAME PAYOFF DATA
C
2000	CONTINUE
	DO 2010 I=1,VALREC(VPZOFF)
	    IF(VDETAIL(VPRG,I).EQ.1) GOTO 2010
            IF (VDETAIL(VOP,I).EQ.1) GOTO 2010     !V21
	    IF(VDETAIL(VKIK,I).NE.0.OR.VDETAIL(VKI2,I).NE.0) THEN
	        KIKWON=.TRUE.
	        GOTO 2010
	    ENDIF

	    DRWIND=DAYHDR(GAM)-VDETAIL(VDRW,I)+1
	    IF(DRWIND.LT.1.OR.DRWIND.GT.MDRAWS) THEN
	        WRITE(5,901) IAM(),GTNAMES(TSPT),GIND,DRWIND
	        CALL GPAUSE
	    ENDIF

	    DIV = VDETAIL(VDIV,I)
	    SHR = VDETAIL(VSHR,I)
            FRCS = VALREC(VFRAC)
            IF(FRCS .EQ. 0) FRCS = MAXFRC(GAM)
	    IF(FRCS .EQ. 0) FRCS = 1
	    SPAY(DIV,DRWIND,GIND)=SPAY(DIV,DRWIND,GIND)+SHR*FRCS
	    SFLAGS(DRWIND,GIND)=1
2010	CONTINUE
	IF(KIKWON) GOTO 3000
	GOTO 100
C
C UPDATE KICKER GAME PAYOFF DATA
C
3000	CONTINUE
	DO 3010 I=1,VALREC(VPZOFF)
	    IF(VDETAIL(VPRG,I).EQ.1) GOTO 3010
            IF (VDETAIL(VOP,I).EQ.1) GOTO 3010     !V21
	    IF(VDETAIL(VKIK,I).EQ.0.AND.VDETAIL(VKI2,I).EQ.0) GOTO 3010
	    DRWIND=DAYHDR(KGAM)-VDETAIL(VDRW,I)+1
	    IF(DRWIND.LT.1.OR.DRWIND.GT.MDRAWS) THEN
	        WRITE(5,901) IAM(),GTNAMES(TKIK),KIND,DRWIND
	        CALL GPAUSE
	    ENDIF
	    DIV = VDETAIL(VDIV,I)
	    SHR = VDETAIL(VSHR,I)
            FRCS = VALREC(VFRAC)
            IF(FRCS .EQ. 0) FRCS=MAXFRC(KGAM)
	    IF(FRCS .EQ. 0) FRCS = 1
            KSUB = VDETAIL(VSUB,I)
            KPAY(DIV,DRWIND,KIND)=KPAY(DIV,DRWIND,KIND)+SHR*FRCS
	    KFLAGS(DRWIND,KIND)=1
3010	CONTINUE
	GOTO 100
C
C UPDATE NUMBERS GAME PAYOFF DATA
C
4000    CONTINUE
        DO 4010 I=1,VALREC(VPZOFF)
	    IF(VDETAIL(VPRG,I).EQ.1) GOTO 4010
            IF (VDETAIL(VOP,I).EQ.1) GOTO 4010     !V21
            IF(VDETAIL(VKIK,I).NE.0.OR.VDETAIL(VKI2,I).NE.0) THEN
                KIKWON=.TRUE.
                GOTO 4010
            ENDIF

            DRWIND=DAYHDR(GAM)-VDETAIL(VDRW,I)+1
            IF(DRWIND.LT.1.OR.DRWIND.GT.MDRAWS) THEN
                WRITE(5,901) IAM(),GTNAMES(TNBR),GIND,DRWIND
                CALL GPAUSE
            ENDIF

	    BNS = 1
            DIV = VDETAIL(VDIV,I)
            SHR = VDETAIL(VSHR,I)
            FRCS = VALREC(VFRAC)
            IF(FRCS .EQ. 0) FRCS = MAXFRC(GAM)
	    IF(FRCS .EQ. 0) FRCS = 1

	    IF(VDETAIL(VBDR,I).NE.0) BNS=2
	    NPAY(1,DIV,BNS,DRWIND,GIND)=NPAY(1,DIV,BNS,DRWIND,GIND)+1
            NPAY(2,DIV,BNS,DRWIND,GIND)=NPAY(2,DIV,BNS,DRWIND,GIND)+SHR*FRCS
            NFLAGS(DRWIND,GIND)=1
4010    CONTINUE
        IF(KIKWON) GOTO 3000
        GOTO 100
C
C UPDATE SCORE GAME PAYOFF DATA
C
5000    CONTINUE
        DO 5010 I=1,VALREC(VPZOFF)
	    IF(VDETAIL(VPRG,I).EQ.1) GOTO 5010
            IF (VDETAIL(VOP,I).EQ.1) GOTO 5010     !V21
            IF(VDETAIL(VKIK,I).NE.0.OR.VDETAIL(VKI2,I).NE.0) THEN
                KIKWON=.TRUE.
                GOTO 5010
            ENDIF

            DRWIND=DAYHDR(GAM)-VDETAIL(VDRW,I)+1
            IF(DRWIND.LT.1.OR.DRWIND.GT.MDRAWS) THEN
                WRITE(5,901) IAM(),GTNAMES(TSCR),GIND,DRWIND
                CALL GPAUSE
            ENDIF

            REF = VDETAIL(VREF,I)
            SHR = VDETAIL(VSHR,I)
            RRPAY(DRWIND,1,GIND) = RRPAY(DRWIND,1,GIND) + 1
            RRPAY(DRWIND,2,GIND) = RRPAY(DRWIND,2,GIND) + SHR
            RPAY(1,DRWIND,GIND)=RPAY(1,DRWIND,GIND)+SHR
	    IF(REF.NE.0) RPAY(2,DRWIND,GIND)=RPAY(2,DRWIND,GIND)+SHR
            RFLAGS(DRWIND,GIND)=1
5010    CONTINUE
        IF(KIKWON) GOTO 3000
        GOTO 100
C
C UPDATE WINNERS TIP GAME PAYOFF DATA
C
6000    CONTINUE
        DO 6010 I=1,VALREC(VPZOFF)
	    IF(VDETAIL(VPRG,I).EQ.1) GOTO 6010
            IF (VDETAIL(VOP,I).EQ.1) GOTO 6010     !V21
            IF(VDETAIL(VKIK,I).NE.0.OR.VDETAIL(VKI2,I).NE.0) THEN
                KIKWON=.TRUE.
                GOTO 6010
            ENDIF

            DRWIND=DAYHDR(GAM)-VDETAIL(VDRW,I)+1
            IF(DRWIND.LT.1.OR.DRWIND.GT.MDRAWS) THEN
                WRITE(5,901) IAM(),GTNAMES(TWIT),GIND,DRWIND
                CALL GPAUSE
            ENDIF

            REF = VDETAIL(VREF,I)
            SHR = VDETAIL(VSHR,I)
            WWPAY(DRWIND,1,GIND) = WWPAY(DRWIND,1,GIND) + 1
            WWPAY(DRWIND,2,GIND) = WWPAY(DRWIND,2,GIND) + SHR
            WPAY(1,DRWIND,GIND)=WPAY(1,DRWIND,GIND)+SHR
            IF(REF.NE.0) WPAY(2,DRWIND,GIND)=WPAY(2,DRWIND,GIND)+SHR
            WFLAGS(DRWIND,GIND)=1
6010    CONTINUE
        IF(KIKWON) GOTO 3000
        GOTO 100
C
C UPDATE TOTO SELECT GAME PAYOFF DATA
C
7000    CONTINUE
        DO 7010 I=1,VALREC(VPZOFF)
	    IF(VDETAIL(VPRG,I).EQ.1) GOTO 7010
            IF (VDETAIL(VOP,I).EQ.1) GOTO 7010     !V21
            IF(VDETAIL(VKIK,I).NE.0.OR.VDETAIL(VKI2,I).NE.0) THEN
                KIKWON=.TRUE.
                GOTO 7010
            ENDIF

            DRWIND=DAYHDR(GAM)-VDETAIL(VDRW,I)+1
            IF(DRWIND.LT.1.OR.DRWIND.GT.MDRAWS) THEN
                WRITE(5,901) IAM(),GTNAMES(TTSL),GIND,DRWIND
                CALL GPAUSE
            ENDIF

	    DIV = VDETAIL(VDIV,I)
            REF = VDETAIL(VREF,I)
            SHR = VDETAIL(VSHR,I)
	    TTPAY(DIV,DRWIND,1,GIND) = TTPAY(DIV,DRWIND,1,GIND) + 1
	    TTPAY(DIV,DRWIND,2,GIND) = TTPAY(DIV,DRWIND,2,GIND) + SHR
            TPAY(1,DRWIND,GIND)=TPAY(1,DRWIND,GIND)+SHR
            IF(REF.NE.0) TPAY(2,DRWIND,GIND)=TPAY(2,DRWIND,GIND)+SHR
            TFLAGS(DRWIND,GIND)=1
7010    CONTINUE
        IF(KIKWON) GOTO 3000
        GOTO 100
C
C UPDATE RESULTS GAME PAYOFF DATA
C
25000	CONTINUE
	DO 25010 I=1,VALREC(VPZOFF)
	    IF(VDETAIL(VPRG,I).EQ.1) GOTO 25010
            IF (VDETAIL(VOP,I).EQ.1) GOTO 25010     !V21
	    IF(VDETAIL(VKIK,I).NE.0.OR.VDETAIL(VKI2,I).NE.0) THEN
	        KIKWON=.TRUE.
	        GOTO 25010
	    ENDIF

	    DRWIND=DAYHDR(GAM)-VDETAIL(VDRW,I)+1
	    IF(DRWIND.LT.1.OR.DRWIND.GT.MDRAWS) THEN
	        WRITE(5,901) IAM(),GTNAMES(TTGL),GIND,DRWIND
	        CALL GPAUSE
	    ENDIF

	    DIV = VDETAIL(VDIV,I)
	    SHR = VDETAIL(VSHR,I)
            FRCS = VALREC(VFRAC)
            IF(FRCS .EQ. 0) FRCS = MAXFRC(GAM)
	    IF(FRCS .EQ. 0) FRCS = 1
	    TGPAY(DIV,DRWIND,GIND)=TGPAY(DIV,DRWIND,GIND)+SHR*FRCS
	    TGFLAGS(DRWIND,GIND)=1
25010	CONTINUE
	IF(KIKWON) GOTO 3000
	GOTO 100
C
C UPDATE BINGO GAME PAYOFF DATA
C
19000   CONTINUE
        DO 19010 I=1,VALREC(VPZOFF)
            IF(VDETAIL(VPRG,I).EQ.1) GOTO 19010
            IF (VDETAIL(VOP,I).EQ.1) GOTO 19010     !V21
            IF(VDETAIL(VKIK,I).NE.0.OR.VDETAIL(VKI2,I).NE.0) THEN
                KIKWON=.TRUE.
                GOTO 19010
            ENDIF

            DRWIND=DAYHDR(GAM)-VDETAIL(VDRW,I)+1
            IF(DRWIND.LT.1.OR.DRWIND.GT.MDRAWS) THEN
                WRITE(5,901) IAM(),GTNAMES(TBNG),GIND,DRWIND
                CALL GPAUSE
            ENDIF

            DIV = VDETAIL(VDIV,I)
            SHR = VDETAIL(VSHR,I)
            SUBGAME = VDETAIL(VSUB,I)
            FRCS = VALREC(VFRAC) 
            IF(FRCS .EQ. 0) FRCS = MAXFRC(GAM)
            IF(FRCS .EQ. 0) FRCS = 1
            BPAY(DIV,SUBGAME,DRWIND,GIND) = BPAY(DIV,SUBGAME,DRWIND,GIND) + 
     *                                      SHR*FRCS
            BFLAGS(DRWIND,GIND)=1
19010   CONTINUE
        IF(KIKWON) GOTO 3000
        GOTO 100
C
C UPDATE DOUBLE GAME PAYOFF DATA
C
20000   CONTINUE
        DO 20010 I=1,VALREC(VPZOFF)
	    IF(VDETAIL(VPRG,I).EQ.1) GOTO 20010
            IF (VDETAIL(VOP,I).EQ.1) GOTO 20010     !V21
            IF(VDETAIL(VKIK,I).NE.0.OR.VDETAIL(VKI2,I).NE.0) THEN
                KIKWON=.TRUE.
                GOTO 20010
            ENDIF

            DRWIND=DAYHDR(GAM)-VDETAIL(VDRW,I)+1
            IF(DRWIND.LT.1.OR.DRWIND.GT.MDRAWS) THEN
                WRITE(5,901) IAM(),GTNAMES(TDBL),GIND,DRWIND
                CALL GPAUSE
            ENDIF

            REF = VDETAIL(VREF,I)
            SHR = VDETAIL(VSHR,I)
            DDPAY(DRWIND,1,GIND) = DDPAY(DRWIND,1,GIND) + 1
            DDPAY(DRWIND,2,GIND) = DDPAY(DRWIND,2,GIND) + SHR
            DPAY(1,DRWIND,GIND)=DPAY(1,DRWIND,GIND)+SHR
            IF(REF.NE.0) DPAY(2,DRWIND,GIND)=DPAY(2,DRWIND,GIND)+SHR
            DFLAGS(DRWIND,GIND)=1
20010   CONTINUE
        IF(KIKWON) GOTO 3000
        GOTO 100
C
C UPDATE COUPLE GAME PAYOFF DATA
C
21000   CONTINUE
        DO 21010 I=1,VALREC(VPZOFF)
	    IF(VDETAIL(VPRG,I).EQ.1) GOTO 21010
            IF (VDETAIL(VOP,I).EQ.1) GOTO 21010     !V21
            IF(VDETAIL(VKIK,I).NE.0.OR.VDETAIL(VKI2,I).NE.0) THEN
                KIKWON=.TRUE.
                GOTO 21010
            ENDIF

            DRWIND=DAYHDR(GAM)-VDETAIL(VDRW,I)+1
            IF(DRWIND.LT.1.OR.DRWIND.GT.MDRAWS) THEN
                WRITE(5,901) IAM(),GTNAMES(TCPL),GIND,DRWIND
                CALL GPAUSE
            ENDIF

            REF = VDETAIL(VREF,I)
            SHR = VDETAIL(VSHR,I)
            CCPAY(DRWIND,1,GIND) = CCPAY(DRWIND,1,GIND) + 1
            CCPAY(DRWIND,2,GIND) = CCPAY(DRWIND,2,GIND) + SHR
            CPAY(1,DRWIND,GIND)=CPAY(1,DRWIND,GIND)+SHR
            IF(REF.NE.0) CPAY(2,DRWIND,GIND)=CPAY(2,DRWIND,GIND)+SHR
            CFLAGS(DRWIND,GIND)=1
21010   CONTINUE
        IF(KIKWON) GOTO 3000
        GOTO 100
C
C UPDATE SUPERSCORE GAME PAYOFF DATA
C
22000   CONTINUE
        DO 22010 I=1,VALREC(VPZOFF)
	    IF(VDETAIL(VPRG,I).EQ.1) GOTO 22010
            IF (VDETAIL(VOP,I).EQ.1) GOTO 22010     !V21
            IF(VDETAIL(VKIK,I).NE.0.OR.VDETAIL(VKI2,I).NE.0) THEN
                KIKWON=.TRUE.
                GOTO 22010
            ENDIF

            DRWIND=DAYHDR(GAM)-VDETAIL(VDRW,I)+1
            IF(DRWIND.LT.1.OR.DRWIND.GT.MDRAWS) THEN
                WRITE(5,901) IAM(),GTNAMES(TSSC),GIND,DRWIND
                CALL GPAUSE
            ENDIF

            REF = VDETAIL(VREF,I)
            SHR = VDETAIL(VSHR,I)
            UUPAY(DRWIND,1,GIND) = UUPAY(DRWIND,1,GIND) + 1
            UUPAY(DRWIND,2,GIND) = UUPAY(DRWIND,2,GIND) + SHR
            UPAY(1,DRWIND,GIND)=UPAY(1,DRWIND,GIND)+SHR
	    IF(REF.NE.0) UPAY(2,DRWIND,GIND)=UPAY(2,DRWIND,GIND)+SHR
            UFLAGS(DRWIND,GIND)=1
22010   CONTINUE
        IF(KIKWON) GOTO 3000
        GOTO 100
C
C UPDATE TRIO GAME PAYOFF DATA
C
23000   CONTINUE
        DO 23010 I=1,VALREC(VPZOFF)
	    IF(VDETAIL(VPRG,I).EQ.1) GOTO 23010
            IF (VDETAIL(VOP,I).EQ.1) GOTO 23010     !V21
            IF(VDETAIL(VKIK,I).NE.0.OR.VDETAIL(VKI2,I).NE.0) THEN
                KIKWON=.TRUE.
                GOTO 23010
            ENDIF

            DRWIND=DAYHDR(GAM)-VDETAIL(VDRW,I)+1
            IF(DRWIND.LT.1.OR.DRWIND.GT.MDRAWS) THEN
                WRITE(5,901) IAM(),GTNAMES(TTRP),GIND,DRWIND
                CALL GPAUSE
            ENDIF

            REF = VDETAIL(VREF,I)
            SHR = VDETAIL(VSHR,I)
            IIPAY(DRWIND,1,GIND) = IIPAY(DRWIND,1,GIND) + 1
            IIPAY(DRWIND,2,GIND) = IIPAY(DRWIND,2,GIND) + SHR
            IPAY(1,DRWIND,GIND)=IPAY(1,DRWIND,GIND)+SHR
            IF(REF.NE.0) IPAY(2,DRWIND,GIND)=IPAY(2,DRWIND,GIND)+SHR
            IFLAGS(DRWIND,GIND)=1
23010   CONTINUE
        IF(KIKWON) GOTO 3000
        GOTO 100
C
C UPDATE SUPER TRIPLE GAME PAYOFF DATA
C
24000   CONTINUE
        DO 24010 I=1,VALREC(VPZOFF)
	    IF(VDETAIL(VPRG,I).EQ.1) GOTO 24010
            IF (VDETAIL(VOP,I).EQ.1) GOTO 24010     !V21
            IF(VDETAIL(VKIK,I).NE.0.OR.VDETAIL(VKI2,I).NE.0) THEN
                KIKWON=.TRUE.
                GOTO 24010
            ENDIF

            DRWIND=DAYHDR(GAM)-VDETAIL(VDRW,I)+1
            IF(DRWIND.LT.1.OR.DRWIND.GT.MDRAWS) THEN
                WRITE(5,901) IAM(),GTNAMES(TSTR),GIND,DRWIND
                CALL GPAUSE
            ENDIF

            REF = VDETAIL(VREF,I)
            SHR = VDETAIL(VSHR,I)
            STRPAY(DRWIND,1,GIND) = STRPAY(DRWIND,1,GIND) + 1
            STRPAY(DRWIND,2,GIND) = STRPAY(DRWIND,2,GIND) + SHR
            STPAY(1,DRWIND,GIND)=STPAY(1,DRWIND,GIND)+SHR
            IF(REF.NE.0) STPAY(2,DRWIND,GIND)=STPAY(2,DRWIND,GIND)+SHR
            STFLAGS(DRWIND,GIND)=1
24010   CONTINUE
        IF(KIKWON) GOTO 3000
        GOTO 100
C
C
C UPDATE LOTTO GAME FILES
C
8000    CONTINUE
        DO 8100 GIND=1,MAXIND
            GNUM=GTNTAB(TLTO,GIND)
	    IF(GNUM.LT.1) GOTO 8100
	    IF(DAYHDR(GNUM).LT.1) GOTO 8100
	    WRITE(5,902) IAM(),(GFNAMES(K,GNUM),K=1,5)
C
C
	    CALL OPENW(3,GFNAMES(1,GNUM),4,0,0,ST)
	    CALL IOINIT(FDB,3,DLTSEC*256)
	    IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),1,ST,0)
C
C
	    DO 8020 DRWIND=1,MDRAWS
	        IF(LFLAGS(DRWIND,GIND).EQ.0) GOTO 8020
	        DRAW=DAYHDR(GNUM)-DRWIND+1
	        CALL READW(FDB,DRAW,DLTREC,ST)
	        IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),1,ST,DRAW)
	        IF(DLTUPD.GE.CDC) GOTO 8020

	        DO BNS = 1, 2
	            DO DIV=1,LTGDIV
	                DLTPAD(DIV,BNS) = DLTPAD(DIV,BNS) + 
     *                                    LPAY(DIV,BNS,DRWIND,GIND)
                    END DO
                END DO
	        DLTUPD=CDC
C
	        CALL WRITEW(FDB,DRAW,DLTREC,ST)
	        IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),2,ST,DRAW)
8020	    CONTINUE

	    CALL USRCLOS1(3)
8100	CONTINUE
C
C UPDATE SPORTS GAME FILES
C
	DO 9100 GIND=1,MAXIND
	    GNUM=GTNTAB(TSPT,GIND)
	    IF(GNUM.LT.1) GOTO 9100
	    IF(DAYHDR(GNUM).LT.1) GOTO 9100
	    WRITE(5,902) IAM(),(GFNAMES(K,GNUM),K=1,5)
C
C
	    CALL OPENW(3,GFNAMES(1,GNUM),4,0,0,ST)
	    CALL IOINIT(FDB,3,DSPSEC*256)
	    IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),1,ST,0)
C
C
	    DO 9020 DRWIND=1,MDRAWS
	        IF(SFLAGS(DRWIND,GIND).EQ.0) GOTO 9020
	        DRAW=DAYHDR(GNUM)-DRWIND+1
	        CALL READW(FDB,DRAW,DSPREC,ST)
	        IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),1,ST,DRAW)
	        IF(DSPUPD.GE.CDC) GOTO 9020

	        DO DIV=1,SPGDIV
	            DSPPAD(DIV)=DSPPAD(DIV)+SPAY(DIV,DRWIND,GIND)
                END DO
	        DSPUPD=CDC
C
C
	        CALL WRITEW(FDB,DRAW,DSPREC,ST)
	        IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),2,ST,DRAW)
9020	    CONTINUE
	    CALL USRCLOS1(3)
9100	CONTINUE
C
C UPDATE RESULTS GAME FILES
C
	DO 9200 GIND=1,MAXIND
	    GNUM=GTNTAB(TTGL,GIND)
	    IF(GNUM.LT.1) GOTO 9200
	    IF(DAYHDR(GNUM).LT.1) GOTO 9200
	    WRITE(5,902) IAM(),(GFNAMES(K,GNUM),K=1,5)
C
C
	    CALL OPENW(3,GFNAMES(1,GNUM),4,0,0,ST)
	    CALL IOINIT(FDB,3,DTGSEC*256)
	    IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),1,ST,0)
C
C
	    DO 9220 DRWIND=1,MDRAWS
	        IF(TGFLAGS(DRWIND,GIND).EQ.0) GOTO 9220
	        DRAW=DAYHDR(GNUM)-DRWIND+1
	        CALL READW(FDB,DRAW,DTGREC,ST)
	        IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),1,ST,DRAW)
	        IF(DTGUPD.GE.CDC) GOTO 9220

	        DO DIV=1,TGGDIV
	            DTGPAD(DIV)=DTGPAD(DIV)+TGPAY(DIV,DRWIND,GIND)
                END DO
	        DTGUPD=CDC
C
C
	        CALL WRITEW(FDB,DRAW,DTGREC,ST)
	        IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),2,ST,DRAW)
9220	    CONTINUE
	    CALL USRCLOS1(3)
9200	CONTINUE
C
C UPDATE NUMBERS GAME FILES
C
        DO 10100 GIND=1,MAXIND
            GNUM=GTNTAB(TNBR,GIND)
            IF(GNUM.LT.1) GOTO 10100
            IF(DAYHDR(GNUM).LT.1) GOTO 10100
            WRITE(5,902) IAM(),(GFNAMES(K,GNUM),K=1,5)
C
C
            CALL OPENW(3,GFNAMES(1,GNUM),4,0,0,ST)
            CALL IOINIT(FDB,3,DNBSEC*256)
            IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),1,ST,0)
C
C
            DO 10020 DRWIND=1,MDRAWS
                IF(NFLAGS(DRWIND,GIND).EQ.0) GOTO 10020
                DRAW=DAYHDR(GNUM)-DRWIND+1
                CALL READW(FDB,DRAW,DNBREC,ST)
                IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),1,ST,DRAW)
                IF(DNBUPD.GE.CDC) GOTO 10020

	        DO BNS = 1, 2
                    DO POL = 1, NBGPOL
                        DNBPAD(TRACNT,POL,BNS) = DNBPAD(TRACNT,POL,BNS)+
     *                                           NPAY(1,POL,BNS,DRWIND,GIND)
                        DNBPAD(DOLAMT,POL,BNS) = DNBPAD(DOLAMT,POL,BNS) +
     *                    NPAY(2,POL,BNS,DRWIND,GIND)*DNBPRZ(POL,BNS)
                    END DO
                END DO
                DNBUPD=CDC
C
C
                CALL WRITEW(FDB,DRAW,DNBREC,ST)
                IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),2,ST,DRAW)
10020       CONTINUE
            CALL USRCLOS1(3)
10100   CONTINUE
C
C UPDATE KICKER GAME FILES
C
	DO 11100 GIND=1,MAXIND
	    GNUM=GTNTAB(TKIK,GIND)
	    IF(GNUM.LT.1) GOTO 11100
	    IF(DAYHDR(GNUM).LT.1) GOTO 11100
	    WRITE(5,902) IAM(),(GFNAMES(K,GNUM),K=1,5)
C
C
	    CALL OPENW(3,GFNAMES(1,GNUM),4,0,0,ST)
	    CALL IOINIT(FDB,3,DKKSEC*256)
	    IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),1,ST,0)
C
C
	    DO 11020 DRWIND=1,MDRAWS
	        IF(KFLAGS(DRWIND,GIND).EQ.0) GOTO 11020
	        DRAW=DAYHDR(GNUM)-DRWIND+1
	        CALL READW(FDB,DRAW,DKKREC,ST)
	        IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),1,ST,DRAW)
	        IF(DKKUPD.GE.CDC) GOTO 11020
	        DO DIV=1,KIGDIV
	            DKKPAD(DIV)=DKKPAD(DIV)+KPAY(DIV,DRWIND,GIND)
                END DO
	        DKKUPD=CDC
C
C
	        CALL WRITEW(FDB,DRAW,DKKREC,ST)
	        IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),2,ST,DRAW)
11020	    CONTINUE
	    CALL USRCLOS1(3)
11100	CONTINUE

C
C UPDATE SCORE GAME FILES
C
        DO 12100 GIND=1,MAXIND
            GNUM=GTNTAB(TSCR,GIND)
            IF(GNUM.LT.1) GOTO 12100
            IF(DAYHDR(GNUM).LT.1) GOTO 12100
            WRITE(5,902) IAM(),(GFNAMES(K,GNUM),K=1,5)
C
C
            CALL OPENW(3,GFNAMES(1,GNUM),4,0,0,ST)
            CALL IOINIT(FDB,3,DSCSEC*256)
            IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),1,ST,0)
C
C
            DO 12020 DRWIND=1,MDRAWS
                IF(RFLAGS(DRWIND,GIND).EQ.0) GOTO 12020
                DRAW=DAYHDR(GNUM)-DRWIND+1
                CALL READW(FDB,DRAW,DSCREC,ST)
                IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),1,ST,DRAW)
                IF(DSCUPD.GE.CDC) GOTO 12020

                DSCWPR(1,PRPAD) = DSCWPR(1,PRPAD) + RRPAY(DRWIND,1,GIND)
                DSCWPR(2,PRPAD) = DSCWPR(2,PRPAD) + RRPAY(DRWIND,2,GIND)

                DSCWPO(2,PRPAD) = DSCWPO(2,PRPAD) + RPAY(1,DRWIND,GIND)
     *                                            - RPAY(2,DRWIND,GIND)
                DSCWRO(2,PRPAD) = DSCWRO(2,PRPAD) + RPAY(2,DRWIND,GIND)

                DSCPAD = DSCPAD + RPAY(1,DRWIND,GIND)
                DSCPRF = DSCPRF + RPAY(2,DRWIND,GIND)
                DSCUPD=CDC
C
C
                CALL WRITEW(FDB,DRAW,DSCREC,ST)
                IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),2,ST,DRAW)
12020       CONTINUE
            CALL USRCLOS1(3)
12100   CONTINUE
C
C UPDATE WINNERS TIP GAME FILES
C
        DO 13100 GIND=1,MAXIND
            GNUM=GTNTAB(TWIT,GIND)
            IF(GNUM.LT.1) GOTO 13100
            IF(DAYHDR(GNUM).LT.1) GOTO 13100
            WRITE(5,902) IAM(),(GFNAMES(K,GNUM),K=1,5)
C
C
            CALL OPENW(3,GFNAMES(1,GNUM),4,0,0,ST)
            CALL IOINIT(FDB,3,DWISEC*256)
            IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),1,ST,0)
C
C
            DO 13020 DRWIND=1,MDRAWS
                IF(WFLAGS(DRWIND,GIND).EQ.0) GOTO 13020
                DRAW=DAYHDR(GNUM)-DRWIND+1
                CALL READW(FDB,DRAW,DWIREC,ST)
                IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),1,ST,DRAW)
                IF(DWIUPD.GE.CDC) GOTO 13020

                DWIWPR(1,PRPAD) = DWIWPR(1,PRPAD) + WWPAY(DRWIND,1,GIND)
                DWIWPR(2,PRPAD) = DWIWPR(2,PRPAD) + WWPAY(DRWIND,2,GIND)

                DWIWPO(2,PRPAD) = DWIWPO(2,PRPAD) + WPAY(1,DRWIND,GIND)
     *                                            - WPAY(2,DRWIND,GIND)
                DWIWRO(2,PRPAD) = DWIWRO(2,PRPAD) + WPAY(2,DRWIND,GIND)

                DWIPAD=DWIPAD+WPAY(1,DRWIND,GIND)
                DWIPRF=DWIPRF+WPAY(2,DRWIND,GIND)
                DWIUPD=CDC
C
C
                CALL WRITEW(FDB,DRAW,DWIREC,ST)
                IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),2,ST,DRAW)
13020       CONTINUE
            CALL USRCLOS1(3)
13100   CONTINUE
C
C UPDATE TOTO SELECT GAME FILES
C
        DO 14100 GIND=1,MAXIND
            GNUM=GTNTAB(TTSL,GIND)
            IF(GNUM.LT.1) GOTO 14100
            IF(DAYHDR(GNUM).LT.1) GOTO 14100
            WRITE(5,902) IAM(),(GFNAMES(K,GNUM),K=1,5)
C
C
            CALL OPENW(3,GFNAMES(1,GNUM),4,0,0,ST)
            CALL IOINIT(FDB,3,DTSSEC*256)
            IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),1,ST,0)
C
C
            DO 14020 DRWIND=1,MDRAWS
                IF(TFLAGS(DRWIND,GIND).EQ.0) GOTO 14020
                DRAW=DAYHDR(GNUM)-DRWIND+1
                CALL READW(FDB,DRAW,DTSREC,ST)
                IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),1,ST,DRAW)
                IF(DTSUPD.GE.CDC) GOTO 14020

		DO DIV = 1,TSLDIV
		   DTSPBD(DIV,1) = DTSPBD(DIV,1) + TTPAY(DIV,DRWIND,1,GIND)
		   DTSPBD(DIV,2) = DTSPBD(DIV,2) + TTPAY(DIV,DRWIND,2,GIND)
		END DO
C
                DTSPAD=DTSPAD+TPAY(1,DRWIND,GIND)
                DTSPRF=DTSPRF+TPAY(2,DRWIND,GIND)
                DTSUPD=CDC
C
C
                CALL WRITEW(FDB,DRAW,DTSREC,ST)
                IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),2,ST,DRAW)
14020       CONTINUE
            CALL USRCLOS1(3)
14100   CONTINUE
C
C
C UPDATE BINGO GAME FILES
C
        DO 20100 GIND=1,MAXIND
            GNUM=GTNTAB(TBNG,GIND)
            IF(GNUM.LT.1) GOTO 20100
            IF(DAYHDR(GNUM).LT.1) GOTO 20100
            WRITE(5,902) IAM(),(GFNAMES(K,GNUM),K=1,5)
C
C
            CALL OPENW(3,GFNAMES(1,GNUM),4,0,0,ST)
            CALL IOINIT(FDB,3,DBNSEC*256)
            IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),1,ST,0)
C
C
            DO 20020 DRWIND=1,MDRAWS
                IF(BFLAGS(DRWIND,GIND).EQ.0) GOTO 20020
                DRAW=DAYHDR(GNUM)-DRWIND+1
                CALL READW(FDB,DRAW,DBNREC,ST)
                IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),1,ST,DRAW)
                IF(DBNUPD.GE.CDC) GOTO 20020

                DO SUBGAME=1,BGOSUB
                   DO DIV=1,BGODIV
                      DBNPAD(DIV,SUBGAME) = DBNPAD(DIV,SUBGAME) + 
     *                                      BPAY(DIV,SUBGAME,DRWIND,GIND)
                   ENDDO
                ENDDO
                DBNUPD=CDC
C
C
                CALL WRITEW(FDB,DRAW,DBNREC,ST)
                IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),2,ST,DRAW)
20020        CONTINUE
            CALL USRCLOS1(3)
20100    CONTINUE
C
C UPDATE DOUBLE GAME FILES
C
        DO 21100 GIND=1,MAXIND
            GNUM=GTNTAB(TDBL,GIND)
            IF(GNUM.LT.1) GOTO 21100
            IF(DAYHDR(GNUM).LT.1) GOTO 21100
            WRITE(5,902) IAM(),(GFNAMES(K,GNUM),K=1,5)
C
C
            CALL OPENW(3,GFNAMES(1,GNUM),4,0,0,ST)
            CALL IOINIT(FDB,3,DDBSEC*256)
            IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),1,ST,0)
C
C
            DO 21020 DRWIND=1,MDRAWS
                IF(DFLAGS(DRWIND,GIND).EQ.0) GOTO 21020
                DRAW=DAYHDR(GNUM)-DRWIND+1
                CALL READW(FDB,DRAW,DDBREC,ST)
                IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),1,ST,DRAW)
                IF(DDBUPD.GE.CDC) GOTO 21020

                DDBWPR(1,PRPAD) = DDBWPR(1,PRPAD) + DDPAY(DRWIND,1,GIND)
                DDBWPR(2,PRPAD) = DDBWPR(2,PRPAD) + DDPAY(DRWIND,2,GIND)

                DDBWPO(2,PRPAD) = DDBWPO(2,PRPAD) + DPAY(1,DRWIND,GIND)
     *                                            - DPAY(2,DRWIND,GIND)
                DDBWRO(2,PRPAD) = DDBWRO(2,PRPAD) + DPAY(2,DRWIND,GIND)

                DDBPAD = DDBPAD + DPAY(1,DRWIND,GIND)
                DDBPRF = DDBPRF + DPAY(2,DRWIND,GIND)
                DDBUPD = CDC
C
C
                CALL WRITEW(FDB,DRAW,DDBREC,ST)
                IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),2,ST,DRAW)
21020       CONTINUE
            CALL USRCLOS1(3)
21100   CONTINUE
C
C UPDATE COUPLE GAME FILES
C
        DO 22100 GIND=1,MAXIND
            GNUM=GTNTAB(TCPL,GIND)
            IF(GNUM.LT.1) GOTO 22100
            IF(DAYHDR(GNUM).LT.1) GOTO 22100
            WRITE(5,902) IAM(),(GFNAMES(K,GNUM),K=1,5)
C
            CALL OPENW(3,GFNAMES(1,GNUM),4,0,0,ST)
            CALL IOINIT(FDB,3,DCPSEC*256)
            IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),1,ST,0)
C
            DO 22020 DRWIND=1,MDRAWS
                IF(CFLAGS(DRWIND,GIND).EQ.0) GOTO 22020
                DRAW=DAYHDR(GNUM)-DRWIND+1
                CALL READW(FDB,DRAW,DCPREC,ST)
                IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),1,ST,DRAW)
                IF(DCPUPD.GE.CDC) GOTO 22020

                DCPWPR(1,PRPAD) = DCPWPR(1,PRPAD) + CCPAY(DRWIND,1,GIND)
                DCPWPR(2,PRPAD) = DCPWPR(2,PRPAD) + CCPAY(DRWIND,2,GIND)

                DCPWPO(2,PRPAD) = DCPWPO(2,PRPAD) + CPAY(1,DRWIND,GIND)
     *                                            - CPAY(2,DRWIND,GIND)
                DCPWRO(2,PRPAD) = DCPWRO(2,PRPAD) + CPAY(2,DRWIND,GIND)

                DCPPAD = DCPPAD + CPAY(1,DRWIND,GIND)
                DCPPRF = DCPPRF + CPAY(2,DRWIND,GIND)
                DCPUPD = CDC
C
                CALL WRITEW(FDB,DRAW,DCPREC,ST)
                IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),2,ST,DRAW)
22020       CONTINUE
            CALL USRCLOS1(3)
22100   CONTINUE
C
C UPDATE SUPERSCORE GAME FILES
C
        DO 22200 GIND=1,MAXIND
            GNUM=GTNTAB(TSSC,GIND)
            IF(GNUM.LT.1) GOTO 22200
            IF(DAYHDR(GNUM).LT.1) GOTO 22200
            WRITE(5,902) IAM(),(GFNAMES(K,GNUM),K=1,5)
C
C
            CALL OPENW(3,GFNAMES(1,GNUM),4,0,0,ST)
            CALL IOINIT(FDB,3,DSSSEC*256)
            IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),1,ST,0)
C
C
            DO 22220 DRWIND=1,MDRAWS
                IF(UFLAGS(DRWIND,GIND).EQ.0) GOTO 22220
                DRAW=DAYHDR(GNUM)-DRWIND+1
                CALL READW(FDB,DRAW,DSSREC,ST)
                IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),1,ST,DRAW)
                IF(DSSUPD.GE.CDC) GOTO 22220

                DSSWPR(1,PRPAD) = DSSWPR(1,PRPAD) + UUPAY(DRWIND,1,GIND)
                DSSWPR(2,PRPAD) = DSSWPR(2,PRPAD) + UUPAY(DRWIND,2,GIND)

                DSSWPO(2,PRPAD) = DSSWPO(2,PRPAD) + UPAY(1,DRWIND,GIND)
     *                                            - UPAY(2,DRWIND,GIND)
                DSSWRO(2,PRPAD) = DSSWRO(2,PRPAD) + UPAY(2,DRWIND,GIND)

                DSSPAD = DSSPAD + UPAY(1,DRWIND,GIND)
                DSSPRF = DSSPRF + UPAY(2,DRWIND,GIND)
                DSSUPD=CDC
C
                CALL WRITEW(FDB,DRAW,DSSREC,ST)
                IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),2,ST,DRAW)
22220       CONTINUE

            CALL USRCLOS1(3)

22200   CONTINUE
C
C UPDATE TODAY'S TRIO GAME FILES
C
        DO 23100 GIND=1,MAXIND
            GNUM=GTNTAB(TTRP,GIND)
            IF(GNUM.LT.1) GOTO 23100
            IF(DAYHDR(GNUM).LT.1) GOTO 23100
            WRITE(5,902) IAM(),(GFNAMES(K,GNUM),K=1,5)
C
            CALL OPENW(3,GFNAMES(1,GNUM),4,0,0,ST)
            CALL IOINIT(FDB,3,DTRSEC*256)
            IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),1,ST,0)
C
            DO 23020 DRWIND=1,MDRAWS
                IF(IFLAGS(DRWIND,GIND).EQ.0) GOTO 23020
                DRAW=DAYHDR(GNUM)-DRWIND+1
                CALL READW(FDB,DRAW,DTRREC,ST)
                IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),1,ST,DRAW)
                IF(DTRUPD.GE.CDC) GOTO 23020

                DTRWPR(1,PRPAD) = DTRWPR(1,PRPAD) + IIPAY(DRWIND,1,GIND)
                DTRWPR(2,PRPAD) = DTRWPR(2,PRPAD) + IIPAY(DRWIND,2,GIND)

                DTRWPO(2,PRPAD) = DTRWPO(2,PRPAD) + IPAY(1,DRWIND,GIND)
     *                                            - IPAY(2,DRWIND,GIND)
                DTRWRO(2,PRPAD) = DTRWRO(2,PRPAD) + IPAY(2,DRWIND,GIND)

                DTRPAD = DTRPAD + IPAY(1,DRWIND,GIND)
                DTRPRF = DTRPRF + IPAY(2,DRWIND,GIND)
                DTRUPD = CDC
C
                CALL WRITEW(FDB,DRAW,DTRREC,ST)
                IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),2,ST,DRAW)
23020       CONTINUE
            CALL USRCLOS1(3)
23100   CONTINUE
C
C UPDATE SUPER TRIPLE GAME FILES
C
        DO 24100 GIND=1,MAXIND
            GNUM=GTNTAB(TSTR,GIND)
            IF(GNUM.LT.1) GOTO 24100
            IF(DAYHDR(GNUM).LT.1) GOTO 24100
            WRITE(5,902) IAM(),(GFNAMES(K,GNUM),K=1,5)
C
            CALL OPENW(3,GFNAMES(1,GNUM),4,0,0,ST)
            CALL IOINIT(FDB,3,DSTSEC*256)
            IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),1,ST,0)
C
            DO 24020 DRWIND=1,MDRAWS
                IF(STFLAGS(DRWIND,GIND).EQ.0) GOTO 24020
                DRAW=DAYHDR(GNUM)-DRWIND+1
                CALL READW(FDB,DRAW,DSTREC,ST)
                IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),1,ST,DRAW)
                IF(DSTUPD.GE.CDC) GOTO 24020

                DSTWPR(1,PRPAD) = DSTWPR(1,PRPAD) + STRPAY(DRWIND,1,GIND)
                DSTWPR(2,PRPAD) = DSTWPR(2,PRPAD) + STRPAY(DRWIND,2,GIND)

                DSTWPO(2,PRPAD) = DSTWPO(2,PRPAD) + STPAY(1,DRWIND,GIND)
     *                                            - STPAY(2,DRWIND,GIND)
                DSTWRO(2,PRPAD) = DSTWRO(2,PRPAD) + STPAY(2,DRWIND,GIND)

                DSTPAD = DSTPAD + STPAY(1,DRWIND,GIND)
                DSTPRF = DSTPRF + STPAY(2,DRWIND,GIND)
                DSTUPD = CDC
C
                CALL WRITEW(FDB,DRAW,DSTREC,ST)
                IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),2,ST,DRAW)
24020       CONTINUE
            CALL USRCLOS1(3)
24100   CONTINUE
C
	TYPE*,IAM(),' Payoff update complete'
	CALL GSTOP(GEXIT_SUCCESS)
C
900	FORMAT(1X,A,' Updating payoff data for ',7A2)
901	FORMAT(1X,A,1X,A8,I1.1,' Payoff table overflow index> ',I6)
902	FORMAT(1X,A,' Posting payoff data to ',5A4)

	END
