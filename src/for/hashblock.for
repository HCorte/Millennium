C
C SUBROUTINE HASHBLOCK
C $Log:   GXAFXT:[GOLS]HASHBLOCK.FOV  $
C  
C     Rev 1.0   17 Apr 1996 13:31:20   HXK
C  Release of Finland for X.25, Telephone Betting, Instant Pass Thru Phase 1
C  
C     Rev 1.0   21 Jan 1993 16:34:18   DAB
C  Initial Release
C  Based on Netherlands Bible, 12/92, and Comm 1/93 update
C  DEC Baseline
C
C ** Source - hashmem.for **
C
C
C
C****************************************************
C
C JUST HASH INDEX THIS ROUTINE SHOULD BE CHANGED
C TO BE MORE SOFISTICATED
C
C=======OPTIONS /CHECK=NOOVERFLOW
	SUBROUTINE HASHBLOCK(INDEX,BLOCK,TIMES)
	IMPLICIT NONE
C
	INCLUDE 'INCLIB:SYSPARAM.DEF'
	INCLUDE 'INCLIB:SYSEXTRN.DEF'
C
	INCLUDE 'INCLIB:HASHMEM.DEF'
C
	INTEGER*4   INDEX,BLOCK,TIMES
	INTEGER*4   LOCAL
C
C THIS STEP SHOULD BE CHANGED TO INCLUDE INDEX ON SECONDARY HASHING
C
	IF (TIMES.GT.1) THEN
	    BLOCK = BLOCK+1     !COULD BE CHANGED TO REHASHING
	    IF (BLOCK .GT. HASH_NUM_BLOCKS) BLOCK = 1
	    RETURN
	ENDIF
C
	LOCAL = INDEX
	IF (LOCAL.LT.0) LOCAL = -LOCAL
C
	BLOCK = MOD(LOCAL,HASH_NUM_BLOCKS)+1
C
	RETURN
	END
