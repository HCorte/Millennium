C
C SUBROUTINE SCANL
C $Log:   GXAFXT:[GOLS]SCANL.FOV  $
C  
C     Rev 1.0   17 Apr 1996 14:51:20   HXK
C  Release of Finland for X.25, Telephone Betting, Instant Pass Thru Phase 1
C  
C     Rev 1.0   21 Jan 1993 17:34:22   DAB
C  Initial Release
C  Based on Netherlands Bible, 12/92, and Comm 1/93 update
C  DEC Baseline
C
C ** Source - pc_mestrap.for **
C
C
C
C
C=======OPTIONS /CHECK=NOOVERFLOW
	SUBROUTINE SCANL(MESS,TYP,NUM,ST)
	IMPLICIT NONE
C
	INCLUDE 'INCLIB:SYSPARAM.DEF'
	INCLUDE 'INCLIB:SYSEXTRN.DEF'
	INCLUDE 'INCLIB:PCCOM.DEF'
C
	CHARACTER*1 C1(64)
	CHARACTER*64 CH
	CHARACTER*80 MNEM
	INTEGER*4 LMESS(18), MESS(18)
	INTEGER*4 STATUS, DIG, K, PNT, ST, NUM, TYP, FIND
C
	CHARACTER*1 SPACE/' '/
	CHARACTER*1 CR/Z0D/
C
	EQUIVALENCE(LMESS(1),CH,C1)
C
	DATA MNEM(1:1)   /Z04/
	DATA MNEM(2:7)   /'STATUS'/
	DATA MNEM(8:8)   /Z03/
	DATA MNEM(9:12)  /'COMM'/
	DATA MNEM(13:13) /Z02/
	DATA MNEM(14:17) /'TYPE'/
	DATA MNEM(18:18) /Z02/
	DATA MNEM(19:22) /'DRAW'/
	DATA MNEM(23:23) /Z02/
	DATA MNEM(24:27) /'POOL'/
	DATA MNEM(28:28) /Z02/
	DATA MNEM(29:34) /'FUTURE'/
	DATA MNEM(35:35) /Z04/
	DATA MNEM(36:41) /'CONFIG'/
	DATA MNEM(42:42) /Z02/
	DATA MNEM(43:47) /'QUEUE'/
	DATA MNEM(48:48) /Z04/
	DATA MNEM(49:52) /'GTRK'/
	DATA MNEM(53:53) /Z04/
	DATA MNEM(54:57) /'HOURLY'/
	DATA MNEM(58:58) /Z01/
	DATA MNEM(59:62) /'TEST'/   !HAS TO BE LAST
C                                 ;DOES COUNT IN NUMMES
	DATA MNEM(63:63) /Z00/
	DATA MNEM(64:64) /Z00/
C
	DO 5 K=1,18
	  LMESS(K)=MESS(K)
5	CONTINUE
C
	PNT=1
	CALL SCAN(CH,PNT,MNEM,TYP)
	IF(TYP.LE.0) GOTO 500
C
	IF(TYP.EQ.NUMMES+1) TYP=0
C
	DO 10 K=PNT,64
	IF(C1(K).EQ.CR) GOTO 500
	IF(C1(K).EQ.SPACE) GOTO 20
10	CONTINUE
	GOTO 500
20	CONTINUE
	PNT=K
	NUM=0
	DIG=0
	FIND=0
	DO 30 K=PNT+1,64
	IF(C1(K).EQ.SPACE .AND. FIND.EQ.1) GOTO 40
	IF(C1(K).EQ.SPACE .AND. FIND.EQ.0) GOTO 30
	IF(C1(K).EQ.CR) GOTO 40
	CALL ASCBIN(LMESS(1),K,1,DIG,STATUS)
	IF(STATUS.NE.0) GOTO 500
	FIND=1
	NUM=NUM*10+DIG
30	CONTINUE
	GOTO 500
40	CONTINUE
	IF(NUM.LT.0.OR.NUM.GT.1000) GOTO 500
	NUM=NUM*1000
C
	ST=0
	RETURN
C
500	ST=-1
	RETURN
	END
