C
C SUBROUTINE CMDSPE
C $Log:   GXAFXT:[GOLS]CMDSPE.FOV  $
C  
C     Rev 1.0   17 Apr 1996 12:39:04   HXK
C  Release of Finland for X.25, Telephone Betting, Instant Pass Thru Phase 1
C  
C     Rev 1.1   23 Nov 1995 13:10:10   HXK
C  Merge of post 65 stuff; changes for Double/Couple
C  
C     Rev 1.0   21 Jan 1993 15:56:56   DAB
C  Initial Release
C  Based on Netherlands Bible, 12/92, and Comm 1/93 update
C  DEC Baseline
C
C ** Source - cmdspe.for **
C
C CMDSPE.FOR
C
C V01 01-AUG-90 XXX RELEASED FOR VAX
C
C SUBROUTINE TO PROCESS SPECIAL SYSTEM COMMANDS  (NO FREEZE)
C
C
C
C
C+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
C This item is the property of GTECH Corporation, Providence, Rhode
C Island, and contains confidential and trade secret information. It
C may not be transferred from the custody or control of GTECH except
C as authorized in writing by an officer of GTECH. Neither this item
C nor the information it contains may be used, transferred,
C reproduced, published, or disclosed, in whole or in part, and
C directly or indirectly, except as expressly authorized by an
C officer of GTECH, pursuant to written agreement.
C
C Copyright 1991 GTECH Corporation. All rights reserved.
C+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
C
C=======OPTIONS /CHECK=NOOVERFLOW
	SUBROUTINE CMDSPE(TRABUF,MESS)
	IMPLICIT NONE
C
	INCLUDE 'INCLIB:SYSPARAM.DEF'
	INCLUDE 'INCLIB:SYSEXTRN.DEF'
	INCLUDE 'INCLIB:GLOBAL.DEF'
	INCLUDE 'INCLIB:CONCOM.DEF'
	INCLUDE 'INCLIB:DESNET.DEF'
	INCLUDE 'INCLIB:DESTRA.DEF'
	INTEGER*4 MESS(EDLEN), HOUR, WAY, VALUE, NODE, CMDNUM
        INTEGER*4 GAMMAP(2)
C
C
C
	CMDNUM=TRABUF(TCMNUM)
	GOTO (10,20,30,40,50,60,70,80,90,100) CMDNUM
	GOTO 1000
C
C RESYNC
C
10	CONTINUE
	MESS(2)=TENET
	MESS(3)=1
	MESS(8)=TRABUF(TCMDT1)
	MESS(9)=TRABUF(TCMNEW)
	MESS(10)=TRABUF(TCMDT2)
	RETURN
C
C ENABLE RESYNC
C
20	CONTINUE
	NODE=TRABUF(TCMNEW)/100
	VALUE=MOD(TRABUF(TCMNEW),100)
	WAY=TRABUF(TCMDT2)
	TRABUF(TCMOLD)=NETENA(NODE,WAY)
	NETENA(NODE,WAY)=VALUE
	MESS(2)=TENET
	MESS(3)=2
	MESS(8)=NODE
	MESS(9)=TRABUF(TCMOLD)
	MESS(10)=VALUE
	RETURN
C
C CHANGE NETWORK DIAG TIME
C
30	CONTINUE
	TRABUF(TCMOLD)=BROADTIM
	BROADTIM=TRABUF(TCMNEW)
	MESS(2)=TECMD
	MESS(3)=2
	MESS(8)=TRABUF(TCMOLD)
	MESS(9)=TRABUF(TCMNEW)
	RETURN
C
C CHANGE NETWORK MAXBRO TIME
C
40	CONTINUE
	TRABUF(TCMOLD)=MAXBRO
	MAXBRO=TRABUF(TCMNEW)
	MESS(2)=TECMD
	MESS(3)=2
	MESS(8)=TRABUF(TCMOLD)
	MESS(9)=TRABUF(TCMNEW)
	RETURN
C
C BROADCAST TERMINAL MESSAGES
C
50	CONTINUE
	MESS(2)=TECMD
	MESS(3)=5
	MESS(8)=TRABUF(TCMLIN)
	MESS(9)=TRABUF(TCMTER)
	MESS(10)=TRABUF(TCMNEW)
	RETURN
C
C BROADCAST GAME CONTROL CHANGES
C
60	CONTINUE
	MESS(2)=TECMD
	MESS(3)=9
	MESS(8)=TRABUF(TCMOLD)
	MESS(9)=TRABUF(TCMNEW)
        GAMMAP(1)=TRABUF(TCMNEW)
        GAMMAP(2)=TRABUF(TCMDT1)
	CALL SUBCNTRL(GAMMAP,0)
	RETURN
C
C SET HOURLY SALES
C
70	CONTINUE
	HOUR=TRABUF(TCMNEW)
	IF(HOUR.GE.1.AND.HOUR.LE.24) CALL HOURSALE(HOUR)
	MESS(2)=TECMD
	MESS(3)=17
	MESS(8)=HOUR
	RETURN
C
C PUT NEXT SPECIAL COMMAND HERE
C
80	CONTINUE
90	CONTINUE
100	CONTINUE
C
C INVALID COMMAND NUMBER
C
1000	CONTINUE
	TRABUF(TSTAT)=REJT
	TRABUF(TERR)=INVL
	MESS(2)=TECMD
	MESS(3)=1
	MESS(4)=TRABUF(TCMTYP)
	MESS(5)=TRABUF(TCMNUM)
	RETURN
	END
