C
C SUBROUTINE TWIN_POST
C  
C  
C V03 01-FEB-2000 UXN TNFRAC added.
C V02 27-APR-1999 RXK STOPSYS optimization (CARYSCAN is now an array).
C V01 18-OCT-1993 GXA Update sales by division counts.
C  
C
C SUBROUTINE TO TWIN_POST WINSEL SALES DATA
C
C+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
C This item is the property of GTECH Corporation, Providence, Rhode
C Island, and contains confidential and trade secret information. It
C may not be transferred from the custody or control of GTECH except
C as authorized in writing by an officer of GTECH. Neither this item
C nor the information it contains may be used, transferred,
C reproduced, published, or disclosed, in whole or in part, and
C directly or indirectly, except as expressly authorized by an
C officer of GTECH, pursuant to written agreement.
C
C Copyright 2000 GTECH Corporation. All rights reserved.
C+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
C
C=======OPTIONS /CHECK=NOOVERFLOW
	SUBROUTINE TWIN_POST(TRABUF)
	IMPLICIT NONE
C
	INCLUDE 'INCLIB:SYSPARAM.DEF'
	INCLUDE 'INCLIB:SYSEXTRN.DEF'
	INCLUDE 'INCLIB:GLOBAL.DEF'
	INCLUDE 'INCLIB:CONCOM.DEF'
	INCLUDE 'INCLIB:WINCOM.DEF'
	INCLUDE 'INCLIB:DESTRA.DEF'
	INTEGER*4 GIND, DIV
        INTEGER*4 TAB(6,40,5),CMB(5)
	INTEGER*4 SYS, SIMPLE, SELECT,AMT
        LOGICAL FIRST/.TRUE./
C
C
C IF FIRST TIME THE EXPAND SYSTEM BET TABLES
C
        IF(FIRST) THEN
          FIRST=.FALSE.
          CALL TSLSYS(TAB(1,1,1),4,3,CMB(1))
          CALL TSLSYS(TAB(1,1,2),5,3,CMB(2))
          CALL TSLSYS(TAB(1,1,3),6,3,CMB(3))
          CALL TSLSYS(TAB(1,1,4),5,4,CMB(4))
          CALL TSLSYS(TAB(1,1,5),6,4,CMB(5))
        ENDIF
C
	IF(TRABUF(TTYP).NE.TWAG) RETURN
	IF(CARYSCAN(TTSL).AND.TRABUF(TSTAT).EQ.EXCH) GOTO 100
	IF(TRABUF(TSTAT).NE.GOOD) RETURN
C
C
100	CONTINUE
	GIND=TRABUF(TGAMIND)
	IF(TRABUF(TWBEG).GT.LTSDRW(GIND)) RETURN
	IF(TRABUF(TWEND).LT.LTSDRW(GIND)) RETURN
	AMT = TRABUF(TWAMT)
	IF(TRABUF(TFAMTFLG).EQ.1) AMT=AMT/TRABUF(TNFRAC)
	LTSSAL(GIND)=LTSSAL(GIND)+AMT
C
C
	IF(TRABUF(TWSYST).EQ.FULSYS) THEN
          SYS=0
          SIMPLE=TRABUF(TWSYSN)
          SELECT=TRABUF(TWTSEL1)
          IF(SIMPLE.EQ.3.AND.SELECT.EQ.4) SYS=1
          IF(SIMPLE.EQ.3.AND.SELECT.EQ.5) SYS=2
          IF(SIMPLE.EQ.3.AND.SELECT.EQ.6) SYS=3
          IF(SIMPLE.EQ.4.AND.SELECT.EQ.5) SYS=4
          IF(SIMPLE.EQ.4.AND.SELECT.EQ.6) SYS=5
	  DIV=TRABUF(TWSYSN)-2
	  LTSSBD(DIV,2,GIND)=LTSSBD(DIV,2,GIND)+AMT
	  IF(SYS.EQ.0) RETURN
	  LTSSBD(DIV,1,GIND) = LTSSBD(DIV,1,GIND) + CMB(SYS)
	  RETURN
	ENDIF
C
C
	SELECT = TRABUF(TWTSEL1)
	DIV=SELECT-2
	IF(SELECT.EQ.1) DIV = 5
	IF(SELECT.EQ.2) DIV = 6
	LTSSBD(DIV,1,GIND)=LTSSBD(DIV,1,GIND)+1
	AMT = TRABUF(TWTAMT1)
	IF(TRABUF(TFAMTFLG).EQ.1) AMT=AMT/TRABUF(TNFRAC)
	LTSSBD(DIV,2,GIND)=LTSSBD(DIV,2,GIND)+AMT
	IF(TRABUF(TWNBET).EQ.1) RETURN
C
C
	SELECT = TRABUF(TWTSEL2)
	DIV=SELECT-2
	IF(SELECT.EQ.1) DIV = 5
	IF(SELECT.EQ.2) DIV = 6
	LTSSBD(DIV,1,GIND)=LTSSBD(DIV,1,GIND)+1
	AMT = TRABUF(TWTAMT2)
	IF(TRABUF(TFAMTFLG).EQ.1) AMT=AMT/TRABUF(TNFRAC)
	LTSSBD(DIV,2,GIND)=LTSSBD(DIV,2,GIND)+AMT
	IF(TRABUF(TWNBET).EQ.2) RETURN
C
C
	SELECT = TRABUF(TWTSEL3)
	DIV=SELECT-2
	IF(SELECT.EQ.1) DIV = 5
	IF(SELECT.EQ.2) DIV = 6
	LTSSBD(DIV,1,GIND)=LTSSBD(DIV,1,GIND)+1
	AMT = TRABUF(TWTAMT3)
	IF(TRABUF(TFAMTFLG).EQ.1) AMT=AMT/TRABUF(TNFRAC)
	LTSSBD(DIV,2,GIND)=LTSSBD(DIV,2,GIND)+AMT
	RETURN
	END
