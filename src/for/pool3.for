C
C SUBROUTINE POOL3
C $Log:   GXAFXT:[GOLS]POOL3.FOV  $
C  
C     Rev 1.0   17 Apr 1996 14:24:18   HXK
C  Release of Finland for X.25, Telephone Betting, Instant Pass Thru Phase 1
C  
C     Rev 1.0   21 Jan 1993 17:17:38   DAB
C  Initial Release
C  Based on Netherlands Bible, 12/92, and Comm 1/93 update
C  DEC Baseline
C
C ** Source - pool3.for **
C
C POOL3.FOR
C
C V02 01-APR-91 MTK INITIAL RELEASE FOR MARYLAND
C V01 01-AUG-90 XXX RELEASED FOR VAX
C
C
C
C COPYRITF.DEF+++++++++++++++++++++++++++++++++++++++++++++++++++++++
C
C COPYRIGHT 1991 GTECH CORPORATION.  ALL RIGHTS RESERVED.
C
C CONFIDENTIAL PROPRIETARY INFORMATION
C This item is the property of GTECH Corporation, W. Greenwich, Rhode
C Island, and contains confidential and trade secret information.  It
C may not be transferred from the custody or control of GTECH except
C as authorized in writing by an officer of GTECH.  Neither this item
C nor the information it contains may be used, transferred,
C reproduced, published or disclosed, in whold or in part, directly
C or indirectly, except as expressly authorized by an officer of
C GTECH pursuant to written agreement.
C COPYRITF.DEF-------------------------------------------------------
C
C=======OPTIONS /CHECK=NOOVERFLOW
	SUBROUTINE POOL3(GIND)
	IMPLICIT NONE
C
	INCLUDE 'INCLIB:SYSPARAM.DEF'
	INCLUDE 'INCLIB:SYSEXTRN.DEF'
	INCLUDE 'INCLIB:GLOBAL.DEF'
	INCLUDE 'INCLIB:CONCOM.DEF'
	INCLUDE 'INCLIB:POLCOM.DEF'
	INCLUDE 'INCLIB:NBRCOM.DEF'
	INCLUDE 'INCLIB:DATBUF.DEF'
	INTEGER*2 DAT(LDATE_LEN)
	INTEGER*4 GIND, I, J, L, LINE, PAGE, REPCDC, IND1, IND2
	INTEGER*4 STATUS, K
	INTEGER*4 POLAMT(0:10),PTOTAL(7)
	CHARACTER*11 CPOLAMT(0:10)
	CHARACTER*10 PNUMS(4)/' 000 - 399',' 400 - 799',
     *	                      ' 800 - 999','          '/
	CHARACTER*15 PTYPE(7)/'STRAIGHT POOL  ','BOX3 POOL      ',
     *	 'BOX6 POOL      ','FRONT PAIR POOL','SPLIT PAIR POOL',
     *	 'BACK PAIR POOL ','ALL POOLS      '/
C
C
	REPCDC=DAYCDC
	IF(NBRTYP(GIND).NE.NB3TYP) RETURN
        OPEN(UNIT=6, FILE='POOL3.REP', STATUS='NEW',
     *      IOSTAT=STATUS, SHARED, DISP='PRINT/DELETE')
        IF(STATUS.NE.0) RETURN
	PAGE=0
	LINE=0
	DO 50 I=1,7
	PTOTAL(I)=0
50	CONTINUE
	DAT(VCDC)=DAYCDC
	CALL LCDATE(DAT)
C
C     STRAIGHT POOL
C
	CALL TITLE('3-DIGIT POOL REPORT','POOL3   ',1,6,PAGE,REPCDC)
	WRITE(6,908)(DAT(I),I=7,13)
	WRITE(6,923)PTYPE(1),PNUMS(PAGE)
	WRITE(6,920)(I,I=0,9)
	DO 120 J=0,9
	  DO 110 K=0,9
	    DO 100 L=0,9
	      CALL VNUMOD(J*100+K*10+L,TNB3ST,NB3TYP,IND1,IND2)
	      POLAMT(L)=POOLT(IND2,1,GIND)*NBRPRC(GIND)
	      PTOTAL(1)=PTOTAL(1)+POLAMT(L)
100	    CONTINUE
	    WRITE(6,925)J,K,(CMONY(POLAMT(I),11,BETUNIT),I=0,9)
	    LINE=LINE+1
	    IF(LINE.GE.40)THEN
	      CALL TITLE('3-DIGIT POOL REPORT','POOL3   ',1,6,PAGE,
     *	                 REPCDC)
	      WRITE(6,908)(DAT(I),I=7,13)
	      WRITE(6,923)PTYPE(1),PNUMS(PAGE)
	      WRITE(6,920)(I,I=0,9)
	      LINE=0
	    ENDIF
110	  CONTINUE
	  IF(LINE.NE.0)WRITE(6,901)
120	CONTINUE
	WRITE(6,942)PTYPE(1),CMONY(PTOTAL(1),11,BETUNIT)
C
C     BOX3 POOL
C
	CALL TITLE('3-DIGIT POOL REPORT','POOL3   ',1,6,PAGE,REPCDC)
	WRITE(6,908)(DAT(I),I=7,13)
	WRITE(6,923)PTYPE(2)
	WRITE(6,920)(I,I=0,9)
	DO 220 J=0,9
	  DO 200 I=0,9
	    CPOLAMT(I)='          *'
200	  CONTINUE
	  DO 210 K=0,9
	    IF(K.EQ.J)GOTO 210
	      CALL VNUMOD(J*110+K,TNB3B3,NB3TYP,IND1,IND2)
	      POLAMT(K)=POOLT(IND1,1,GIND)*NBRPRC(GIND)
	      PTOTAL(2)=PTOTAL(2)+POLAMT(K)
	      WRITE (CPOLAMT(K),956) CMONY(POLAMT(K),11,BETUNIT)
210	  CONTINUE
	  WRITE(6,955) J,J,(CPOLAMT(I),I=0,9)
220	CONTINUE
	WRITE(6,942)PTYPE(2),CMONY(PTOTAL(2),11,BETUNIT)
C
C     BOX6 POOL
C
	CALL TITLE('3-DIGIT POOL REPORT','POOL3   ',1,6,PAGE,REPCDC)
	WRITE(6,908)(DAT(I),I=7,13)
	WRITE(6,923)PTYPE(3)
	WRITE(6,920)(I,I=0,9)
	DO 330 J=0,7
	  DO 320 K=J+1,8
	    DO 300 I=0,9
	      CPOLAMT(I)='          *'
300	    CONTINUE
	    DO 310 L=K+1,9
	     CALL VNUMOD(J*100+K*10+L,TNB3B6,NB3TYP,IND1,IND2)
	     POLAMT(L)=POOLT(IND1,1,GIND)*NBRPRC(GIND)
	     PTOTAL(3)=PTOTAL(3)+POLAMT(L)
	     WRITE (CPOLAMT(L),956) CMONY(POLAMT(L),11,BETUNIT)
310	    CONTINUE
	    WRITE(6,955)J,K,(CPOLAMT(I),I=0,9)
320	  CONTINUE
330	CONTINUE
	WRITE(6,942)PTYPE(3),CMONY(PTOTAL(3),11,BETUNIT)
C
C     FRONT POOL
C
	CALL TITLE('3-DIGIT POOL REPORT','POOL3   ',1,6,PAGE,REPCDC)
	WRITE(6,908)(DAT(I),I=7,13)
	WRITE(6,923)PTYPE(4)
	WRITE(6,920)(I,I=0,9)
	DO 410 J=0,9
	  DO 400 K=0,9
	    CALL VNUMOD(J*10+K,TNB3F2,NB3TYP,IND1,IND2)
	    POLAMT(K)=POOLT(IND2,1,GIND)*NBRPRC(GIND)
	    PTOTAL(4)=PTOTAL(4)+POLAMT(K)
400	  CONTINUE
	  WRITE(6,930)J,(CMONY(POLAMT(I),11,BETUNIT),I=0,9)
410	CONTINUE
	WRITE(6,942)PTYPE(4),CMONY(PTOTAL(4),11,BETUNIT)
C
C     SPLIT POOL
C
	WRITE(6,923)PTYPE(5)
	WRITE(6,920)(I,I=0,9)
	DO 510 J=0,9
	  DO 500 K=0,9
	    CALL VNUMOD(J*10+K,TNB3S2,NB3TYP,IND1,IND2)
	    POLAMT(K)=POOLT(IND2,1,GIND)*NBRPRC(GIND)
	    PTOTAL(5)=PTOTAL(5)+POLAMT(K)
500	  CONTINUE
	  WRITE(6,935)J,(CMONY(POLAMT(I),11,BETUNIT),I=0,9)
510	CONTINUE
	WRITE(6,942)PTYPE(5),CMONY(PTOTAL(5),11,BETUNIT)
C
C     BACK POOL
C
	WRITE(6,923)PTYPE(6)
	WRITE(6,920)(I,I=0,9)
	DO 610 J=0,9
	  DO 600 K=0,9
	    CALL VNUMOD(J*10+K,TNB3B2,NB3TYP,IND1,IND2)
	    POLAMT(K)=POOLT(IND2,1,GIND)*NBRPRC(GIND)
	    PTOTAL(6)=PTOTAL(6)+POLAMT(K)
600	  CONTINUE
	  WRITE(6,940)J,(CMONY(POLAMT(I),11,BETUNIT),I=0,9)
610	CONTINUE
   	WRITE(6,942)PTYPE(6),CMONY(PTOTAL(6),11,BETUNIT)
C
C     TOTALS
C
	CALL TITLE('3-DIGIT POOL REPORT','POOL3   ',1,6,PAGE,REPCDC)
	WRITE(6,908)(DAT(I),I=7,13)
	DO 700 I=1,7
	  WRITE(6,942)PTYPE(I),CMONY(PTOTAL(I),11,BETUNIT)
	  PTOTAL(7)=PTOTAL(7)+PTOTAL(I)
700	CONTINUE
	CLOSE(6)
	RETURN
C
C
C
C     FORMAT AREA
C
901	FORMAT(/)
908	FORMAT(/,T60,'For ',7A2,/)
920	FORMAT(5X,'NUMBERS',10X,10(I1,10X),/)
923	FORMAT(//,5X,'LAST CLOSE - ',A15,:,A10)
925	FORMAT(5X,2I1,'-',4X,10(A11))
930	FORMAT(5X,I1,'-X',4X,10(A11))
935	FORMAT(5X,I1,'X-',4X,10(A11))
940	FORMAT(5X,'X',I1,'-',4X,10(A11))
942	FORMAT(5X,'TOTAL - ',A15,1X,A20)
955	FORMAT(5X,2I1,'-',4X,10(A11))
956	FORMAT(A11)
	END
