C
C SUBROUTINE FLUOVR
C $Log:   GXAFXT:[GOLS]FLUOVR.FOV  $
C  
C     Rev 1.0   17 Apr 1996 13:11:44   HXK
C  Release of Finland for X.25, Telephone Betting, Instant Pass Thru Phase 1
C  
C     Rev 1.0   21 Jan 1993 16:19:22   DAB
C  Initial Release
C  Based on Netherlands Bible, 12/92, and Comm 1/93 update
C  DEC Baseline
C
C ** Source - poolupd.for **
C
C====================================================================
C    SUBROUTINE FLUOVR(GAM)-FLUSH THE OVERFLOW QUEUE TO FILE
C
C    CALL SEQUENCE:   CALL FLUOVR(GAM)
C
C V02	JUST A COMMENT: THIS ROUTINE OPENS OVERFLOWS FILE AND IT STAYS OPEN
C V02   FOR THE LIFE OF THE PROCESS...
C
C=======OPTIONS /CHECK=NOOVERFLOW
	SUBROUTINE FLUOVR(GAM)
	IMPLICIT NONE
C
	INCLUDE 'INCLIB:SYSPARAM.DEF'
	INCLUDE 'INCLIB:SYSEXTRN.DEF'
C
	INCLUDE 'INCLIB:GLOBAL.DEF'
	INCLUDE 'INCLIB:CONCOM.DEF'
	INCLUDE 'INCLIB:POOLLTO.DEF'
C
	INTEGER*4 FDB(7)            !FDB BLOCK FOR WRITE
	INTEGER*4 ONCE/0/           !OPEN FLAG
	INTEGER*4 ST, GAM
C
	IF (ONCE.EQ.0) THEN
	  CALL OPENW(1,SFNAMES(1,LO1),4,0,0,ST)   !OPEN OVERFLOW FILE
	  IF (ST.NE.0) THEN
	    TYPE *,IAM(),'Disable pool update (SUPPUD) in SYS snapshot.'
	    CALL FILERR(SFNAMES(1,LO1),1,ST,0)
	    GOTO 30
	  ENDIF
	  CALL IOINIT(FDB,1,MAXOVR*8/256*256)     !INITIALISE FOR I/O
	  ONCE=-1
	ENDIF
C
C
C     WRITE TO FAST:POOLOVR.FIL      ;WRITE OVERFLOWS TO FILE
C
	LTOVR(1,MAXOVR,GAM)=GAM
	CALL WRITEW(FDB,OVRBLK+1,LTOVR(1,1,GAM),ST)
	IF (ST.NE.0) THEN
	    TYPE *,IAM(),'Disable pool update (SUPPUD) in SYS snapshot.'
	    CALL FILERR(SFNAMES(1,LO1),3,ST,OVRBLK+1)
	    GOTO 30
	ENDIF
	OVRBLK=OVRBLK+1
C
C***  CALL CLOSEFIL(FDB)
C
C     INITIALISE OVERFLOWS BLOCK
C
30	CONTINUE
	CALL FASTSET(0,LTOVR(1,1,GAM),MAXOVR*2)
	LTLSTOVR(GAM)=0
	RETURN
	END
