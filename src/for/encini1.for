C
C SUBROUTINE ENCINI1
C $Log:   GXAFXT:[GOLS]ENCINI1.FOV  $
C  
C     Rev 1.0   17 Apr 1996 13:04:28   HXK
C  Release of Finland for X.25, Telephone Betting, Instant Pass Thru Phase 1
C  
C     Rev 1.0   21 Jan 1993 16:12:52   DAB
C  Initial Release
C  Based on Netherlands Bible, 12/92, and Comm 1/93 update
C  DEC Baseline
C
C ** Source - encini.for **
C
C
C
C     SET ENCRYPTION KEY
C
C     ENCINI1(PASS,TER)
C     IN - PASS - TAERMINAL PASS #
C          TER - TERMINAL #
C=======OPTIONS /CHECK=NOOVERFLOW
	SUBROUTINE ENCINI1(PASS,TER)
	IMPLICIT NONE
C
	INCLUDE 'INCLIB:SYSPARAM.DEF'
	INCLUDE 'INCLIB:SYSEXTRN.DEF'
	INCLUDE 'INCLIB:GLOBAL.DEF'
	INCLUDE 'INCLIB:AGTCOM.DEF'
	INCLUDE 'INCLIB:PRMPRO.DEF'
	INCLUDE 'INCLIB:ENCCOM.DEF'
C
	INTEGER*4 BASE/Z69696969/
	INTEGER*4 KEY, PASN, TER, PASS, M, K, I
        INTEGER*4 TEMP(2)
        INTEGER*4 HALF_KEYTAB(2,NUMAGT) !GPW DUMMY TO AVOID COMPIL.ERR.
C
	PASN=MOD(PASS,10000)
	CALL BINASC(KEY,1,4,PASN)
	TEMP(1)=KEY
	TEMP(2)=BASE-KEY
	TEMP(1)=ISHFT(TEMP(1),1)
	TEMP(2)=ISHFT(TEMP(2),1)
        CALL ENCSWAP(TEMP)
        KEYTAB(1,TER)=TEMP(1)
        KEYTAB(2,TER)=TEMP(2)
	M = 0
        HALF_KEYTAB(1,TER)=TEMP(1)
        HALF_KEYTAB(2,TER)=TEMP(2)
      	DO 50 I = 1, 2
      	      DO 30 K = 0, 31
      	       IF (BTEST(KEYTAB(I,TER),K)) THEN
      		  M = M + 1
      		  IF (MOD(M,2) .EQ. 1)
     *			  HALF_KEYTAB(I,TER)=IBCLR(HALF_KEYTAB(I,TER),K)
		  ENDIF
30  	      CONTINUE
	      HALF_KEYTAB(I,TER)=ISHFTC(HALF_KEYTAB(I,TER),7,32)
50  	  CONTINUE
C
	RETURN
	END
