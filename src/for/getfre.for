C
C SUBROUTINE GETFRE
C $Log:   GXAFXT:[GOLS]GETFRE.FOV  $
C  
C     Rev 1.0   17 Apr 1996 13:20:02   HXK
C  Release of Finland for X.25, Telephone Betting, Instant Pass Thru Phase 1
C  
C     Rev 1.0   21 Jan 1993 16:25:34   DAB
C  Initial Release
C  Based on Netherlands Bible, 12/92, and Comm 1/93 update
C  DEC Baseline
C
C ** Source - msgsub.for **
C
C
C
C *** GETFRE: GET A FREE SEGMENT
C
C
C SETS MSGNUM=0 IF NO SEGMENTS LEFT
C
C
C=======OPTIONS /CHECK=NOOVERFLOW
	SUBROUTINE GETFRE(MSGNUM)
	IMPLICIT NONE
C
	INCLUDE 'INCLIB:SYSPARAM.DEF'
	INCLUDE 'INCLIB:SYSEXTRN.DEF'
C
	INCLUDE 'INCLIB:MSGCOM.DEF'
C
	INTEGER*4 K, MSGNUM
C
C
	MSGNUM=I4MSGTAB(MFRLNK,MSGCTL)     !OBTAIN FREE SEGMENT
	IF(MSGNUM.GT.0)THEN
	  I4MSGTAB(MFRLNK,MSGCTL)=I4MSGTAB(MFRLNK,MSGNUM)     !ADJUST LIST
	  I4MSGTAB(MFRCNT,MSGCTL)=I4MSGTAB(MFRCNT,MSGCTL)-1   !INC COUNT
	  I4MSGTAB(SEGLEN,MSGNUM)=0
	  I4MSGTAB(MSGLNK,MSGNUM)=0
	  DO 1100 K=1,MSGLST/4
	    I4MSGTAB(K,MSGNUM)=0
1100	  CONTINUE
	ENDIF
	RETURN
	END
