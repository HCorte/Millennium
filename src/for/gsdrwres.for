C
C     FILE   : GSDRWRES.FOR
C     AUTHOR : J.H.R
C     VERSION: 01            DATE: 12 / 02 / 2001
C
C
C V10 10-MAY-2017 HXK Modified S14 change from 01M to 1X2
C V04 30-MAR-2015 MTK Modified Super 14 game
C V03 07-DEC-2010 FRP Lotto2 Changes
C V02 15-DEC-2003 FRP Modify for Batch2 Totobola Changes.
C V01 JHR INITIAL RELEASE FOR PORTUGAL PROJECT
C
C GSALES DRAW RESULTS, THIS PROGRAM RUNS GSALES LOADER FOR DRAW RESULTS
C ( GENERAL INFORMATION ABOUT DRAWS WINNING RESULTS )
C
C     **************************************************************************
C
C        THIS ITEM IS THE PROPERTY OF GTECH CORPORATION, POVIDENCE, RHODE
C     ISLAND, AND CONTAINS CONFIDENTIAL AND TRADE SECRET INFORMATION. IT MAY
C     NOT BE TRANSFERRED FROM THE CUSTODY OR CONTROL OF GTECH EXCEPT AS AUTO -
C     RIZED IN WRITING BY AN OFFICER OF GTECH. NEITHER THIS ITEM NOR THE
C     INFORMATION IT CONTAINS MAY BE USED, TRANSFERRED, REPRODUCED, PUBLISHED
C     OR DISCLOSED, IN WHOLE OR IN PART, AND DIRECTLY OR INDIRECTLY, EXCEPT AS
C     EXPRESSLY AUTHORIZED BY AN OFFICER OR GTECH, PURSUANT TO WRITTEN AGREEMENT
C
C     Copyright 2000 GTECH Corporation. All Rigth Reserved
C
C     **************************************************************************
C
C THIS PROGRAM RUNS GSALES LOADER FOR DRAWS RESULTS
C
C=======OPTIONS /CHECK = NOOVERFLOW /EXT
      PROGRAM GSDRWRES
      IMPLICIT NONE
C
C INCLUDES DEFINITION TO RUN GSALES LOADER FOR DRAWS RESULTS
C
      INCLUDE 'INCLIB:SYSPARAM.DEF'
      INCLUDE 'INCLIB:SYSEXTRN.DEF'
      INCLUDE 'INCLIB:GLOBAL.DEF'
      INCLUDE 'INCLIB:CONCOM.DEF'
      INCLUDE 'INCLIB:GSALES.DEF'
      INCLUDE 'INCLIB:STOPCOM.DEF'
C
C CONSTANT PARAMETERS TO RUN GSALES LOADER FOR DRAWS RESULTS
C
      INTEGER * 4 VERSION             ! DRAWS RESULTS FILE LOADER VERSION
C
C INITIATE CONSTANT PARAMETERS TO RUN GSALES LOADER FOR DRAWS RESULTS
C
      PARAMETER(VERSION = 1)          ! DRAWS RESULTS FILE LOADER VERSION
C
C VARIABLES DEFINITION TO RUN GSALES LOADER FOR DRAWS RESULTS
C
      INTEGER * 4 GNUM                ! GAME NUMBER
      INTEGER * 4 GIND                ! GAME INDEX
      INTEGER * 4 GTYP                ! GAME TYPE
C
      CHARACTER * 25 FILENAME         ! FILE NAME
C
C INITIATE VARIABLES TO RUN GSALES LOADER FOR DRAWS RESULTS
C
      FILRECCNT = 0
C
C DISPLAY USER INFORMATION ( RUNNING GSALES DRAWS RESULTS LOADER )
C
      CALL COPYRITE
      TYPE *, IAM()
      TYPE *, IAM(), 'Running Gsales Draws Results Loader'
      TYPE *, IAM()
C
C GET GSALES DRAWS RESULTS FILE NAME YYYYMMDD_DRAWDIV.FIL
C
      WRITE(FILENAME, 100) GET_YYYYMMDD_CDC(DAYCDC)
C
C IF DRAWS RESULTS FILE EXIST, DELETE IT
C
      CALL DELETE_FILE_NAME(FILENAME)
C
C GET FREE IDENTIFICATION FILE NUMBER
C
      IDFIL = GET_FREE_IDFIL(0)
C
C OPEN YYYYMMDD_DRAWRES.FIL ( ASCII FILE, ALTHOUGH IT'S EXTENSION IS '.FIL' )
C
      CALL OPEN_FILE_NAME(IDFIL, FILENAME)
C
C WRITE DRAWS RESULTS LOADER HEADER
C
      CALL GSHEADER(VERSION)
C
C LOOP TO GET ACTIVE GAMES AND WRITE INFORMATION IN FILE
C
      DO 1000 GNUM = 1, MAXGAM
C
C GET GAME TYPE AND GAME INDEX, IF IT'S NOT ACTIVE GAME, GO TO CHECK NEXT GAME
C
        GTYP = GNTTAB(GAMTYP, GNUM)
        GIND = GNTTAB(GAMIDX, GNUM)
        IF(GTYP .LT. 1 .OR. GTYP .GT. MAXTYP) GOTO 1000
        IF(GIND .LT. 1 .OR. GIND .GT. MAXIND) GOTO 1000
C
C CHECK IF IS TODAY WINSEL DAY FOR SELECTED GAME
C
        IF(GSALES_AUTO(GNUM) .EQ. 0) GOTO 1000
C
C PRINT DRAW RESULT TRANSACTION FOR SELECTED GAME
C
        IF(GTYP .EQ. TKIK) CALL PRINT_JOKER_DRAW_RESULTS(GNUM)
        IF(GTYP .EQ. TLTO) CALL PRINT_LOTTO_DRAW_RESULTS(GNUM)
        IF(GTYP .EQ. TSPT) CALL PRINT_SPORTS_DRAW_RESULTS(GNUM)
        IF(GTYP .EQ. TTGL) CALL PRINT_RESULTS_DRAW_RESULTS(GNUM)
        IF(GTYP .EQ. TPAS) CALL PRINT_PASSIVE_DRAW_RESULTS(GNUM)
C
C END OF LOOP TO GET ACTIVE GAMES AND WRITE INFORMATION IN FILE
C
1000    CONTINUE
C
C PRINT FOOTER AND CLOSE YYYYDDMM_DRAWRES.FIL FILE
C
      CALL GSFOOTER
      CALL USRCLOS1(IDFIL)
C
C DISPLAY MESSAGE TO USER
C
      TYPE *, IAM()
      TYPE *, IAM(), 'Generated Draws Results GSales File: ', FILENAME
      TYPE *, IAM()
C
C CREATE GSALES END FILE ( TO GSALES MEANS END OF PROCEDURE )
C
      WRITE(FILENAME, 200) GET_YYYYMMDD_CDC(DAYCDC)
      CALL CREATE_GSALES_END_FILE(FILENAME)
C
C GSALES DRAW RESULTS LOADER ENDS OK
C
      CALL GSTOP(GEXIT_SUCCESS)
C
C FORMATS DEFINITION TO RUN GSALES LOADER FOR DRAWS RESULTS
C
100   FORMAT('valx:', A8, '_drawres.fil')
200   FORMAT('valx:', A8, '_drawres.fin')
C
C THIS IS THE END TO RUN GSALES LOADER FOR DRAWS RESULTS
C
       END


C ******************************************************************************
C
C     SUBROUTINE: PRINT_DRAW_RESULT
C     AUTHOR    : J.H.R
C     VERSION   : 01            DATE: 13 / 02 / 2001
C
C ******************************************************************************
C
C FUNCTION TO PRINT DRAW RESULT GSALES LOADER INFORMATION
C
C=======OPTIONS /CHECK = NOOVERFLOW /EXT
      SUBROUTINE PRINT_DRAW_RESULT(GNUM, SQCNUM, SQCNAME, SQCVAL)
      IMPLICIT NONE
C
C INCLUDES DEFINITION TO PRINT DRAW RESULT GSALES LOADER INFORMATION
C
      INCLUDE 'INCLIB:GLOBAL.DEF'
      INCLUDE 'INCLIB:CONCOM.DEF'
      INCLUDE 'INCLIB:GSALES.DEF'
      INCLUDE 'INCLIB:STOPCOM.DEF'
C
C PARAMETERS DEFINITION TO PRINT DRAW RESULT GSALES LOADER INFORMATION
C
      INTEGER * 4 GNUM              ! GAME NUMBER
      INTEGER * 4 SQCNUM            ! SECUENCE NUMBER
C
      CHARACTER * 20 SQCNAME        ! SECUENCE NAME
      CHARACTER * 20 SQCVAL         ! SECUENCE VALUE
C
C VARIABLES DEFINITION TO PRINT DRAW RESULT GSALES LOADER INFORMATION
C
      INTEGER * 4 TRNGTYPE          ! TRANSACTION GAME TYPE
      INTEGER * 4 DRAW              ! DRAW NUMBER
C
C SET TRANSACTION GAME TYPE ( 1: PASSIVE, 2: ON LINE )
C
      TRNGTYPE = 2
      IF(GNTTAB(GAMTYP, GNUM) .EQ. TPAS) TRNGTYPE = 1
C
C SET DRAW NUMBER
C
      DRAW = GSALES_AUTO(GNUM)
C
C SET INFORMATION TO FILE REGISTER
C
        WRITE(FILREC, 100)
     *
     *                     TRNGTYPE,          ! GAME TYPE
     *                     GNUM,              ! GAME NUMBER
     *                     DRAW,              ! DRAW NUMBER
     *                     SQCNUM,            ! SEQUENCE NUMBER
     *                     SQCNAME,           ! SECUENCE NAME
     *                     SQCVAL             ! SECUENCE VALUE
C
      FILRECLNG = 1 + 2 + 6 + 2 + 20 + 20 
C
C WRITE INFORMATION TO GSALES LOADER FILE AND SET NUMBER OF RECORDS WRITTEN
C
      WRITE(IDFIL, 200) FILREC(1:FILRECLNG)
      FILRECCNT = FILRECCNT + 1
C
C FORMATS DEFINITION TO PRINT DRAW RESULT GSALES LOADER INFORMATION
C
100   FORMAT(I1.1, I2.2, I6.6, I2.2, A20, A20)
200   FORMAT(A)
C
C THIS IS THE END TO PRINT DRAW RESULT GSALES LOADER INFORMATION
C
      END

C ******************************************************************************
C
C     SUBROUTINE: PRINT_LOTTO_DRAW_RESULT
C     AUTHOR    : J.H.R
C     VERSION   : 01            DATE: 13 / 02 / 2001
C
C ******************************************************************************
C
C FUNCTION TO PRINT LOTTO DRAW RESULTS GSALES LOADER
C
C=======OPTIONS /CHECK = NOOVERFLOW /EXT
      SUBROUTINE PRINT_LOTTO_DRAW_RESULTS(GNUM)
      IMPLICIT NONE
C
C INCLUDES DEFINITION TO PRINT LOTTO DRAW RESULTS
C
      INCLUDE 'INCLIB:SYSPARAM.DEF'
      INCLUDE 'INCLIB:SYSEXTRN.DEF'
      INCLUDE 'INCLIB:GLOBAL.DEF'
      INCLUDE 'INCLIB:GSALES.DEF'
      INCLUDE 'INCLIB:DLTREC.DEF'
      INCLUDE 'INCLIB:STOPCOM.DEF'
C
C PARAMETERS DEFINITION TO PRINT LOTTO DRAW RESULTS
C
      INTEGER * 4 GNUM              ! GAME NUMBER
C
C VARIABLES DEFINITION TO PRINT LOTTO DRAW RESULTS
C
      INTEGER * 4 CNTA              ! COUNTER A
      INTEGER * 4 GAMIDFIL          ! GAME IDENTIFICATION FILE
      INTEGER * 4 FDB(7)            ! FILE DESCRIPTOR BLOCK
C
      CHARACTER * 20 SQCNAM         ! SECUENCE NAME
      CHARACTER * 20 SQCVAL         ! SECUENCE VALUE
C
C GET FREE LUN FOR LOTTO DRAW FILE AND OPEN IT 
C
      GAMIDFIL = GET_FREE_IDFIL(1)
      CALL OPEN_SYS_FILE(GAMIDFIL, GAMFIL, GNUM)
      CALL IOINIT(FDB, GAMIDFIL, DLTSEC * 256)
C
C READ DRAW INFORMATION FROM LOTTO GAME FILE
C
      CALL READ_DRAW_FILE(GSALES_AUTO(GNUM), GNUM, FDB, DLTREC)
C
C LOOP TO GET WINNING NUMBERS AND PRINT INFORMATION IN GSALES LOADER
C
      DO CNTA = 1, DLTNUM
        WRITE(SQCNAM, 100) CNTA, DLTNUM
        WRITE(SQCVAL, 200) DLTWIN(CNTA, 1)   
        CALL PRINT_DRAW_RESULT(GNUM, CNTA, SQCNAM, SQCVAL)
      ENDDO
C
C LOOP TO GET WINNING NUMBERS FOR BONUS AND PRINT INFORMATION IN GSALES LOADER
C
      DO CNTA = 1, DLTBFL
        WRITE(SQCNAM, 300) CNTA, DLTBFL
        WRITE(SQCVAL, 200) DLTBNM(CNTA, 1)   
        CALL PRINT_DRAW_RESULT(GNUM, CNTA + DLTNUM, SQCNAM, SQCVAL)
      ENDDO
C
C LOOP TO GET WINNING NUMBERS FOR LUCKY AND PRINT INFORMATION IN GSALES LOADER
C
      IF(DLTLFL .GT. 0) THEN
        CNTA = 1
        WRITE(SQCNAM, 400) CNTA, CNTA
        WRITE(SQCVAL, 200) DLTLNM(1)   
        CALL PRINT_DRAW_RESULT(GNUM, CNTA + DLTNUM + DLTBFL, SQCNAM, SQCVAL)
      ENDIF
C
C CLOSE LOTTO DRAW FILE 
C
      CALL CLOSEFIL(FDB)
C
C FORMATS DEFINITION TO PRINT LOTTO DRAW RESULTS
C
100   FORMAT('Lotto Ball ', I2.2 '/', I2.2, 4(' '))
200   FORMAT(I2.2, 18(' '))
300   FORMAT('Lotto Bonus ' , I2.2 '/', I2.2, 3(' '))
400   FORMAT('Lotto Lucky ' , I2.2 '/', I2.2, 3(' '))
C
C THIS IS THE END TO PRINT LOTTO DRAW RESULTS
C
      END


C ******************************************************************************
C
C     SUBROUTINE: PRINT_SPORTS_DRAW_RESULT
C     AUTHOR    : J.H.R
C     VERSION   : 01            DATE: 13 / 02 / 2001
C
C ******************************************************************************
C
C FUNCTION TO PRINT SPORTS DRAW RESULTS GSALES LOADER
C
C=======OPTIONS /CHECK = NOOVERFLOW /EXT
      SUBROUTINE PRINT_SPORTS_DRAW_RESULTS(GNUM)
      IMPLICIT NONE
C
C INCLUDES DEFINITION TO PRINT SPORTS DRAW RESULTS
C
      INCLUDE 'INCLIB:SYSPARAM.DEF'
      INCLUDE 'INCLIB:SYSEXTRN.DEF'
      INCLUDE 'INCLIB:GLOBAL.DEF'
      INCLUDE 'INCLIB:GSALES.DEF'
      INCLUDE 'INCLIB:DSPREC.DEF'
      INCLUDE 'INCLIB:STOPCOM.DEF'
C
C PARAMETERS DEFINITION TO PRINT SPORTS DRAW RESULTS
C
      INTEGER * 4 GNUM              ! GAME NUMBER
      INTEGER * 4 BCNT              ! BONUS ROW COUNT
C
C VARIABLES DEFINITION TO PRINT SPORTS DRAW RESULTS
C
      INTEGER * 4 CNTA              ! COUNTER A
      INTEGER * 4 CNTB              ! COUNTER B
      INTEGER * 4 CNTC              ! COUNTER C
      INTEGER * 4 GAMIDFIL          ! GAME IDENTIFICATION FILE
      INTEGER * 4 FDB(7)            ! FILE DESCRIPTOR BLOCK
      INTEGER * 4 SCORE(2)          ! SUPER14 WINNING RESULTS
C
      CHARACTER * 20 SQCNAM         ! SECUENCE NAME
      CHARACTER * 20 SQCVAL         ! SECUENCE VALUE
      CHARACTER * 01 SPTWINTBL(0:4) ! SPORT WINNING TABLE
      CHARACTER * 01 TGLWINTBL(0:4) ! SUPER14 WINNING TABLE
C
C INITIATE VARIABLES TO PRINT SPORTS DRAW RESULTS
C
      DATA SPTWINTBL  / '-', '1', 'X', 'C', '2' /
      DATA TGLWINTBL  / '-', '0', '1', 'C', 'M'/
C
C GET FREE LUN FOR SPORTS DRAW FILE AND OPEN IT
C
      GAMIDFIL = GET_FREE_IDFIL(1)
      CALL OPEN_SYS_FILE(GAMIDFIL, GAMFIL, GNUM)
      CALL IOINIT(FDB, GAMIDFIL, DSPSEC * 256)
C
C READ DRAW INFORMATION FROM SPORTS GAME FILE
C
      CALL READ_DRAW_FILE(GSALES_AUTO(GNUM), GNUM, FDB, DSPREC)
C
C LOOP TO GET WINNING NUMBERS AND PRINT INFORMATION IN GSALES LOADER
C
      BCNT = 0
      IF(DSPFRG.NE.0) BCNT = 1
      DO CNTA = 1, DSPMAX - BCNT    !number of sport rows
        WRITE(SQCNAM, 100) CNTA, DSPMAX
        WRITE(SQCVAL, 200) SPTWINTBL(DSPWIN(CNTA))
        CALL PRINT_DRAW_RESULT(GNUM, CNTA, SQCNAM, SQCVAL)
      ENDDO
C
C
      CNTB = DSPMAX
      IF(DSPFRG.EQ.1) THEN
        SCORE(1)=ISHFT(DSPWIN(DSPMAX),-4)
        SCORE(2)=IAND(DSPWIN(DSPMAX),'0F'X)
        WRITE(SQCNAM, 100) CNTB, DSPMAX
        WRITE(SQCVAL, 300) (TGLWINTBL(SCORE(CNTC)), CNTC = 1, 2)
        CALL PRINT_DRAW_RESULT(GNUM, CNTB, SQCNAM, SQCVAL)
      ENDIF

      IF(DSPFRG.EQ.2) THEN
        WRITE(SQCNAM, 100) CNTB, DSPMAX
        WRITE(SQCVAL, 200) SPTWINTBL(DSPWIN(DSPMAX))
        CALL PRINT_DRAW_RESULT(GNUM, CNTB, SQCNAM, SQCVAL)
      ENDIF

C
C CLOSE SPORTS DRAW FILE 
C
      CALL CLOSEFIL(FDB)
C
C FORMATS DEFINITION TO PRINT SPORTS DRAW RESULTS
C
100   FORMAT('Sport Game ', I2.2 '/', I2.2, 4(' '))
200   FORMAT(A1, 19(' '))
300   FORMAT(A1, ':', A1, 17(' '))
C
C THIS IS THE END TO PRINT SPORTS DRAW RESULTS
C
      END


C ******************************************************************************
C
C     SUBROUTINE: PRINT_RESULTS_DRAW_RESULT
C     AUTHOR    : J.H.R
C     VERSION   : 01            DATE: 13 / 02 / 2001
C
C ******************************************************************************
C
C FUNCTION TO PRINT RESULTS DRAW RESULTS GSALES LOADER
C
C=======OPTIONS /CHECK = NOOVERFLOW /EXT
      SUBROUTINE PRINT_RESULTS_DRAW_RESULTS(GNUM)
      IMPLICIT NONE
C
C INCLUDES DEFINITION TO PRINT RESULTS DRAW RESULTS
C
      INCLUDE 'INCLIB:SYSPARAM.DEF'
      INCLUDE 'INCLIB:SYSEXTRN.DEF'
      INCLUDE 'INCLIB:GLOBAL.DEF'
      INCLUDE 'INCLIB:GSALES.DEF'
      INCLUDE 'INCLIB:DTGREC.DEF'
      INCLUDE 'INCLIB:STOPCOM.DEF'
C
C PARAMETERS DEFINITION TO PRINT RESULTS DRAW RESULTS
C
      INTEGER * 4 GNUM              ! GAME NUMBER
C
C VARIABLES DEFINITION TO PRINT RESULTS DRAW RESULTS
C
      INTEGER * 4 CNTA              ! COUNTER A
      INTEGER * 4 CNTB              ! COUNTER B
      INTEGER * 4 GAMIDFIL          ! GAME IDENTIFICATION FILE
      INTEGER * 4 FDB(7)            ! FILE DESCRIPTOR BLOCK
C
      CHARACTER * 20 SQCNAM         ! SECUENCE NAME
      CHARACTER * 20 SQCVAL         ! SECUENCE VALUE
      CHARACTER * 01 TGLWINTBL(0:3) ! SPORT WINNING TABLE
C
C INITIATE VARIABLES TO PRINT RESULTS DRAW RESULTS
C
      DATA TGLWINTBL  / '0', '1', '2', 'M'/
C
C GET FREE LUN FOR RESULTS DRAW FILE AND OPEN IT
C
      GAMIDFIL = GET_FREE_IDFIL(1)
      CALL OPEN_SYS_FILE(GAMIDFIL, GAMFIL, GNUM)
      CALL IOINIT(FDB, GAMIDFIL, DTGSEC * 256)
C
C READ DRAW INFORMATION FOR RESULTS GAME FILE
C
      CALL READ_DRAW_FILE(GSALES_AUTO(GNUM), GNUM, FDB, DTGREC)
C
C LOOP TO GET WINNING NUMBERS AND PRINT INFORMATION IN GSALES LOADER
C
      DO CNTA = 1, DTGMAX
        WRITE(SQCNAM, 100) CNTA, DTGMAX
        WRITE(SQCVAL, 200) (TGLWINTBL(DTGWIN(CNTB, CNTA)), CNTB = 1, 2)
        CALL PRINT_DRAW_RESULT(GNUM, CNTA, SQCNAM, SQCVAL)
      ENDDO
C
C CLOSE RESULTS DRAW FILE 
C
      CALL CLOSEFIL(FDB)
C
C FORMATS DEFINITION TO PRINT RESULTS DRAW RESULTS
C
100   FORMAT('Result Game ', I2.2 '/', I2.2, 3(' '))
200   FORMAT(A1, ':', A1, 17(' '))
C
C THIS IS THE END TO PRINT RESULTS DRAW RESULTS
C
      END


C ******************************************************************************
C
C     SUBROUTINE: PRINT_PASSIVE_DRAW_RESULT
C     AUTHOR    : J.H.R
C     VERSION   : 01            DATE: 13 / 02 / 2001
C
C ******************************************************************************
C
C FUNCTION TO PRINT PASSIVE DRAW RESULTS GSALES LOADER
C
C=======OPTIONS /CHECK = NOOVERFLOW /EXT
      SUBROUTINE PRINT_PASSIVE_DRAW_RESULTS(GNUM)
      IMPLICIT NONE
C
C INCLUDES DEFINITION TO PRINT PASSIVE DRAW RESULTS
C
      INCLUDE 'INCLIB:SYSPARAM.DEF'
      INCLUDE 'INCLIB:SYSEXTRN.DEF'
      INCLUDE 'INCLIB:GLOBAL.DEF'
      INCLUDE 'INCLIB:CONCOM.DEF'
      INCLUDE 'INCLIB:GSALES.DEF'
      INCLUDE 'INCLIB:DPAREC.DEF'
      INCLUDE 'INCLIB:STOPCOM.DEF'
C
C PARAMETERS DEFINITION TO PRINT PASSIVE DRAW RESULTS
C
      INTEGER * 4 GNUM              ! GAME NUMBER
C
C VARIABLES DEFINITION TO PRINT PASSIVE DRAW RESULTS
C
      INTEGER * 4 GAMIDFIL          ! GAME IDENTIFICATION FILE
      INTEGER * 4 FDB(7)            ! FILE DESCRIPTOR BLOCK
      INTEGER * 4 DIV               ! DIVISION COUNTER
      INTEGER * 4 NUMDIVS           ! NUMBER OF DIVISIONS
      INTEGER * 4 CNTA              ! COUNTER A
C
      CHARACTER * 20 SQCNAM         ! SECUENCE NAME
      CHARACTER * 20 SQCVAL         ! SECUENCE VALUE
C
C GET FREE LUN FOR RESULTS DRAW FILE AND OPEN IT
C
      GAMIDFIL = GET_FREE_IDFIL(1)
      CALL OPEN_SYS_FILE(GAMIDFIL, GAMFIL, GNUM)
      CALL IOINIT(FDB, GAMIDFIL, DPASEC * 256)
C
C READ DRAW INFORMATION FOR RESULTS GAME FILE
C
      CALL READ_DRAW_FILE(GSALES_AUTO(GNUM), GNUM, FDB, DPAREC)
C
C LOOP TO GET WINNING NUMBERS AND PRINT INFORMATION IN GSALES LOADER
C
      NUMDIVS = 1
      DO DIV = 1, DPADIV
        IF(DPAWNUM(DIV) .GT. 0) THEN
          DO CNTA = 1, DPAWNUM(DIV)
            WRITE(SQCNAM, 100) DIV, CNTA, DPAWNUM(DIV)
            WRITE(SQCVAL, 200) DPAWIN(CNTA, DIV) 
            CALL PRINT_DRAW_RESULT(GNUM, NUMDIVS, SQCNAM, SQCVAL)
            NUMDIVS = NUMDIVS + 1
          ENDDO
        ENDIF
      ENDDO
C
C PRINT PASSIVE WINNING SERIE
C
      WRITE(SQCNAM, 300)
      WRITE(SQCVAL, 200) DPAWSER
      CALL PRINT_DRAW_RESULT(GNUM, NUMDIVS, SQCNAM, SQCVAL)
      NUMDIVS = NUMDIVS + 1
C
C CLOSE PASSIVE DRAW FILE 
C
      CALL CLOSEFIL(FDB)
C
C FORMATS DEFINITION TO PRINT PASSIVE DRAW RESULTS
C
100   FORMAT('Passive ', I2.2 ' - ', I2.2, '/', I2.2, 2(' '))
200   FORMAT(I5.5, 15(' '))
300   FORMAT('Winning Serie:', 6(' '))
C
C THIS IS THE END TO PRINT PASSIVE DRAW RESULTS
C
      END


C ******************************************************************************
C
C     SUBROUTINE: PRINT_JOKER_DRAW_RESULTS
C     AUTHOR    : J.H.R
C     VERSION   : 01            DATE: 26 / 03 / 2001
C
C ******************************************************************************
C
C FUNCTION TO PRINT JOKER DRAW RESULTS GSALES LOADER
C
C=======OPTIONS /CHECK = NOOVERFLOW /EXT
      SUBROUTINE PRINT_JOKER_DRAW_RESULTS(GNUM)
      IMPLICIT NONE
C
C INCLUDES DEFINITION TO PRINT JOKER DRAW RESULTS
C
      INCLUDE 'INCLIB:SYSPARAM.DEF'
      INCLUDE 'INCLIB:SYSEXTRN.DEF'
      INCLUDE 'INCLIB:GLOBAL.DEF'
      INCLUDE 'INCLIB:GSALES.DEF'
      INCLUDE 'INCLIB:DKKREC.DEF'
      INCLUDE 'INCLIB:STOPCOM.DEF'
C
C PARAMETERS DEFINITION TO PRINT JOKER DRAW RESULTS
C
      INTEGER * 4 GNUM              ! GAME NUMBER
C
C VARIABLES DEFINITION TO PRINT JOKER DRAW RESULTS
C
      INTEGER * 4 GAMIDFIL          ! GAME IDENTIFICATION FILE
      INTEGER * 4 FDB(7)            ! FILE DESCRIPTOR BLOCK
C
      CHARACTER * 20 SQCNAM         ! SECUENCE NAME
      CHARACTER * 20 SQCVAL         ! SECUENCE VALUE
C
C GET FREE LUN FOR JOKER DRAW FILE AND OPEN IT
C
      GAMIDFIL = GET_FREE_IDFIL(1)
      CALL OPEN_SYS_FILE(GAMIDFIL, GAMFIL, GNUM)
      CALL IOINIT(FDB, GAMIDFIL, DKKSEC * 256)
C
C READ DRAW INFORMATION FROM JOKER GAME FILE
C
      CALL READ_DRAW_FILE(GSALES_AUTO(GNUM), GNUM, FDB, DKKREC)
C
C GET WINNING NUMBERS AND PRINT INFORMATION IN GSALES LOADER
C
      WRITE(SQCNAM, 100) 
      WRITE(SQCVAL, 200) DKKWIN
      CALL PRINT_DRAW_RESULT(GNUM, 1, SQCNAM, SQCVAL)
C
C FORMATS DEFINITION TO PRINT JOKER DRAW RESULTS
C
100   FORMAT('Joker Number:', 7(' '))
200   FORMAT(I7.7, 13(' '))
C
C THIS IS THE END TO PRINT JOKER DRAW RESULTS
C
      END

