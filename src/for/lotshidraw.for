C
C SUBROUTINE LOTSHIDRAW
C  
C     Rev 1.0   25 Jan 2011 16:35:14   HXK
C  Initial Release
C  Based on Netherlands Bible, 12/92, and Comm 1/93 update
C  DEC Baseline
C
C ** Source - datupd.for **
C
C
C
C
	OPTIONS /CHECK=NOOVERFLOW
	SUBROUTINE LOTSHIDRAW
	IMPLICIT NONE
C
	INCLUDE 'INCLIB:SYSPARAM.DEF'
	INCLUDE 'INCLIB:SYSEXTRN.DEF'
	INCLUDE 'INCLIB:GLOBAL.DEF'
	INCLUDE 'INCLIB:RECDAF.DEF'
	INCLUDE 'INCLIB:RECSCF.DEF'
	COMMON SCFREC
	INTEGER*4 FDB(7),HDRAW(MAXGAM)
	INTEGER*4 REC, ST
C
C
	HDRAW(6) = -1
C
	TYPE*,IAM(),' Setting LOTS hi draw numbers '
	CALL OPENW(1,SCFSFN(1,DAF),4,0,0,ST)
	CALL IOINIT(FDB,1,DAFSEC*256)
	IF(ST.NE.0) THEN
	  CALL FILERR(SCFSFN(1,DAF),1,ST,0)
	  RETURN
	ENDIF
	REC=3000
C
C
10	CONTINUE
	REC=REC+1
	CALL READW(FDB,REC,DAFREC,ST)
	IF(ST.EQ.144.OR.DAFSTS.EQ.0) THEN
	  CALL CLOSEFIL(FDB)
	  RETURN
	ENDIF
C
	IF(ST.NE.0) THEN
	  CALL FILERR(SCFSFN(1,DAF),2,ST,REC)
	  CALL CLOSEFIL(FDB)
	  RETURN
	ENDIF
C
	IF(DAFDRW(6).GT.0) HDRAW(6)=DAFDRW(6)
	IF(DAFDRW(6).EQ.0) HDRAW(6)=-1
	DAFHDR(6)=HDRAW(6)
C
	CALL WRITEW(FDB,REC,DAFREC,ST)
	IF(ST.NE.0) THEN
	  CALL FILERR(SCFSFN(1,DAF),2,ST,REC)
	  CALL CLOSEFIL(FDB)
	  RETURN
	ENDIF
	GOTO 10
	END
