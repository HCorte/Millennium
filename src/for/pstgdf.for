C
C SUBROUTINE PSTGDF
C
C PSTGDF.FOR
C
C V23 18-AUG-2011 FJG EVO Project bug with PASRETAFTAMT solved
C V22 01-JAN-2010 FJG ePassive
C V21 17-DEC-2001 CS  INCLUDED PASSIVE GAME
C V20 29-NOV-2000 UXN TOTOGOLO ADDED.
C V19 17-OCT-2000 UXN Next CDC saved in SCF file.
C V18 13-OCT-1999 RXK World Tour added.
C V17 14-MAY-1999 UXN Super Triple added.
C V16 29-JUL-1998 RXK Save kicker pool (call SKPOOL)
C V15 01-FEB-1997 HXK Save Instant data to DAF file
C V14 10-NOV-1995 HXK Further changes for Double, Couple
C V13 26-JUN-1995 HXK Changes for RAVI modification, mainly QPs, alternatives,
C                     screening and prognosis
C V12 05-MAY-1995 HXK V5 entered into database again!!!!
C V11 05-MAR-1995 HXK Put RAVI screening file save inside RAVI game loop
C V10 21-FEB-1995 HXK Generalised for n games (PXB)
C V09 18-DEC-1994 HXK Increment Bingo seed at dayend to ensure no overlaps 
C                     of seeds
C V08 15-OCT-1994 HXK Adding /developing Bingo (15.Oct.94)
C V07 10-SEP-1993 HXK Added Winner resrve fund stuff
C V06 13-JUL-1993 SXH Added SPEDEN and RAVI screening saving to disk
C V05 25-JUN-1993 GXA Added Speden,Ravi and posting of the Kicker Quick Pick 
C                     Seed.
C V04 21-JAN-1993 DAB Initial Release
C                     Based on Netherlands Bible, 12/92, and Comm 1/93 update
C                     DEC Baseline
C V03 09-FEB-1995 PXN ADDED TABLES FOR GENERIC POPULAR LIST
C V02 12-NOV-1991 MTK INITIAL RELEASE FOR NETHERLANDS
C V01 01-AUG-1990 XXX RELEASED FOR VAX
C
C
C SUBROUTINE TO POST SALES AND GAME DATA TO FILES.
C
C
C+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
C This item is the property of GTECH Corporation, Providence, Rhode
C Island, and contains confidential and trade secret information. It
C may not be transferred from the custody or control of GTECH except
C as authorized in writing by an officer of GTECH. Neither this item
C nor the information it contains may be used, transferred,
C reproduced, published, or disclosed, in whole or in part, and
C directly or indirectly, except as expressly authorized by an
C officer of GTECH, pursuant to written agreement.
C
C Copyright 1999 GTECH Corporation. All rights reserved.
C+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
C
C=======OPTIONS /CHECK=NOOVERFLOW/EXT
	SUBROUTINE PSTGDF
	IMPLICIT NONE
C
	INCLUDE 'INCLIB:SYSPARAM.DEF'
	INCLUDE 'INCLIB:SYSEXTRN.DEF'
	INCLUDE 'INCLIB:GLOBAL.DEF'
	INCLUDE 'INCLIB:CONCOM.DEF'
	INCLUDE 'INCLIB:LTOCOM.DEF'
	INCLUDE 'INCLIB:SPTCOM.DEF'
	INCLUDE 'INCLIB:TGLCOM.DEF'
	INCLUDE 'INCLIB:NBRCOM.DEF'
        INCLUDE 'INCLIB:KIKCOM.DEF'
        INCLUDE 'INCLIB:SCRCOM.DEF'
        INCLUDE 'INCLIB:WITCOM.DEF'
	INCLUDE 'INCLIB:TSLCOM.DEF'
        INCLUDE 'INCLIB:BNGCOM.DEF'
        INCLUDE 'INCLIB:DBLCOM.DEF'
        INCLUDE 'INCLIB:CPLCOM.DEF'
        INCLUDE 'INCLIB:SSCCOM.DEF'
        INCLUDE 'INCLIB:TRPCOM.DEF'
        INCLUDE 'INCLIB:STRCOM.DEF'
        INCLUDE 'INCLIB:PASCOM.DEF'

	INCLUDE 'INCLIB:PRMAGT.DEF'
	INCLUDE 'INCLIB:RECDAF.DEF'
        INCLUDE 'INCLIB:RWFCOM.DEF'

	INCLUDE 'INCLIB:DLTREC.DEF'
	INCLUDE 'INCLIB:DSPREC.DEF'
	INCLUDE 'INCLIB:DTGREC.DEF'
	INCLUDE 'INCLIB:DNBREC.DEF'
	INCLUDE 'INCLIB:DKKREC.DEF'
        INCLUDE 'INCLIB:DSCREC.DEF'
        INCLUDE 'INCLIB:DWIREC.DEF'
        INCLUDE 'INCLIB:DTSREC.DEF'
        INCLUDE 'INCLIB:DBNREC.DEF'
        INCLUDE 'INCLIB:DDBREC.DEF'
        INCLUDE 'INCLIB:DCPREC.DEF'
        INCLUDE 'INCLIB:DSSREC.DEF'
        INCLUDE 'INCLIB:DTRREC.DEF'
        INCLUDE 'INCLIB:DSTREC.DEF'
        INCLUDE 'INCLIB:DPAREC.DEF'
	INCLUDE 'INCLIB:RECSCF.DEF'
	INCLUDE 'INCLIB:STANDARD.DEF'
C
	INTEGER*4  DRAW			! Game Draw Number to update
	INTEGER*4  NEXT_DRAW		! Next Kicker Draw # to post seed to
	INTEGER*4  GNUM			! Game Number
	INTEGER*4  GIND			! Game Index
	INTEGER*4  J, I, K		! Loop Variables
	INTEGER*4  CDC			! Current CDC date.
	INTEGER*4  ST			! Subroutine Return Status.
	INTEGER*4  FDB(7)		! File Descriptor block
	INTEGER*4  SCFNAME(5)/'SYSX',':SCF','.FIL',2*'    '/
        INTEGER*4  INDEMI               ! Loop variable
	INTEGER*4  AUXAMT
C
C UPDATING DAF.FIL
C
	CDC=DAYCDC
	WRITE(5,900) IAM(),(SFNAMES(K,DAF),K=1,5)
	CALL OPENW(1,SFNAMES(1,DAF),4,0,0,ST)
	CALL IOINIT(FDB,1,DAFSEC*256)
	IF(ST.NE.0) CALL FILERR(SFNAMES(1,DAF),1,ST,0)

	CALL READW(FDB,CDC,DAFREC,ST)
	IF(ST.NE.0) CALL FILERR(SFNAMES(1,DAF),2,ST,CDC)

	DAFSTS=DSCLOS
	DO I = 1, NUMTOT
	    DO J=1,NUMFIN
	        DO K=1,MAXGAM
	            DAFTYP(I,J,K)=DAYTYP(I,J,K)
                END DO
            END DO
        END DO

	CALL FASTMOV(DAYSAL(1,1),DAFSAL(1,1),MAXGAM*MAXDRW)
	CALL FASTMOV(DAYDIS(1,1),DAFDIS(1,1),NUMTOT*MAXGAM)

	CALL FASTMOV(DAYCRS(1),DAFCRS(1),NUMCRS)  !added instant stuff HXK
	DAFIVAL = DAYIVAL
	DAFICLM = DAYICLM

	CALL WRITEW(FDB,CDC,DAFREC,ST)
	IF(ST.NE.0) CALL FILERR(SFNAMES(1,DAF),3,ST,CDC)
C
C UPDATE NEXT SALES DAY HIGH DRAW NUMBERS
C
30	CONTINUE
	CDC=CDC+1
	CALL READW(FDB,CDC,DAFREC,ST)
	IF(ST.NE.0) CALL FILERR(SFNAMES(1,DAF),2,ST,CDC)
	IF(DAFSTS.GT.DSOPEN) GOTO 100
	IF(DAFSTS.NE.DSOPEN) GOTO 30
        DO I=1,MAXGAM
            IF(DAFDRW(I).GT.0) THEN
                DAFHDR(I)=DAFDRW(I)
            ELSE
                DAFHDR(I)=DAYHDR(I)
            ENDIF
        END DO
	CALL WRITEW(FDB,CDC,DAFREC,ST)
	IF(ST.NE.0) CALL FILERR(SFNAMES(1,DAF),3,ST,CDC)
	CALL CLOSEFIL(FDB)
C
C UPDATE NEXT CDC IN SCF.FIL
C
	CALL OPENW(1,SCFNAME,4,0,0,ST)
	CALL IOINIT(FDB,1,SCFSEC*256)
	IF(ST.NE.0) CALL FILERR(SCFNAME,1,ST,0)

	CALL READW(FDB,1,SCFREC,ST)
	IF(ST.NE.0) CALL FILERR(SCFNAME,2,ST,1)

	SCFPAR(NXTCDC) = CDC

	CALL WRITEW(FDB,1,SCFREC,ST)
	IF(ST.NE.0) CALL FILERR(SCFNAME,3,ST,1)
	CALL CLOSEFIL(FDB)
C
C UPDATE LOTTO GAME FILES
C
100	CONTINUE
	DO 110 GIND=1,MAXIND

	    GNUM=GTNTAB(TLTO,GIND)
	    IF(GNUM.LT.1) GOTO 110
	    IF(DAYDRW(GNUM).LT.1) GOTO 110

	    WRITE(5,902) IAM(),(GFNAMES(K,GNUM),K=1,5)
	    DRAW=DAYDRW(GNUM)
 	    CALL OPENW(1,GFNAMES(1,GNUM),4,0,0,ST)
	    CALL IOINIT(FDB,1,DLTSEC*256)
	    IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),1,ST,0)
            CALL FASTMOV(RWF_WRFGAM(1,GNUM),LTOWRF(1,GIND),10)
	    CALL GAMLOG(TLTO,GIND,DLTREC,LTOSTS)
	    CALL WRITEW(FDB,DRAW,DLTREC,ST)
	    IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),3,ST,DRAW)
C
C IF LAST DRAWS PRIZE VALUES WERE UPDATED ONLINE
C THEN UPDATE THEM IN THE FILE
C
	    IF(LTOLST(GIND).EQ.GAMDON) THEN
	        DRAW=DRAW-1
	        CALL READW(FDB,DRAW,DLTREC,ST)
	        IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),2,ST,DRAW)
	        IF(DLTSTS.EQ.GAMENV) THEN
	            WRITE(5,903) IAM(),DRAW
	            CALL FASTMOV(LTOLSV(1,1,GIND),DLTSHV(1,1),LTGDIV*2)
	            CALL FASTMOV(LTOTSR(1,1,GIND),DLTTSR(1,1),LTGDIV*2)
	            CALL FASTMOV(LTOLAN(1,1,GIND),DLTANU(1,1),LTGDIV*2)
	            DLTSTS=GFINAL
	        ENDIF
	        CALL WRITEW(FDB,DRAW,DLTREC,ST)
	        IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),3,ST,DRAW)
	    ENDIF
	    CALL CLOSEFIL(FDB)
110	CONTINUE
C
C UPDATE SPORTS GAME FILES
C
	DO 120 GIND=1,MAXIND
	    GNUM=GTNTAB(TSPT,GIND)
	    IF(GNUM.LT.1) GOTO 120
	    IF(DAYDRW(GNUM).LT.1) THEN
	      IF(DAYHDR(GNUM).LE.0) GOTO 120	
	    ENDIF  
	    
	    WRITE(5,902) IAM(),(GFNAMES(K,GNUM),K=1,5)
	    DRAW=DAYDRW(GNUM)
	    IF(DRAW.LE.0) DRAW=DAYHDR(GNUM) 
	    CALL OPENW(1,GFNAMES(1,GNUM),4,0,0,ST)
	    CALL IOINIT(FDB,1,DSPSEC*256)
	    IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),1,ST,0)
            CALL FASTMOV(RWF_WRFGAM(1,GNUM),SPTWRF(1,GIND),10)

	    CALL GAMLOG(TSPT,GIND,DSPREC,SPTSTS)
	    CALL WRITEW(FDB,DRAW,DSPREC,ST)
	    IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),3,ST,DRAW)
	    CALL CLOSEFIL(FDB)
120	CONTINUE
C
C UPDATE RESULTS GAME FILES
C
	DO 130 GIND=1,MAXIND
	    GNUM=GTNTAB(TTGL,GIND)
	    IF(GNUM.LT.1) GOTO 130	    
	    IF(DAYDRW(GNUM).LT.1) THEN
	      IF(DAYHDR(GNUM).LE.0) GOTO 130	
	    ENDIF  

	    WRITE(5,902) IAM(),(GFNAMES(K,GNUM),K=1,5)
	    DRAW=DAYDRW(GNUM)
	    IF(DRAW.LE.0) DRAW=DAYHDR(GNUM) 
	    CALL OPENW(1,GFNAMES(1,GNUM),4,0,0,ST)
	    CALL IOINIT(FDB,1,DTGSEC*256)
	    IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),1,ST,0)
            CALL FASTMOV(RWF_WRFGAM(1,GNUM),TGLWRF(1,GIND),10)

	    CALL GAMLOG(TTGL,GIND,DTGREC,TGLSTS)
	    CALL WRITEW(FDB,DRAW,DTGREC,ST)
	    IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),3,ST,DRAW)
	    CALL CLOSEFIL(FDB)
130	CONTINUE
C
C UPDATE KICKER GAME FILES
C
	DO 160 GIND=1,MAXIND
	   GNUM=GTNTAB(TKIK,GIND)
	   IF(GNUM.LT.1) GOTO 160
	   IF(DAYDRW(GNUM).LT.1) GOTO 160

	   WRITE(5,902) IAM(),(GFNAMES(K,GNUM),K=1,5)
	   DRAW=DAYDRW(GNUM)
 	   CALL OPENW(1,GFNAMES(1,GNUM),4,0,0,ST)
	   CALL IOINIT(FDB,1,DKKSEC*256)
	   IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),1,ST,0)
           CALL FASTMOV(RWF_WRFGAM(1,GNUM),KIKWRF(1,GIND),10)

 	   CALL GAMLOG(TKIK,GIND,DKKREC,KIKSTS)
	   CALL WRITEW(FDB,DRAW,DKKREC,ST)
	   IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),3,ST,DRAW)
C
C IF END OF DRAW, MOVE KICKER SEED TO NEXT DRAW
C
	   IF(KIKSTS(GIND).NE.GAMOPN) THEN
	      NEXT_DRAW = DRAW + 1
	      WRITE(5,904) IAM(),(GLNAMES(K,GNUM),K=1,4)
	      CALL READW(FDB,NEXT_DRAW,DKKREC,ST)
	      IF(ST.NE.0) THEN
		 CALL FILERR(GFNAMES(1,GNUM),2,ST,NEXT_DRAW)
		 RETURN
	      ENDIF

	      WRITE(5,905) IAM(),DKKSED(1),KIKSED(1,GIND)
	      DKKSED(1) = KIKSED(1,GIND) 
C
	      CALL WRITEW(FDB,NEXT_DRAW,DKKREC,ST)
	      IF(ST.NE.0) THEN
		 CALL FILERR(GFNAMES(1,GNUM),3,ST,NEXT_DRAW)
		 RETURN
	      ENDIF
	   ENDIF
	   CALL CLOSEFIL(FDB)

160	CONTINUE
C
C UPDATE NUMBERS GAME FILES
C
        DO 170 GIND=1,MAXIND
            GNUM=GTNTAB(TNBR,GIND)
            IF(GNUM.LT.1) GOTO 170
            IF(DAYDRW(GNUM).LT.1) GOTO 170

            WRITE(5,902) IAM(),(GFNAMES(K,GNUM),K=1,5)
            DRAW=DAYDRW(GNUM)
            CALL OPENW(1,GFNAMES(1,GNUM),4,0,0,ST)
            CALL IOINIT(FDB,1,DNBSEC*256)
            IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),1,ST,0)

            CALL GAMLOG(TNBR,GIND,DNBREC,NBRSTS)
            CALL WRITEW(FDB,DRAW,DNBREC,ST)
            IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),3,ST,DRAW)
            CALL CLOSEFIL(FDB)
170     CONTINUE
C
C UPDATE SCORE GAME FILES
C
        DO 180 GIND=1,MAXIND
            GNUM=GTNTAB(TSCR,GIND)
            IF(GNUM.LT.1) GOTO 180
            IF(DAYDRW(GNUM).LT.1) GOTO 180
            WRITE(5,902) IAM(),(GFNAMES(K,GNUM),K=1,5)

            DRAW=DAYDRW(GNUM)
            CALL OPENW(1,GFNAMES(1,GNUM),4,0,0,ST)
            CALL IOINIT(FDB,1,DSCSEC*256)
            IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),1,ST,0)

            CALL GAMLOG(TSCR,GIND,DSCREC,SCRSTS)
            CALL WRITEW(FDB,DRAW,DSCREC,ST)
            IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),3,ST,DRAW)
            CALL CLOSEFIL(FDB)
	    CALL SSPOOL(GIND)
180     CONTINUE
C
C UPDATE WINNERS TIP GAME FILES
C
        DO 190 GIND=1,MAXIND
            GNUM=GTNTAB(TWIT,GIND)
            IF(GNUM.LT.1) GOTO 190
            IF(DAYDRW(GNUM).LT.1) GOTO 190
            WRITE(5,902) IAM(),(GFNAMES(K,GNUM),K=1,5)

            DRAW=DAYDRW(GNUM)
            CALL OPENW(1,GFNAMES(1,GNUM),4,0,0,ST)
            CALL IOINIT(FDB,1,DWISEC*256)
            IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),1,ST,0)

            CALL GAMLOG(TWIT,GIND,DWIREC,WITSTS)
            CALL WRITEW(FDB,DRAW,DWIREC,ST)
            IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),3,ST,DRAW)
            CALL CLOSEFIL(FDB)
190     CONTINUE
C
C UPDATE TOTO SELECT GAME FILES
C
        DO 200 GIND=1,MAXIND
            GNUM=GTNTAB(TTSL,GIND)
            IF(GNUM.LT.1) GOTO 200
            IF(DAYDRW(GNUM).LT.1) GOTO 200

            WRITE(5,902) IAM(),(GFNAMES(K,GNUM),K=1,5)
            DRAW=DAYDRW(GNUM)
            CALL OPENW(1,GFNAMES(1,GNUM),4,0,0,ST)
            CALL IOINIT(FDB,1,DTSSEC*256)
            IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),1,ST,0)

            CALL GAMLOG(TTSL,GIND,DTSREC,TSLSTS)
            CALL WRITEW(FDB,DRAW,DTSREC,ST)
            IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),3,ST,DRAW)
            CALL CLOSEFIL(FDB)
	    CALL SAVTSP(GNUM)
200     CONTINUE
C
C UPDATE BINGO GAME FILES
C
        DO 300 GIND=1,MAXIND
           GNUM=GTNTAB(TBNG,GIND)
           IF(GNUM.LT.1) GOTO 300
           IF(DAYDRW(GNUM).LT.1) GOTO 300

           WRITE(5,902) IAM(),(GFNAMES(K,GNUM),K=1,5)
           DRAW=DAYDRW(GNUM)
           CALL OPENW(1,GFNAMES(1,GNUM),4,0,0,ST)
           CALL IOINIT(FDB,1,DBNSEC*256)
           IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),1,ST,0)
           CALL FASTMOV(RWF_WRFGAM(1,GNUM),BNGWRF(1,GIND),10)

           CALL GAMLOG(TBNG,GIND,DBNREC,BNGSTS)
           CALL WRITEW(FDB,DRAW,DBNREC,ST)
           IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),3,ST,DRAW)
C
C IF END OF DRAW, MOVE BINGO SEED, LUCKY BASE TO NEXT DRAW
C
           IF(BNGSTS(GIND).NE.GAMOPN) THEN
              NEXT_DRAW = DRAW + 1
              WRITE(5,904) IAM(),(GLNAMES(K,GNUM),K=1,4)
              CALL READW(FDB,NEXT_DRAW,DBNREC,ST)
              IF(ST.NE.0) THEN
                 CALL FILERR(GFNAMES(1,GNUM),2,ST,NEXT_DRAW)
                 RETURN
              ENDIF

              WRITE(5,906) IAM(),DBNSED,BNGSED(GIND)
              DBNSED = BNGSED(GIND)
              WRITE(5,907) IAM(), DBNBAS,BNGBAS(GIND)
              DBNBAS = BNGBAS(GIND)
	    	              
              CALL WRITEW(FDB,NEXT_DRAW,DBNREC,ST)
              IF(ST.NE.0) THEN
                 CALL FILERR(GFNAMES(1,GNUM),3,ST,NEXT_DRAW)
                 RETURN
              ENDIF
           ENDIF
           CALL CLOSEFIL(FDB)

300     CONTINUE
C
C
C UPDATE DOUBLE GAME FILES
C
        DO 400 GIND=1,MAXIND
            GNUM=GTNTAB(TDBL,GIND)
            IF(GNUM.LT.1) GOTO 400
            IF(DAYDRW(GNUM).LT.1) GOTO 400
            WRITE(5,902) IAM(),(GFNAMES(K,GNUM),K=1,5)

            DO I=1,MAXDBLRW*MAXDBLRW
               DBLODT(I,GIND) = DBPOOL(I,DBLPAMNT,DBLPDYNM,GIND)
            ENDDO

            DRAW=DAYDRW(GNUM)
            CALL OPENW(1,GFNAMES(1,GNUM),4,0,0,ST)
            CALL IOINIT(FDB,1,DDBSEC*256)
            IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),1,ST,0)

            CALL GAMLOG(TDBL,GIND,DDBREC,DBLSTS)
            CALL WRITEW(FDB,DRAW,DDBREC,ST)
            IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),3,ST,DRAW)
            CALL CLOSEFIL(FDB)
400     CONTINUE
C
C UPDATE COUPLE GAME FILES
C
        DO 500 GIND=1,MAXIND
            GNUM=GTNTAB(TCPL,GIND)
            IF(GNUM.LT.1) GOTO 500
            IF(DAYDRW(GNUM).LT.1) GOTO 500
            WRITE(5,902) IAM(),(GFNAMES(K,GNUM),K=1,5)

            DO I=1,(MAXCPLRW/2)*(MAXCPLRW/2)
               CPLODT(I,GIND) = CPPOOL(I,CPLPAMNT,CPLPDYNM,GIND)
            ENDDO

            DRAW=DAYDRW(GNUM)
            CALL OPENW(1,GFNAMES(1,GNUM),4,0,0,ST)
            CALL IOINIT(FDB,1,DCPSEC*256)
            IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),1,ST,0)

            CALL GAMLOG(TCPL,GIND,DCPREC,CPLSTS)
            CALL WRITEW(FDB,DRAW,DCPREC,ST)
            IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),3,ST,DRAW)
            CALL CLOSEFIL(FDB)
500     CONTINUE
C
C UPDATE SUPERSCORE GAME FILES
C
        DO 550 GIND=1,MAXIND
            GNUM=GTNTAB(TSSC,GIND)
            IF(GNUM.LT.1) GOTO 550
            IF(DAYDRW(GNUM).LT.1) GOTO 550
            WRITE(5,902) IAM(),(GFNAMES(K,GNUM),K=1,5)

            DRAW=DAYDRW(GNUM)
            CALL OPENW(1,GFNAMES(1,GNUM),4,0,0,ST)
            CALL IOINIT(FDB,1,DSSSEC*256)
            IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),1,ST,0)

            CALL GAMLOG(TSSC,GIND,DSSREC,SSCSTS)
            CALL WRITEW(FDB,DRAW,DSSREC,ST)
            IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),3,ST,DRAW)
            CALL CLOSEFIL(FDB)
	    CALL SSSPOOL(GIND)
550     CONTINUE
C
C UPDATE TODAY'S TRIO GAME FILES
C
        DO 600 GIND=1,MAXIND
            GNUM=GTNTAB(TTRP,GIND)
            IF(GNUM.LT.1) GOTO 600
            IF(DAYDRW(GNUM).LT.1) GOTO 600
            WRITE(5,902) IAM(),(GFNAMES(K,GNUM),K=1,5)

            DRAW=DAYDRW(GNUM)
            CALL OPENW(1,GFNAMES(1,GNUM),4,0,0,ST)
            CALL IOINIT(FDB,1,DTRSEC*256)
            IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),1,ST,0)

            CALL GAMLOG(TTRP,GIND,DTRREC,TRPSTS)
            CALL WRITEW(FDB,DRAW,DTRREC,ST)
            IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),3,ST,DRAW)
            CALL CLOSEFIL(FDB)
	    CALL STRPOOL(GIND)
600     CONTINUE
C
C UPDATE SUPER TRIPLE GAME FILES
C
        DO 700 GIND=1,MAXIND
            GNUM=GTNTAB(TSTR,GIND)
            IF(GNUM.LT.1) GOTO 700
            IF(DAYDRW(GNUM).LT.1) GOTO 700
            WRITE(5,902) IAM(),(GFNAMES(K,GNUM),K=1,5)

            DRAW=DAYDRW(GNUM)
            CALL OPENW(1,GFNAMES(1,GNUM),4,0,0,ST)
            CALL IOINIT(FDB,1,DSTSEC*256)
            IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),1,ST,0)

            CALL GAMLOG(TSTR,GIND,DSTREC,STRSTS)
            CALL WRITEW(FDB,DRAW,DSTREC,ST)
            IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),3,ST,DRAW)
            CALL CLOSEFIL(FDB)
	    CALL SSTPOOL(GIND)
700     CONTINUE
C                                                                               
C UPDATE PASSIVE LOTTERY GAME FILES
C
        DO GIND=1,MAXIND
            GNUM=GTNTAB(TPAS,GIND)
            IF(GNUM.GT.0) THEN
                DO INDEMI = 1, PAGEMI
                  IF(PASEMIS(INDEMI,GIND).GT.PAS_DRW_OFFSET.AND.
     *               PASSUBSTS(INDEMI,GIND).NE.PDRWCLO.AND.
     *               PASSUBSTS(INDEMI,GIND).NE.PDRWNOT) THEN

                    DRAW = PASEMIS(INDEMI,GIND)

                    WRITE(5,908) IAM(),(GFNAMES(K,GNUM),K=1,5),DRAW
C
C OPEN PASSIVE GAME FILE
C
                    CALL OPENW(1,GFNAMES(1,GNUM),4,0,0,ST)
                    CALL IOINIT(FDB,1,DPASEC*256)
                    IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),OPEN_ERROR,ST,0)

                    CALL READW(FDB,(DRAW-PAS_DRW_OFFSET),DPAREC,ST)
                    IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),
     *                                      READ_ERROR,ST,DRAW)
                    AUXAMT = DPARETAFTAMT !+++++++++Important to save it later as it was
C
C CONVERT MEMORY TO GAME RECORD AND STORE IT
C
                    CALL GAMLOGPAS(INDEMI,GIND,DPAREC,PASSTS)
C===================DPARETAFTAMT = AUXAMT + PASRETAFTAMT(INDEMI,GIND)     ! V23
                    DPARETAFTAMT = AUXAMT                                 ! V23
C                   Because of reprocessing issue, during online this value is COUNTER, not AMOUNT.
C                   The real amount is calculated on UPDVOF after accessing and updating the VPFs
C                   So we maintain the value as it was
C===================================================================================================

                    CALL WRITEW(FDB,(DRAW-PAS_DRW_OFFSET),DPAREC,ST)
                    IF(ST.NE.0) CALL FILERR(GFNAMES(1,GNUM),
     *                                      WRITE_ERROR,ST,DRAW)
C
C CLOSE FILE
C
                    CALL CLOSEFIL(FDB)
                  ENDIF
                ENDDO
            ENDIF
        ENDDO
C
        ! save ticket messages
        CALL SAVETKM


	TYPE*,IAM(),' Game file update complete'

	RETURN
C
C
900	FORMAT(1X,A,' Posting sales data to ',5A4)
902	FORMAT(1X,A,' Posting game  data to ',5A4)
903	FORMAT(1X,A,' Posting prize values for draw ',I4)
904	FORMAT(1X,A,' Posting SEED information for:',10X,4A4)
905     FORMAT(1X,A,' Overwriting Joker SEED, Old: ',Z8.8,' New: ',Z8.8)
906     FORMAT(1X,A,' Overwriting Bingo SEED, Old: ',Z8.8,' New: ',Z8.8)
907     FORMAT(1X,A,' Overwriting Lucky BASE, Old: ',Z8.8,' New: ',Z8.8)
908     FORMAT(1X,A,' Posting game data to ',5A4,' draw ',I5)

	END
