C
C SUBROUTINE REPVAL
C $Log:   GXAFXT:[GOLS]REPVAL.FOV  $
C  
C     Rev 1.0   17 Apr 1996 14:42:44   HXK
C  Release of Finland for X.25, Telephone Betting, Instant Pass Thru Phase 1
C  
C     Rev 1.1   30 Aug 1993 23:50:42   GXA
C  Added Bank ID, Number and Exchange ticket serial# to queue decoding.
C  
C     Rev 1.0   21 Jan 1993 17:29:08   DAB
C  Initial Release
C  Based on Netherlands Bible, 12/92, and Comm 1/93 update
C  DEC Baseline
C
C ** Source - valpro.for **
C
C
C
C VALIDATION REPROCESS SUBROUTINE
C
C=======OPTIONS /CHECK=NOOVERFLOW
	SUBROUTINE REPVAL(STAT,OPENST)
	IMPLICIT NONE
C
	INCLUDE 'INCLIB:SYSPARAM.DEF'
	INCLUDE 'INCLIB:SYSEXTRN.DEF'
	INCLUDE 'INCLIB:GLOBAL.DEF'
	INCLUDE 'INCLIB:CONCOM.DEF'
	INCLUDE 'INCLIB:PROCOM.DEF'
	INCLUDE 'INCLIB:DESTRA.DEF'
	INCLUDE 'INCLIB:TASKID.DEF'
	INCLUDE 'INCLIB:QUECOM.DEF'
C
	DATA TRABUF/TRALEN*0/
	INTEGER*4 MESS(EDLEN), STATUS, OPENST, STAT
C
C
	CALL RTL(TRABUF(TSER),REPVQUE,STAT)
	IF(STAT.EQ.2) RETURN
	IF(OPENST.NE.0) THEN
	  CALL OPEVAL
	  OPENST=0
	ENDIF
C
C GET VALIDATION TRANSACTION
C
	CALL GETVDATA(TRABUF(TTYP))
	CALL GETVDATA(TRABUF(TTER))
	CALL GETVDATA(TRABUF(TVSTS))
	CALL GETVDATA(TRABUF(TVSER))
	CALL GETVDATA(TRABUF(TVCDC))
	CALL GETVDATA(TRABUF(TGAMTYP))
	CALL GETVDATA(TRABUF(TFIL))
	CALL GETVDATA(TRABUF(TVBNKID))
	CALL GETVDATA(TRABUF(TVBNKNUM))
	CALL GETVDATA(TRABUF(TVEXC))
	TRABUF(TCDC)=DAYCDC
C
C
	CALL RVALUPD(TRABUF,STATUS)
	IF(STATUS.NE.0) THEN
	  MESS(1)=VAL
	  MESS(2)=TEGEN
	  MESS(3)=9
	  MESS(4)=STATUS
	  MESS(5)=TRABUF(TSER)
	  CALL QUEMES(MESS)
	  RETURN
	ENDIF
	RETURN
	END
