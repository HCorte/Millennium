C
C SUBROUTINE POOLSPFL
C $Log:   GXAFXT:[GOLS]POOLSPFL.FOV  $
C  
C     Rev 1.0   17 Apr 1996 14:26:18   HXK
C  Release of Finland for X.25, Telephone Betting, Instant Pass Thru Phase 1
C  
C     Rev 1.0   21 Jan 1993 17:19:36   DAB
C  Initial Release
C  Based on Netherlands Bible, 12/92, and Comm 1/93 update
C  DEC Baseline
C
C ** Source - poolspt.for **
C
C
C
C     POOLSPFL(BET,NUMROWS,GAME,ADD) ;UPDATE POOLS WITH SPORTS SYSTEM
C     IN:
C     BET -  BET IN I*4 FORMAT
C     NUMROWS - NUMBER OF ROWS IN BET
C     GAME - POOLS GAME #
C     ADD -  0 IF SHOULD INCREASE POOLS
C
C=======OPTIONS /CHECK=NOOVERFLOW
	SUBROUTINE POOLSPFL(BET,NUMROWS,GAME,ADD)
	IMPLICIT NONE
C
	INCLUDE 'INCLIB:SYSPARAM.DEF'
	INCLUDE 'INCLIB:SYSEXTRN.DEF'
	INTEGER*4 OFFSET, ROW, CURRENT_ROW, GAME, NUMROWS
	INTEGER*4 BET(NUMROWS)
	INTEGER*4 ADD
	INTEGER*4 LOCAL_BET(16)
	INTEGER*4 CNT_INDEX(16)
C
	INTEGER*4 BITCNT(0:7) /0,1,1,2,1,2,2,3/
	INTEGER*4 BITOR(3,0:7)
	DATA BITOR/3*0, 1,2*0, 2,2*0, 1,2,0, 4,2*0, 1,4,0 , 2,4,0,
     *	           1,2,4/
C
	CALL FASTSET(1,CNT_INDEX,NUMROWS)
	CURRENT_ROW=1
C
10	CONTINUE
C
	DO 30, ROW=1,NUMROWS     !GET NEXT SIMPLE BET
	   LOCAL_BET(ROW)=BITOR(CNT_INDEX(ROW),BET(ROW))
30	CONTINUE
C
	CALL SPTOFF1(LOCAL_BET,NUMROWS,OFFSET)  !GET OFFSET
C
	CALL POOLUPD2(OFFSET,GAME,ADD)   !UPDATE POOLS
C
C     FIND NEXT SIMPLE BET
C
	CNT_INDEX(CURRENT_ROW)=CNT_INDEX(CURRENT_ROW)+1
	IF (CNT_INDEX(CURRENT_ROW).GT.BITCNT(BET(CURRENT_ROW))) THEN
50	   CONTINUE
	   CNT_INDEX(CURRENT_ROW)=1
	   CURRENT_ROW=CURRENT_ROW+1
	   IF (CURRENT_ROW.GT.NUMROWS) GOTO 9000   !ALL DONE
	   IF (CNT_INDEX(CURRENT_ROW)+1.GT.BITCNT(BET(CURRENT_ROW)))
     *	           GOTO 50      !NO MORE COMBINATIONS IN THIS ROW
	   CNT_INDEX(CURRENT_ROW)=CNT_INDEX(CURRENT_ROW)+1 !NEXT ROW
	   CURRENT_ROW=1
C
	ENDIF
C
	GOTO 10
C
9000	CONTINUE
	RETURN
	END
