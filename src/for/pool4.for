C
C SUBROUTINE POOL4
C $Log:   GXAFXT:[GOLS]POOL4.FOV  $
C  
C     Rev 1.0   17 Apr 1996 14:24:22   HXK
C  Release of Finland for X.25, Telephone Betting, Instant Pass Thru Phase 1
C  
C     Rev 1.0   21 Jan 1993 17:17:44   DAB
C  Initial Release
C  Based on Netherlands Bible, 12/92, and Comm 1/93 update
C  DEC Baseline
C
C ** Source - pool4.for **
C
C POOL4.FOR
C
C V02 01-APR-91 MTK INITIAL RELEASE FOR MARYLAND
C V01 01-AUG-90 XXX RELEASED FOR VAX
C
C
C
C COPYRITF.DEF+++++++++++++++++++++++++++++++++++++++++++++++++++++++
C
C COPYRIGHT 1991 GTECH CORPORATION.  ALL RIGHTS RESERVED.
C
C CONFIDENTIAL PROPRIETARY INFORMATION
C This item is the property of GTECH Corporation, W. Greenwich, Rhode
C Island, and contains confidential and trade secret information.  It
C may not be transferred from the custody or control of GTECH except
C as authorized in writing by an officer of GTECH.  Neither this item
C nor the information it contains may be used, transferred,
C reproduced, published or disclosed, in whold or in part, directly
C or indirectly, except as expressly authorized by an officer of
C GTECH pursuant to written agreement.
C COPYRITF.DEF-------------------------------------------------------
C
C=======OPTIONS /CHECK=NOOVERFLOW
	SUBROUTINE POOL4(GIND)
	IMPLICIT NONE
C
	INCLUDE 'INCLIB:SYSPARAM.DEF'
	INCLUDE 'INCLIB:SYSEXTRN.DEF'
	INCLUDE 'INCLIB:GLOBAL.DEF'
	INCLUDE 'INCLIB:POLCOM.DEF'
	INCLUDE 'INCLIB:NBRCOM.DEF'
	INCLUDE 'INCLIB:CONCOM.DEF'
	INCLUDE 'INCLIB:DATBUF.DEF'
	INTEGER*2 DAT(LDATE_LEN)
        INTEGER*4 GIND, I, J, L, LINE, PAGE, IND1, IND2
        INTEGER*4 STATUS, K, M, STIM
        INTEGER*4 POLAMT(0:10),PTOTAL(9)
        CHARACTER*11 CPOLAMT(0:10)
	CHARACTER*12 PNUMS(25) /' 0000 - 0399',' 0400 - 0799',
     *	                        ' 0800 - 1199',' 1200 - 1599',
     *	                        ' 1600 - 1999',' 2000 - 2399',
     *	                        ' 2400 - 2799',' 2800 - 3199',
     *	                        ' 3200 - 3599',' 3600 - 3999',
     *	                        ' 4000 - 4399',' 4400 - 4799',
     *	                        ' 4800 - 5199',' 5200 - 5599',
     *	                        ' 5600 - 5999',' 6000 - 6399',
     *	                        ' 6400 - 6799',' 6800 - 7199',
     *	                        ' 7200 - 7599',' 7600 - 7999',
     *	                        ' 8000 - 8399',' 8400 - 8799',
     *	                        ' 8800 - 9199',' 9200 - 9599',
     *	                        ' 9600 - 9999'/
	CHARACTER*15 PTYPE(9)/'STRAIGHT POOL  ','BOX24 POOL     ',
     *	 'BOX12 POOL    ','BOX6 POOL      ','BOX4 POOL      ',
     *	 'FRONT 2 POOL  ','MIDDLE 2 POOL  ','BACK 2 POOL    ',
     *	 'TOTAL POOL     '/
C
C
        IF(NBRTYP(GIND).NE.NB4TYP) RETURN
        OPEN(UNIT=6, FILE='POOL4.REP', STATUS='NEW',
     *      IOSTAT=STATUS, SHARED, DISP='PRINT/DELETE')
        IF(STATUS.NE.0) RETURN
	PAGE=0
	LINE=0
	DO 50 I=1,9
	  PTOTAL(I)=0
50	CONTINUE
	CALL ICLOCK(1,STIM)
	DAT(5)=DAYCDC
	CALL LCDATE(DAT)
C
C     STRAIGHT POOL
C
	CALL TITLE('4-DIGIT POOL REPORT','POOL4   ',1,6,PAGE,DAYCDC)
	WRITE(6,908)(DAT(I),I=7,13)
	WRITE(6,923)PTYPE(1),PNUMS(PAGE)
	WRITE(6,920)(I,I=0,9)
	DO 130 J=0,9
	  DO 120 K=0,9
	    DO 110 L=0,9
	      DO 100 M=0,9
	        CALL VNUMOD(J*1000+K*100+L*10+M,TNB4ST,NB4TYP,IND1,IND2)
	        POLAMT(M)=POOLT(IND2,1,GIND)*NBRPRC(GIND)
	        PTOTAL(1)=PTOTAL(1)+POLAMT(M)
100	      CONTINUE
	      WRITE(6,925)J,K,L,(CMONY(POLAMT(M),11,BETUNIT),M=0,9)
	      LINE=LINE+1
	      IF(LINE.GE.40.AND.PAGE.NE.25) THEN
	        CALL TITLE('4-DIGIT POOL REPORT','POOL4   ',1,6,PAGE,
     *	                   DAYCDC)
	        WRITE(6,908)(DAT(I),I=7,13)
	        WRITE(6,923)PTYPE(1),PNUMS(PAGE)
	        WRITE(6,920)(I,I=0,9)
	        LINE=0
	      ENDIF
110	    CONTINUE
	    IF(LINE.NE.0)WRITE(6,901)
120	  CONTINUE
130	CONTINUE
	WRITE(6,942)PTYPE(1),CMONY(PTOTAL(1),11,BETUNIT)
C
C     BOX24 POOL
C
	CALL TITLE('4-DIGIT POOL REPORT','POOL4   ',1,6,PAGE,DAYCDC)
	WRITE(6,908)(DAT(I),I=7,13)
	WRITE(6,923)PTYPE(2),'0120 - 1789'
	WRITE(6,920)(I,I=0,9)
	DO 240 J=0,6
	  DO 230 K=J+1,7
	    DO 220 L=K+1,8
	      DO 200 I=0,9
	        CPOLAMT(I)='          *'
200	      CONTINUE
	      DO 210 M=L+1,9
	        CALL VNUMOD(1000*J+100*K+10*L+M,TNB4B24,NB4TYP,IND1,IND2)
	        POLAMT(M)=POOLT(IND1,1,GIND)*NBRPRC(GIND)
	        PTOTAL(2)=PTOTAL(2)+POLAMT(M)
	        WRITE (CPOLAMT(M),956) CMONY(POLAMT(M),11,BETUNIT)
210	      CONTINUE
	      WRITE(6,955)J,K,L,(CPOLAMT(I),I=0,9)
220	    CONTINUE
230	  CONTINUE
	  IF(J.EQ.1)THEN
          CALL TITLE('4-DIGIT POOL REPORT','POOL4   ',1,6,PAGE,DAYCDC)
	    WRITE(6,908)(DAT(I),I=7,13)
	    WRITE(6,923)PTYPE(2),'2340 - 6789'
	    WRITE(6,920)(I,I=0,9)
	  ENDIF
240	CONTINUE
	WRITE(6,942)PTYPE(2),CMONY(PTOTAL(2),11,BETUNIT)
C
C     BOX12 POOL
C
	CALL TITLE('4-DIGIT POOL REPORT','POOL4   ',1,6,PAGE,DAYCDC)
	WRITE(6,908)(DAT(I),I=7,13)
	WRITE(6,923)PTYPE(3)
	WRITE(6,921)(I,I=0,99,11)
	DO 330 J=0,8
	  DO 320 K=J+1,9
	    DO 300 I=0,9
	      CPOLAMT(I)='          *'
300	    CONTINUE
	    DO 310 L=0,9
	      IF(L.EQ.J.OR.L.EQ.K)GOTO 310
	      CALL VNUMOD(1000*J+100*K+11*L,TNB4B12,NB4TYP,IND1,IND2)
	        POLAMT(L)=POOLT(IND1,1,GIND)*NBRPRC(GIND)
	      PTOTAL(3)=PTOTAL(3)+POLAMT(L)
	      WRITE (CPOLAMT(L),956) CMONY(POLAMT(L),11,BETUNIT)
310	    CONTINUE
	    WRITE(6,930)J,K,(CPOLAMT(I),I=0,9)
320	  CONTINUE
330	CONTINUE
	WRITE(6,942)PTYPE(3),CMONY(PTOTAL(3),11,BETUNIT)
C
C     BOX6 POOL
C
	CALL TITLE('4-DIGIT POOL REPORT','POOL4   ',1,6,PAGE,DAYCDC)
	WRITE(6,908)(DAT(I),I=7,13)
	WRITE(6,923)PTYPE(4)
	WRITE(6,921)(I,I=0,99,11)
	DO 420 J=0,8
	  DO 400 I=0,9
	    CPOLAMT(I)='          *'
400	  CONTINUE
	  DO 410 K=0,9
	   IF(K.LE.J)GOTO 410
	   CALL VNUMOD(1100*J+11*K,TNB4B6,NB4TYP,IND1,IND2)
	   POLAMT(K)=POOLT(IND1,1,GIND)*NBRPRC(GIND)
	   PTOTAL(4)=PTOTAL(4)+POLAMT(K)
	   WRITE (CPOLAMT(K),956) CMONY(POLAMT(K),11,BETUNIT)
410	  CONTINUE
	  WRITE(6,935)J,J,(CPOLAMT(I),I=0,9)
420	CONTINUE
	WRITE(6,942)PTYPE(4),CMONY(PTOTAL(4),11,BETUNIT)
C
C     BOX4 POOL
C
	CALL TITLE('4-DIGIT POOL REPORT','POOL4   ',1,6,PAGE,DAYCDC)
	WRITE(6,908)(DAT(I),I=7,13)
	WRITE(6,923)PTYPE(5)
	WRITE(6,922)(I,I=0,999,111)
	DO 520 J=0,9
	  DO 500 I=0,9
	    CPOLAMT(I)='          *'
500	  CONTINUE
	  DO 510 K=0,9
	    IF(K.EQ.J)GOTO 510
	    CALL VNUMOD(1000*J+111*K,TNB4B4,NB4TYP,IND1,IND2)
	        POLAMT(K)=POOLT(IND1,1,GIND)*NBRPRC(GIND)
	    PTOTAL(5)=PTOTAL(5)+POLAMT(K)
	    WRITE (CPOLAMT(K),956) CMONY(POLAMT(K),11,BETUNIT)
510	  CONTINUE
	  WRITE(6,940)J,(CPOLAMT(I),I=0,9)
520	CONTINUE
	WRITE(6,942)PTYPE(5),CMONY(PTOTAL(5),11,BETUNIT)
C
C     FRONT POOL
C
	CALL TITLE('4-DIGIT POOL REPORT','POOL4   ',1,6,PAGE,DAYCDC)
	WRITE(6,908)(DAT(I),I=7,13)
	WRITE(6,923)PTYPE(6)
	WRITE(6,920)(I,I=0,9)
	DO 4100 J=0,9
	  DO 4000 K=0,9
	    CALL VNUMOD(J*10+K,TNB4F2,NB4TYP,IND1,IND2)
	    POLAMT(K)=POOLT(IND2,1,GIND)*NBRPRC(GIND)
	    PTOTAL(6)=PTOTAL(6)+POLAMT(K)
4000	   CONTINUE
	  WRITE(6,931)J,(CMONY(POLAMT(I),11,BETUNIT),I=0,9)
4100	CONTINUE
	WRITE(6,942)PTYPE(6),CMONY(PTOTAL(6),11,BETUNIT)
C
C     MIDDLE POOL
C
	WRITE(6,908)(DAT(I),I=7,13)
	WRITE(6,923)PTYPE(7)
	WRITE(6,920)(I,I=0,9)
	DO 5100 J=0,9
	  DO 5000 K=0,9
	    CALL VNUMOD(J*10+K,TNB4M2,NB4TYP,IND1,IND2)
	    POLAMT(K)=POOLT(IND2,1,GIND)*NBRPRC(GIND)
	    PTOTAL(7)=PTOTAL(7)+POLAMT(K)
5000	   CONTINUE
	  WRITE(6,936)J,(CMONY(POLAMT(I),11,BETUNIT),I=0,9)
5100	 CONTINUE
	WRITE(6,942)PTYPE(7),CMONY(PTOTAL(7),11,BETUNIT)
C
C     BACK POOL
C
	WRITE(6,908)(DAT(I),I=7,13)
	WRITE(6,923)PTYPE(8)
	WRITE(6,920)(I,I=0,9)
	DO 6100 J=0,9
	  DO 6000 K=0,9
	    CALL VNUMOD(J*10+K,TNB4B2,NB4TYP,IND1,IND2)
	    POLAMT(K)=POOLT(IND2,1,GIND)*NBRPRC(GIND)
	    PTOTAL(8)=PTOTAL(8)+POLAMT(K)
6000	   CONTINUE
	  WRITE(6,941)J,(CMONY(POLAMT(I),11,BETUNIT),I=0,9)
6100	 CONTINUE
	WRITE(6,942)PTYPE(8),CMONY(PTOTAL(8),11,BETUNIT)
C
C     TOTALS
C
	CALL TITLE('4-DIGIT POOL REPORT','POOL4   ',1,6,PAGE,DAYCDC)
	WRITE(6,908)(DAT(I),I=7,13)
	WRITE(6,901)
	DO 700 I=1,8
	  WRITE(6,942)PTYPE(I),CMONY(PTOTAL(I),11,BETUNIT)
	  PTOTAL(9)=PTOTAL(9)+PTOTAL(I)
700	CONTINUE
C
	WRITE(6,942) PTYPE(9),CMONY(PTOTAL(9),11,BETUNIT)
C
	CLOSE(6)
	RETURN
C
C
C
C     FORMAT AREA
C
901	FORMAT(/)
908	FORMAT(/,T60,'For ',7A2,/)
920	FORMAT(5X,'NUMBERS',10X,10(I1,10X),/)
921	FORMAT(5X,'NUMBERS',9X,10(I2.2,9X),/)
922	FORMAT(5X,'NUMBERS',8X,10(I3.3,8X),/)
923	FORMAT(//,5X,'LAST CLOSE - ',A15,:,A12)
925	FORMAT(5X,3I1,'-',3X,10(A11))
930	FORMAT(5X,2I1,'--',3X,10(A11))
935	FORMAT(5X,2I1,'--',3X,10(A11))
940	FORMAT(5X,I1,'---',3X,10(A11))
942	FORMAT(5X,'TOTAL - ',A15,4X,A11)
955	FORMAT(5X,3I1,'-',3X,10(A11))
956	FORMAT(A11)
931	FORMAT(5X,I1,'-X',4X,10(A11))
936	FORMAT(5X,I1,'X-',4X,10(A11))
941	FORMAT(5X,'X',I1,'-',4X,10(A11))
	END
