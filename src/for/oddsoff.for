C
C SUBROUTINE ODDSOFF
C $Log:   GXAFXT:[GOLS]ODDSOFF.FOV  $
C  
C     Rev 1.0   17 Apr 1996 14:16:34   HXK
C  Release of Finland for X.25, Telephone Betting, Instant Pass Thru Phase 1
C  
C     Rev 1.0   21 Jan 1993 17:11:18   DAB
C  Initial Release
C  Based on Netherlands Bible, 12/92, and Comm 1/93 update
C  DEC Baseline
C
C ** Source - oddsoff.for **
C
C ODDSOFF.FOR
C
C V01 01-AUG-90 XXX RELEASED FOR VAX
C
C SUBROUTINE TO CONVERT ODDS BET INTO POOL OFFSET
C
C ODDSOFF(RAW_NRS,TAB_1X2,NO_OF_RAWS,OFFSET_ODDS1,OFFSET_ODDS2)
C
C INPUT PARAMETERS:
C
C RAW_NRS     - I4 TABLE OF RAW NUMBERS BET
C TAB_1X2     - I4 TABLE OF 1X2 CHOICE (REPRESENTED BY 1,2 OR 4
C NO_OF_RAWS  - NO OF RAWS BET
C
C OUTPUT PARAMETERS:
C
C OFFSET_ODDS - OFFSET
C
C
C COPYRITF.DEF+++++++++++++++++++++++++++++++++++++++++++++++++++++++
C
C COPYRIGHT 1991 GTECH CORPORATION.  ALL RIGHTS RESERVED.
C
C CONFIDENTIAL PROPRIETARY INFORMATION
C This item is the property of GTECH Corporation, W. Greenwich, Rhode
C Island, and contains confidential and trade secret information.  It
C may not be transferred from the custody or control of GTECH except
C as authorized in writing by an officer of GTECH.  Neither this item
C nor the information it contains may be used, transferred,
C reproduced, published or disclosed, in whold or in part, directly
C or indirectly, except as expressly authorized by an officer of
C GTECH pursuant to written agreement.
C COPYRITF.DEF-------------------------------------------------------
C
C=======OPTIONS /CHECK=NOOVERFLOW
	SUBROUTINE ODDSOFF(RAW_NRS,TAB_1X2,NO_OF_RAWS,OFFSET_ODDS)
	IMPLICIT NONE
C
	INCLUDE 'INCLIB:SYSPARAM.DEF'
	INCLUDE 'INCLIB:SYSEXTRN.DEF'
C
	INTEGER*4 MAX_RAWS
	INTEGER*4 RAW_NRS(*)
	INTEGER*4 NO_OF_RAWS
	INTEGER*4 TAB_1X2(*)
	INTEGER*4 OFFSET_ODDS
	INTEGER*4 OFFSET_ODDS1,OFFSET_ODDS2
	INTEGER*4 POWER3(0:6)
	INTEGER*4 MAX_OFFSET_ODDS2
	INTEGER*4 MAX_I4,MAX_ODDS6
C
	DATA      POWER3 /1,3,9,27,81,243,729/  !FOR SPEED POWERS OF 3
C
	PARAMETER (MAX_RAWS = 6)
	PARAMETER (MAX_I4='7FFFFFFF'X)
	PARAMETER (MAX_ODDS6=MAX_I4/731)
C
C GET ODDSET TYPE OFFSET
C
	IF (NO_OF_RAWS .GT. MAX_RAWS) THEN
	    OFFSET_ODDS = 0
	    RETURN
	ENDIF
C
	CALL CMBOFF(RAW_NRS,OFFSET_ODDS1,NO_OF_RAWS)
C
	CALL SPTOFF1(TAB_1X2,NO_OF_RAWS,OFFSET_ODDS2)
C
C CALCULATE SINGLE OFFSET NOW
C WE CAN FIT 5 RAW GAMES IN I4
C
	MAX_OFFSET_ODDS2 = POWER3(NO_OF_RAWS)
C
C 6 RAWS EXCEED RANGE OF POSITIVE NUMBERS
C WE SHOULD CHECK IF WE EXCEED THE RANGE, AND GO INTO NEGATIVE
C RANGE
C
	IF(NO_OF_RAWS .LE. 5) THEN
	  OFFSET_ODDS = (OFFSET_ODDS1-1)*MAX_OFFSET_ODDS2+OFFSET_ODDS2
	ELSE
	  IF(OFFSET_ODDS1.LE.MAX_ODDS6) THEN
	    OFFSET_ODDS=(OFFSET_ODDS1-1)*MAX_OFFSET_ODDS2+OFFSET_ODDS2
	  ELSE
	    OFFSET_ODDS1=OFFSET_ODDS1-MAX_ODDS6
	    OFFSET_ODDS=(OFFSET_ODDS1-1)*MAX_OFFSET_ODDS2+OFFSET_ODDS2
	    OFFSET_ODDS= -OFFSET_ODDS
	  ENDIF
	ENDIF
C
	RETURN
	END
