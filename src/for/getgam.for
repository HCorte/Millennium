C SUBROUTINE GETGAM
C GETGAM.FOR
C
C V08 20-NOV-2000 UXN TOTOGOLA ADDED.
C V07 14-MAY-1999 UXN Super Triple added.
C V06 23-NOV-1995 HXK Merge of post 65 stuff; changes for Double/Couple
C V05 08-SEP-1993 GXA Check for Ravi Time bit set in closing Time.
C V04 03-AUG-1993 GXA Added RAVI (V65) game.
C V03 21-JAN-1993 DAB Initial Release
C                     Based on Netherlands Bible, 12/92, and Comm 1/93 update
C                     DEC Baseline
C V02 18-MAY-1992 GCAN CHANGED INORDER NOT TO SET GAME CLOSE BIT.
C V01 01-AUG-1990 XXX  RELEASED FOR VAX
C
C SUBROUTINE TO LOAD GAME(S) TEXT DATA.
C
C
C
C+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
C This item is the property of GTECH Corporation, Providence, Rhode
C Island, and contains confidential and trade secret information. It
C may not be transferred from the custody or control of GTECH except
C as authorized in writing by an officer of GTECH. Neither this item
C nor the information it contains may be used, transferred,
C reproduced, published, or disclosed, in whole or in part, and
C directly or indirectly, except as expressly authorized by an
C officer of GTECH, pursuant to written agreement.
C
C Copyright 1997 GTECH Corporation. All rights reserved.
C+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
C
C=======OPTIONS /CHECK=NOOVERFLOW
	SUBROUTINE GETGAM(GAM)
	IMPLICIT NONE
C
	INCLUDE 'INCLIB:SYSPARAM.DEF'
	INCLUDE 'INCLIB:SYSEXTRN.DEF'
	INCLUDE 'INCLIB:GLOBAL.DEF'
	INCLUDE 'INCLIB:CONCOM.DEF'
	INCLUDE 'INCLIB:SCRCOM.DEF'
	INCLUDE 'INCLIB:WITCOM.DEF'
	INCLUDE 'INCLIB:SPTCOM.DEF'
	INCLUDE 'INCLIB:TGLCOM.DEF'
	INCLUDE 'INCLIB:TSLCOM.DEF'
	INCLUDE 'INCLIB:DBLCOM.DEF'
	INCLUDE 'INCLIB:CPLCOM.DEF'
	INCLUDE 'INCLIB:SSCCOM.DEF'
	INCLUDE 'INCLIB:TRPCOM.DEF'
	INCLUDE 'INCLIB:STRCOM.DEF'
	INCLUDE 'INCLIB:DWIREC.DEF'
	INCLUDE 'INCLIB:DSCREC.DEF'
	INCLUDE 'INCLIB:DSPREC.DEF'
	INCLUDE 'INCLIB:DTGREC.DEF'
	INCLUDE 'INCLIB:DTSREC.DEF'
	INCLUDE 'INCLIB:DDBREC.DEF'
	INCLUDE 'INCLIB:DCPREC.DEF'
	INCLUDE 'INCLIB:DSSREC.DEF'
	INCLUDE 'INCLIB:DTRREC.DEF'
	INCLUDE 'INCLIB:DSTREC.DEF'
	INCLUDE 'INCLIB:GTNAMES.DEF'
C
C
	INTEGER*4 FDB(7)
	INTEGER*4 ST,GAM,DRAW,GTYP,GIND,I
	EQUIVALENCE (DWIREC,DSCREC,DSPREC,DTSREC,DDBREC,DCPREC,
     *               DSSREC,DTRREC,DSTREC)
C
C
	GTYP=GNTTAB(GAMTYP,GAM)
	GIND=GNTTAB(GAMIDX,GAM)
	DRAW=DAYDRW(GAM)
	IF(GTYP.EQ.TSPT) GOTO 1000
	IF(GTYP.EQ.TTSL) GOTO 2000
	IF(GTYP.EQ.TWIT) GOTO 3000
	IF(GTYP.EQ.TSCR) GOTO 4000
	IF(GTYP.EQ.TDBL) GOTO 6000
	IF(GTYP.EQ.TCPL) GOTO 7000
	IF(GTYP.EQ.TSSC) GOTO 8000
	IF(GTYP.EQ.TTRP) GOTO 9000
	IF(GTYP.EQ.TSTR) GOTO 10000
	IF(GTYP.EQ.TTGL) GOTO 11000
	RETURN
C
C SPORTS GAMES
C
1000	CONTINUE
	CALL OPENW(3,GFNAMES(1,GAM),4,0,0,ST)
	CALL IOINIT(FDB,3,DSPSEC*256)
	IF(ST.NE.0) THEN
	  CALL FILERR(GFNAMES(1,GAM),1,ST,0)
	  RETURN
	ENDIF
	IF(DRAW.LT.1) THEN
	  TYPE *,' DRAW NOT ACTIVE FOR THAT GAME '
	  GOTO 1010
	ENDIF
	WRITE(5,900) GAM,GTNAMES(TSPT),GIND
	CALL XWAIT(2,2,ST)
	CALL READW(FDB,DRAW,DSPREC,ST)
	IF(ST.NE.0) THEN
	  CALL FILERR(GFNAMES(1,GAM),1,ST,DRAW)
	  RETURN
	ENDIF
	CALL LOGGAM(GTYP,GIND,DSPREC,SPTBLK)
        IF (SPTTIM(GIND) .GE. '40000000'X) THEN
            SPTTIM(GIND) = SPTTIM(GIND) - '40000000'X
        ENDIF
        IF(SPTSTS(GIND).NE.GAMOPN.OR.
     *     SPTTIM(GIND).EQ.0.OR.
     *     SPTDAT(CURDRW,GIND).NE.DAYCDC)
     *     SPTTIM(GIND) = SPTTIM(GIND) + '40000000'X
	CALL LODTXT(GAM)
1010	CONTINUE
	CALL CLOSEFIL(FDB)
	RETURN
C
C TOTO SELECT GAMES
C
2000	CONTINUE
	CALL OPENW(3,GFNAMES(1,GAM),4,0,0,ST)
	CALL IOINIT(FDB,3,DTSSEC*256)
	IF(ST.NE.0) THEN
	  CALL FILERR(GFNAMES(1,GAM),1,ST,0)
	  RETURN
	ENDIF
	IF(DRAW.LT.1) THEN
	  TYPE *,' DRAW NOT ACTIVE FOR THAT GAME '
	  GOTO 2010
	ENDIF
	WRITE(5,900) GAM,GTNAMES(TTSL),GIND
	CALL XWAIT(2,2,ST)
	CALL READW(FDB,DRAW,DTSREC,ST)
	IF(ST.NE.0) THEN
	  CALL FILERR(GFNAMES(1,GAM),1,ST,DRAW)
	  RETURN
	ENDIF
	CALL LOGGAM(GTYP,GIND,DTSREC,TSLBLK)
	DO 2020 I=1,MAXSRW
        IF (TSLTIM(I,GIND) .GE. '40000000'X) THEN
            TSLTIM(I,GIND) = TSLTIM(I,GIND) - '40000000'X
        ENDIF
        IF(TSLSTA(I,GIND).NE.GAMOPN.OR.
     *     TSLTIM(I,GIND).EQ.0.OR.
     *     TSLDAT(I,GIND).NE.DAYCDC)
     *     TSLTIM(I,GIND) = TSLTIM(I,GIND) + '40000000'X
2020	CONTINUE
	CALL LODTXT(GAM)
2010	CONTINUE
	CALL CLOSEFIL(FDB)
	RETURN
C
C WINNERS TIP GAMES
C
3000	CONTINUE
	CALL OPENW(3,GFNAMES(1,GAM),4,0,0,ST)
	CALL IOINIT(FDB,3,DWISEC*256)
	IF(ST.NE.0) THEN
	  CALL FILERR(GFNAMES(1,GAM),1,ST,0)
	  RETURN
	ENDIF
	IF(DRAW.LT.1) THEN
	  TYPE *,' DRAW NOT ACTIVE FOR THAT GAME '
	  GOTO 3010
	ENDIF
	WRITE(5,900) GAM,GTNAMES(TWIT),GIND
	CALL XWAIT(2,2,ST)
	CALL READW(FDB,DRAW,DWIREC,ST)
	IF(ST.NE.0) THEN
	  CALL FILERR(GFNAMES(1,GAM),1,ST,DRAW)
	  RETURN
	ENDIF
	CALL LOGGAM(GTYP,GIND,DWIREC,WITBLK)
        IF (WITTIM(GIND) .GE. '40000000'X) THEN
            WITTIM(GIND) = WITTIM(GIND) - '40000000'X
        ENDIF
        IF(WITSTS(GIND).NE.GAMOPN.OR.
     *     WITTIM(GIND).EQ.0.OR.
     *     WITDAT(GIND).NE.DAYCDC)
     *     WITTIM(GIND) = WITTIM(GIND) + '40000000'X
	CALL LODTXT(GAM)
3010	CONTINUE
	CALL CLOSEFIL(FDB)
	RETURN
C
C SCORE GAMES
C
4000	CONTINUE
	CALL OPENW(3,GFNAMES(1,GAM),4,0,0,ST)
	CALL IOINIT(FDB,3,DSCSEC*256)
	IF(ST.NE.0) THEN
	  CALL FILERR(GFNAMES(1,GAM),1,ST,0)
	  RETURN
	ENDIF
	IF(DRAW.LT.1) THEN
	  TYPE *,' DRAW NOT ACTIVE FOR THAT GAME '
	  GOTO 4010
	ENDIF
	WRITE(5,900) GAM,GTNAMES(TSCR),GIND
	CALL XWAIT(2,2,ST)
	CALL READW(FDB,DRAW,DSCREC,ST)
	IF(ST.NE.0) THEN
	  CALL FILERR(GFNAMES(1,GAM),1,ST,DRAW)
	  RETURN
	ENDIF
	CALL LOGGAM(GTYP,GIND,DSCREC,SCRBLK)
        IF (SCRTIM(GIND) .GE. '40000000'X) THEN
            SCRTIM(GIND) = SCRTIM(GIND) - '40000000'X
        ENDIF
        IF(SCRSTS(GIND).NE.GAMOPN.OR.
     *     SCRTIM(GIND).EQ.0.OR.
     *     SCRDAT(GIND).NE.DAYCDC)
     *     SCRTIM(GIND) = SCRTIM(GIND) + '40000000'X
	CALL LODTXT(GAM)
C
4010	CONTINUE
	CALL CLOSEFIL(FDB)
	RETURN
C
C DOUBLE GAMES
C
6000	CONTINUE
	CALL OPENW(3,GFNAMES(1,GAM),4,0,0,ST)
	CALL IOINIT(FDB,3,DDBSEC*256)
	IF(ST.NE.0) THEN
	  CALL FILERR(GFNAMES(1,GAM),1,ST,0)
	  RETURN
	ENDIF
	IF(DRAW.LT.1) THEN
	  TYPE *,' DRAW NOT ACTIVE FOR THAT GAME '
	  GOTO 6010
	ENDIF
	WRITE(5,900) GAM,GTNAMES(TDBL),GIND
	CALL XWAIT(2,2,ST)
	CALL READW(FDB,DRAW,DDBREC,ST)
	IF(ST.NE.0) THEN
	  CALL FILERR(GFNAMES(1,GAM),1,ST,DRAW)
	  RETURN
	ENDIF
	CALL LOGGAM(GTYP,GIND,DDBREC,DBLBLK)
        IF (DBLTIM(GIND) .GE. '40000000'X) THEN
            DBLTIM(GIND) = DBLTIM(GIND) - '40000000'X
        ENDIF
        IF(DBLSTS(GIND).NE.GAMOPN.OR.
     *     DBLTIM(GIND).EQ.0.OR.
     *     DBLDAT(GIND).NE.DAYCDC)
     *     DBLTIM(GIND) = DBLTIM(GIND) + '40000000'X
	CALL LODTXT(GAM)
6010	CONTINUE
	CALL CLOSEFIL(FDB)
	RETURN
C
C COUPLE GAMES
C
7000	CONTINUE
	CALL OPENW(3,GFNAMES(1,GAM),4,0,0,ST)
	CALL IOINIT(FDB,3,DCPSEC*256)
	IF(ST.NE.0) THEN
	  CALL FILERR(GFNAMES(1,GAM),1,ST,0)
	  RETURN
	ENDIF
	IF(DRAW.LT.1) THEN
	  TYPE *,' DRAW NOT ACTIVE FOR THAT GAME '
	  GOTO 7010
	ENDIF
	WRITE(5,900) GAM,GTNAMES(TCPL),GIND
	CALL XWAIT(2,2,ST)
	CALL READW(FDB,DRAW,DCPREC,ST)
	IF(ST.NE.0) THEN
	  CALL FILERR(GFNAMES(1,GAM),1,ST,DRAW)
	  RETURN
	ENDIF
	CALL LOGGAM(GTYP,GIND,DCPREC,CPLBLK)
        IF (CPLTIM(GIND) .GE. '40000000'X) THEN
            CPLTIM(GIND) = CPLTIM(GIND) - '40000000'X
        ENDIF
        IF(CPLSTS(GIND).NE.GAMOPN.OR.
     *     CPLTIM(GIND).EQ.0.OR.
     *     CPLDAT(GIND).NE.DAYCDC)
     *     CPLTIM(GIND) = CPLTIM(GIND) + '40000000'X
	CALL LODTXT(GAM)
7010	CONTINUE
	CALL CLOSEFIL(FDB)
	RETURN
C
C SUPERSCORE GAMES
C
8000	CONTINUE
	CALL OPENW(3,GFNAMES(1,GAM),4,0,0,ST)
	CALL IOINIT(FDB,3,DSSSEC*256)
	IF(ST.NE.0) THEN
	  CALL FILERR(GFNAMES(1,GAM),1,ST,0)
	  RETURN
	ENDIF
	IF(DRAW.LT.1) THEN
	  TYPE *,' DRAW NOT ACTIVE FOR THAT GAME '
	  GOTO 8010
	ENDIF
	WRITE(5,900) GAM,GTNAMES(TSSC),GIND
	CALL XWAIT(2,2,ST)
	CALL READW(FDB,DRAW,DSSREC,ST)
	IF(ST.NE.0) THEN
	  CALL FILERR(GFNAMES(1,GAM),1,ST,DRAW)
	  RETURN
	ENDIF
	CALL LOGGAM(GTYP,GIND,DSSREC,SSCBLK)
        IF (SSCTIM(GIND) .GE. '40000000'X) THEN
            SSCTIM(GIND) = SSCTIM(GIND) - '40000000'X
        ENDIF
        IF(SSCSTS(GIND).NE.GAMOPN.OR.
     *     SSCTIM(GIND).EQ.0.OR.
     *     SSCDAT(GIND).NE.DAYCDC)
     *     SSCTIM(GIND) = SSCTIM(GIND) + '40000000'X
	CALL LODTXT(GAM)
C
8010	CONTINUE
	CALL CLOSEFIL(FDB)
	RETURN
C
C
C TODAY'S TRIO GAMES
C
9000	CONTINUE
	CALL OPENW(3,GFNAMES(1,GAM),4,0,0,ST)
	CALL IOINIT(FDB,3,DTRSEC*256)
	IF(ST.NE.0) THEN
	  CALL FILERR(GFNAMES(1,GAM),1,ST,0)
	  RETURN
	ENDIF
	IF(DRAW.LT.1) THEN
	  TYPE *,' DRAW NOT ACTIVE FOR THAT GAME '
	  GOTO 9010
	ENDIF
	WRITE(5,900) GAM,GTNAMES(TTRP),GIND
	CALL XWAIT(2,2,ST)
	CALL READW(FDB,DRAW,DTRREC,ST)
	IF(ST.NE.0) THEN
	  CALL FILERR(GFNAMES(1,GAM),1,ST,DRAW)
	  RETURN
	ENDIF
	CALL LOGGAM(GTYP,GIND,DTRREC,TRPBLK)
        IF (TRPTIM(GIND) .GE. '40000000'X) THEN
            TRPTIM(GIND) = TRPTIM(GIND) - '40000000'X
        ENDIF
        IF(TRPSTS(GIND).NE.GAMOPN.OR.
     *     TRPTIM(GIND).EQ.0.OR.
     *     TRPDAT(GIND).NE.DAYCDC)
     *     TRPTIM(GIND) = TRPTIM(GIND) + '40000000'X
	CALL LODTXT(GAM)
C
9010	CONTINUE
	CALL CLOSEFIL(FDB)
	RETURN
C
C
C SUPER TRIPLE GAMES
C
10000	CONTINUE
	CALL OPENW(3,GFNAMES(1,GAM),4,0,0,ST)
	CALL IOINIT(FDB,3,DSTSEC*256)
	IF(ST.NE.0) THEN
	  CALL FILERR(GFNAMES(1,GAM),1,ST,0)
	  RETURN
	ENDIF
	IF(DRAW.LT.1) THEN
	  TYPE *,' DRAW NOT ACTIVE FOR THAT GAME '
	  GOTO 10010
	ENDIF
	WRITE(5,900) GAM,GTNAMES(TSTR),GIND
	CALL XWAIT(2,2,ST)
	CALL READW(FDB,DRAW,DSTREC,ST)
	IF(ST.NE.0) THEN
	  CALL FILERR(GFNAMES(1,GAM),1,ST,DRAW)
	  RETURN
	ENDIF
	CALL LOGGAM(GTYP,GIND,DSTREC,STRBLK)
        IF (STRTIM(GIND) .GE. '40000000'X) THEN
            STRTIM(GIND) = STRTIM(GIND) - '40000000'X
        ENDIF
        IF(STRSTS(GIND).NE.GAMOPN.OR.
     *     STRTIM(GIND).EQ.0.OR.
     *     STRDAT(GIND).NE.DAYCDC)
     *     STRTIM(GIND) = STRTIM(GIND) + '40000000'X
	CALL LODTXT(GAM)
C
10010	CONTINUE
	CALL CLOSEFIL(FDB)
	RETURN
C
C RESULTS GAMES
C
11000	CONTINUE
	CALL OPENW(3,GFNAMES(1,GAM),4,0,0,ST)
	CALL IOINIT(FDB,3,DTGSEC*256)
	IF(ST.NE.0) THEN
	  CALL FILERR(GFNAMES(1,GAM),1,ST,0)
	  RETURN
	ENDIF
	IF(DRAW.LT.1) THEN
	  TYPE *,' DRAW NOT ACTIVE FOR THAT GAME '
	  GOTO 11010
	ENDIF
	WRITE(5,900) GAM,GTNAMES(TTGL),GIND
	CALL XWAIT(2,2,ST)
	CALL READW(FDB,DRAW,DTGREC,ST)
	IF(ST.NE.0) THEN
	  CALL FILERR(GFNAMES(1,GAM),1,ST,DRAW)
	  RETURN
	ENDIF
	CALL LOGGAM(GTYP,GIND,DTGREC,TGLBLK)
        IF (TGLTIM(GIND) .GE. '40000000'X) THEN
            TGLTIM(GIND) = TGLTIM(GIND) - '40000000'X
        ENDIF
        IF(TGLSTS(GIND).NE.GAMOPN.OR.
     *     TGLTIM(GIND).EQ.0.OR.
     *     TGLDAT(CURDRW,GIND).NE.DAYCDC)
     *     TGLTIM(GIND) = TGLTIM(GIND) + '40000000'X
	CALL LODTXT(GAM)
11010	CONTINUE
	CALL CLOSEFIL(FDB)
	RETURN
C
900     FORMAT(' Loading game number ',I2,1X,A8,1X,I1,  
     *	       ' game data ')
	END
