C SUBROUTINE FLXDELETE
C
C
C V01 04-MAR-96 wsm Extracted from ALLDLL for Finland.
C
C ** Source - alldll.for **
C
C
C+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
C
C DELETE MESSAGE #MSGNUM AND FREE ITS SEGMENTS:
C
C=======OPTIONS /CHECK=NOOVERFLOW
C
	SUBROUTINE FLXDELETE(MSGNUM)
C
	IMPLICIT NONE
C
	INCLUDE 'INCLIB:SYSPARAM.DEF'
	INCLUDE 'INCLIB:SYSEXTRN.DEF'
	INCLUDE 'INCLIB:MSGCOM.DEF'
C
	INTEGER*4 	LINK,
     *			LOCMSG,
     *			MSGNUM
C
C
	LOCMSG = MSGNUM					! LOCAL COPY OF MSGNUM.
	I4MSGTAB(SEGLEN, LOCMSG) = 0			! FREE BASE SEGMENT.
	LINK = I4MSGTAB(MSGLNK, LOCMSG)			! GET LINK, IF ANY.
	I4MSGTAB(MSGLNK, LOCMSG) = 0			! CLEAR LINK.
C
10	IF (LINK .GT. 0) THEN				! IF ANOTHER SEGMENT
	  LOCMSG = LINK					! MAKE IT CURRENT SEG.
	  LINK = I4MSGTAB(MSGLNK, LOCMSG)			! SAVE LINK.
	  I4MSGTAB(MFRLNK, LOCMSG) = I4MSGTAB(MFRLNK, MSGCTL) 	! ADD TO CHAIN.
	  I4MSGTAB(MFRLNK, MSGCTL) = LOCMSG
	  I4MSGTAB(MFRCNT, MSGCTL) = I4MSGTAB(MFRCNT, MSGCTL) + 1	! INC. COUNT.
	  GOTO 10					! CONTINUE UNTIL ALL
	ENDIF						! SEGS FREED.
C
	RETURN
	END
C
